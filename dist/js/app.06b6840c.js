(function(t){function e(e){for(var r,s,a=e[0],c=e[1],d=e[2],u=0,h=[];u<a.length;u++)s=a[u],Object.prototype.hasOwnProperty.call(i,s)&&i[s]&&h.push(i[s][0]),i[s]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);l&&l(e);while(h.length)h.shift()();return o.push.apply(o,d||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],r=!0,a=1;a<n.length;a++){var c=n[a];0!==i[c]&&(r=!1)}r&&(o.splice(e--,1),t=s(s.s=n[0]))}return t}var r={},i={app:0},o=[];function s(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=r,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)s.d(n,r,function(e){return t[e]}.bind(null,r));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/Drawer/dist/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=e,a=a.slice();for(var d=0;d<a.length;d++)e(a[d]);var l=c;o.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"13c9":function(t,e,n){},"2e97":function(t,e,n){t.exports=n.p+"img/edge_empty_hover.8f8f3dc2.svg"},"39d3":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),i=n("7591"),o=n.n(i),s=n("ecee"),a=n("c074"),c=n("ad3d"),d=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("drawer"),n("confirm-modal")],1)},l=[],u=(n("4989"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container mt-5"},[n("manage"),n("Canvas")],1)}),h=[],p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"text-left"},[n("add-part"),n("add-text",{staticClass:"ml-2"})],1)},m=[],f=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"d-inline-block w-auto"},[n("input",{directives:[{name:"model",rawName:"v-model.number",value:t.width,expression:"width",modifiers:{number:!0}}],attrs:{type:"text"},domProps:{value:t.width},on:{input:function(e){e.target.composing||(t.width=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}}),t._v(" X "),n("input",{directives:[{name:"model",rawName:"v-model.number",value:t.height,expression:"height",modifiers:{number:!0}}],attrs:{type:"text"},domProps:{value:t.height},on:{input:function(e){e.target.composing||(t.height=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}}),n("button",{staticClass:"btn btn-secondary ml-2",attrs:{type:"button"},on:{click:t.add}},[t._v(" Элемент ")])])},g=[],x=(n("d81d"),{computed:{id:function(){return this.$store.state.id}},methods:{getId:function(){this.$store.commit("incrementId");var t=this.id;return t}}}),v={mixins:[x],data:function(){return{els:[],width:1e3,height:2e3}},computed:{pxPerMm:function(){return this.$store.state.pxPerMm},canvasWidthInMm:function(){return this.$store.state.canvasWidthInMm},canvasHeightInMm:function(){return this.$store.state.canvasHeightInMm}},methods:{add:function(){var t=this,e=this.width,n=this.height,r=[(this.canvasWidthInMm-e)/2,(this.canvasHeightInMm-n)/2],i={id:this.getId(),position:{x:0,y:0},type:"part",fill:null,points:[{id:this.getId(),c:r},{id:this.getId(),c:[r[0]+e,r[1]]},{id:this.getId(),c:[r[0]+e,r[1]+n]},{id:this.getId(),c:[r[0],r[1]+n]}]};i.borders=i.points.map((function(){return{id:t.getId(),type:"lineBorder",sizeTag:{isShown:!0},radiusPosition:"usual"}})),this.$store.commit("addPart",i),this.$store.commit("addLog")}}},b=v,I=n("2877"),y=Object(I["a"])(b,f,g,!1,null,null,null),M=y.exports,w=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"d-inline-block"},[n("button",{staticClass:"btn btn-secondary",attrs:{type:"button"},on:{click:t.addText}},[t._v(" Текст ")])])},E=[],$={mixins:[x],methods:{addText:function(){this.$store.dispatch("addTextBlock",{id:this.getId(),x:10,y:100,type:"totalText",fontSizeK:1,text:""})}}},P=$,C=Object(I["a"])(P,w,E,!1,null,null,null),T=C.exports,k={components:{AddPart:M,AddText:T}},B=k,j=Object(I["a"])(B,p,m,!1,null,null,null),_=j.exports,S=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.isMounted?[n("konva")]:t._e()],2)},O=[],L=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"position-relative",staticStyle:{border:"1px solid","margin-bottom":"300px"}},[n("div",{ref:"nocontext"},[n("context-menu"),n("v-stage",{ref:"stage",attrs:{config:{width:t.canvasWidthInPx,height:500,type:"stage"}}},[n("v-layer",[n("v-rect",{attrs:{config:{width:t.canvasWidthInPx,height:500,fill:"white",type:"bgRect"}},on:{click:t.deselect}}),t._l(t.parts,(function(t,e){return n("part",{key:t.id,attrs:{partIndex:e,part:t}})})),t._l(t.totalTexts,(function(t,e){return n("total-text",{key:t.id,attrs:{textIndex:e,text:t}})}))],2)],1)],1),n("element-menu"),n("logs"),n("text-edit")],1)},z=[],A=n("1157"),D=n.n(A),R=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"menu",staticClass:"dropdown-menu",style:t.coords,attrs:{role:"menu"}},t._l(t.items,(function(e,r){return n("a",{key:r,staticClass:"dropdown-item",attrs:{href:"#"},on:{click:function(n){return n.preventDefault(),t.handleClick(e)}}},[t._v(" "+t._s(e.name)+" ")])})),0)},F=[],N=n("5530"),W={computed:{contextMenuEvent:function(){return this.$store.state.contextMenuEvent},coords:function(){var t={top:0,left:0};return this.contextMenuEvent&&(t.top="".concat(this.contextMenuEvent.e.evt.layerY,"px"),t.left="".concat(this.contextMenuEvent.e.evt.layerX,"px")),t},parts:function(){return this.$store.getters.parts},items:function(){if(!this.contextMenuEvent)return[];var t=[],e=this.contextMenuEvent.e.target.attrs,n=this.contextMenuEvent,r=n.partIndex,i=n.borderIndex;switch(e.type){case"part":return[{name:"Удалить элемент",action:"deletePart",partIndex:r}];case"lineBorder":return e.isClickable&&t.push.apply(t,[{name:"Вставить точку",action:"addPoint",borderIndex:this.contextMenuEvent.borderIndex},{name:"Сделать выпуклой",isInside:!1,action:"makeBorderCurve",borderIndex:this.contextMenuEvent.borderIndex},{name:"Сделать вогнутой",isInside:!0,action:"makeBorderCurve",borderIndex:this.contextMenuEvent.borderIndex},{name:"Сделать вырез",isInside:!0,action:"makeBulgeInset",borderIndex:this.contextMenuEvent.borderIndex},{name:"Сделать выступ",isInside:!1,action:"makeBulgeInset",borderIndex:this.contextMenuEvent.borderIndex}]),t.push({name:"Добавить/убрать бортик",action:"toggleSkirting",borderIndex:this.contextMenuEvent.borderIndex}),!e.sizeTag.isShown&&e.isHoverable&&t.push({name:"Показать размер",action:"showSizeArrow",borderIndex:this.contextMenuEvent.borderIndex}),this.parts[r].borders[i].edgeTag.isShown||t.push({name:"Добавить кромку",action:"addEdge",borderIndex:this.contextMenuEvent.borderIndex}),t;case"curveBorder":return t.push({name:"Сделать прямой",action:"makeBorderLine",borderIndex:this.contextMenuEvent.borderIndex},{name:"Добавить/убрать бортик",action:"toggleSkirting",borderIndex:this.contextMenuEvent.borderIndex}),e.isInside?t.push({name:"Сделать выпуклой",isInside:!1,action:"makeBorderCurve",borderIndex:this.contextMenuEvent.borderIndex}):t.push({name:"Сделать вогнутой",isInside:!0,action:"makeBorderCurve",borderIndex:this.contextMenuEvent.borderIndex}),e.radiusTag.isShown||t.push({name:"Показать радиус",action:"showRadius",borderIndex:this.contextMenuEvent.borderIndex}),this.parts[r].borders[i].edgeTag.isShown||t.push({name:"Добавить кромку",action:"addEdge",borderIndex:this.contextMenuEvent.borderIndex}),t;case"point":var o=this.parts[r],s=this.contextMenuEvent.pointIndex,a=s>0?s-1:o.points.length-1,c=o.borders[a],d=o.borders[s];return"lineBorder"===c.type&&"lineBorder"===d.type&&(e.isInsetBulge||t.push.apply(t,[{name:"Удалить точку",action:"deletePoint",pointIndex:this.contextMenuEvent.pointIndex},{name:"Сделать вырез",action:"makeCorderCut",pointIndex:this.contextMenuEvent.pointIndex}]),t.push({name:"Закруглить угол",action:"makeRounded",pointIndex:this.contextMenuEvent.pointIndex}),e.angleTag.isShown||t.push({name:"Показать угол",action:"showAngle",pointIndex:this.contextMenuEvent.pointIndex})),t;case"inset":case"bulge":return[{name:"Удалить выступ/вырез",action:"deleteInsetBulge",insetBulgeIndex:this.contextMenuEvent.insetBulgeIndex}];case"sizeArrow":return[{name:"Скрыть",action:"hide",borderIndex:this.contextMenuEvent.borderIndex}];case"radius":return[{name:"Скрыть",action:"hide",borderIndex:this.contextMenuEvent.borderIndex}];case"angleTag":return[{name:"Скрыть",action:"hide",pointIndex:this.contextMenuEvent.pointIndex}];case"edge":return[{name:"Скрыть",action:"hideEdge",borderIndex:this.contextMenuEvent.borderIndex}];case"totalText":return[{name:"Удалить текст",action:"deleteTotalText",textIndex:this.contextMenuEvent.textIndex}];default:return[]}}},watch:{contextMenuEvent:function(){D()(this.$refs.menu).dropdown("show")}},mounted:function(){var t=this;D()("body").click((function(){D()(t.$refs.menu).dropdown("hide")}))},methods:{handleClick:function(t){var e=this,n=Object(N["a"])(Object(N["a"])({},t),{},{partIndex:this.contextMenuEvent.partIndex});this.$store.commit("setContextMenuAction",n),setTimeout((function(){D()(e.$refs.menu).dropdown("hide")}),0)}}},q=W,H=Object(I["a"])(q,R,F,!1,null,null,null),K=H.exports,J=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-group",{attrs:{config:t.groupConfig},on:{dragend:t.log}},[n("v-shape",{attrs:{config:Object.assign({},t.partShapeConfig,{fill:t.fill.color,fillPatternImage:t.fill.image,fillPriority:"pattern"})},on:{mouseover:function(e){return t.$store.commit("setCurrentEl",t.partShapeConfig.id)},mouseleave:function(e){return t.$store.commit("setCurrentEl",null)},click:function(e){return t.$store.commit("setSelectedElId",t.part.id)},contextmenu:t.setContextMenuEvent}}),t.part.insetsBulges&&t.part.insetsBulges.length?n("insets-bulges",{attrs:{part:t.part,partIndex:t.partIndex}}):t._e(),n("borders",{attrs:{part:t.part,partIndex:t.partIndex,curves:t.curves}}),n("points",{attrs:{points:t.part.points,partIndex:t.partIndex,part:t.part}})],1)],1)},U=[],Z=(n("cb29"),n("4de4"),n("4160"),n("45fc"),n("159b"),n("2909")),X=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t._l(t.lineBorders,(function(e){return n("v-line",{key:e.border.id,ref:"border"+e.border.id,refInFor:!0,attrs:{config:Object.assign({},e.config,{stroke:[t.currentElId,t.selectedElId].includes(e.border.id)||t.selectedElId===t.part.id?t.selectedColor:"black"})},on:{contextmenu:function(n){return t.setContextMenuEvent(n,e.config.allBordersIndex)},mouseover:function(n){return t.$store.commit("setCurrentEl",e.border.id)},mouseleave:function(e){return t.$store.commit("setCurrentEl",null)},click:function(n){e.config.isClickable&&t.$store.commit("setSelectedElId",e.border.id)}}})})),t._l(t.curveBorders,(function(e){return n("v-arc",{key:e.border.id,ref:"border"+e.border.id,refInFor:!0,attrs:{config:Object.assign({},e.config,{stroke:[t.currentElId,t.selectedElId].includes(e.border.id)||t.selectedElId===t.part.id?t.selectedColor:"black"})},on:{contextmenu:function(n){return t.setContextMenuEvent(n,e.config.allBordersIndex)},mouseover:function(n){return t.$store.commit("setCurrentEl",e.border.id)},mouseleave:function(e){return t.$store.commit("setCurrentEl",null)},click:function(n){return t.$store.commit("setSelectedElId",e.border.id)}}})})),t._l(t.lineBorders,(function(e){return n("size-arrow-tag",{key:"a"+e.border.id,attrs:{border:e,partIndex:t.partIndex,part:t.part}})})),t._l(t.curveBorders,(function(e){return n("radius-tag",{key:"c"+e.border.id,attrs:{border:e,partIndex:t.partIndex,part:t.part}})})),t._l(t.lineBorders.concat(t.curveBorders),(function(e){return n("edges",{key:"e"+e.border.id,attrs:{border:e,partIndex:t.partIndex,part:t.part}})}))],2)},Y=[],G=(n("caad"),n("1266")),Q=n.n(G),V=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.border.border.sizeTag.isShown?n("v-group",{ref:"group"},[n("v-arrow",{attrs:{config:{points:t.params.arrowPoints,stroke:"black",fill:"black",pointerAtBeginning:!0,strokeWidth:1,pointerLength:t.arrowLength,pointerWidth:3,dash:t.dash}}}),n("v-label",{attrs:{config:Object.assign({},t.params.textPosition,{rotation:t.params.angle,offset:t.params.offset,draggable:!0,dragBoundFunc:t.params.dragBoundFunc})},on:{mouseover:function(e){t.over=!0},mouseleave:function(e){t.over=!1},contextmenu:t.setContextMenuEvent,dragstart:t.dragstart,dragend:t.dragend}},[n("v-tag",{attrs:{config:{fill:"white"}}}),n("v-text",{attrs:{config:{text:t.params.lengthText,padding:t.params.padding,fontSize:t.fontSize,fontFamily:"Calibri",fill:t.over?t.selectedColor:"black",type:"sizeArrow"}}})],1)],1):t._e()},tt=[],et=(n("99af"),n("d3b7"),n("25f0"),{props:["border","partIndex","part"],data:function(){return{over:!1,isCtrlKey:!1,arrowLength:3}},computed:{sizeTag:function(){return this.border.border.sizeTag},isControlPressed:function(){return this.$store.state.isControlPressed},offsetInMm:function(){var t=this.border.border.sizeTag;return"distance"in t?t.distance:this.border.border.skirting?70:50},pxPerMm:function(){return this.$store.state.pxPerMm},fontSize:function(){return this.$store.state.fontSizeInmM.sizeArrow*this.pxPerMm},params:function(){var t=this.border.config.points,e=this.border.border.sizeTag.isInside?-1:1,n=new Q.a(t[0],t[1]),r=new Q.a(t[2]-t[0],t[3]-t[1]),i=r.angleDeg();i=i<0?i+360:i;var o=this.fontSize/2,s=r.length(),a=Math.round(s/this.pxPerMm).toString();s-=2*this.arrowLength;var c={x:o*a.length,y:o},d=.5*s+c.x/2,l=this.offsetInMm*this.pxPerMm;r=r.norm().multiply(new Q.a(this.arrowLength,this.arrowLength)),n=r.clone().add(n),r=r.norm().rotateDeg(-90*e).multiply(new Q.a(l,l)),n=r.clone().add(n);var u,h,p,m=n.toArray(),f=r.clone().norm().rotateDeg(90*e).multiply(new Q.a(d,d)),g=f.add(n).toObject(),x=this.border.border.sizeTag.correctPosition;x?(h=x.x*this.pxPerMm,p=x.y*this.pxPerMm,u={x:g.x+h,y:g.y+p},m[0]+=h,m[1]+=p):u=g,r=r.norm().rotateDeg(90*e).multiply(new Q.a(s,s)),n=r.clone().add(n);var v=n.toArray();x&&(v[0]+=h,v[1]+=p);var b=this;return{arrowPoints:[].concat(Object(Z["a"])(m),Object(Z["a"])(v)),originalTextPosition:g,textPosition:u,lengthText:a,padding:0,angle:i,offset:c,dragBoundFunc:function(t){return b.dragTag(t),this.absolutePosition()}}},partPosition:function(){return this.part.position},contextMenuAction:function(){return this.$store.state.contextMenuAction},dash:function(){return this.$store.state.dash},selectedColor:function(){return this.$store.state.selectedColor}},watch:{contextMenuAction:function(t){if(t.partIndex===this.partIndex&&t.borderIndex===this.border.config.allBordersIndex&&["hide","showSizeArrow"].includes(t.action)){var e="hide"===t.action?{}:{isShown:!0};this.$store.commit("setSizeTagParams",Object(N["a"])({i:t.partIndex,j:t.borderIndex},e)),this.$store.commit("addLog")}},over:function(t){t?this.$store.commit("setCursor","move"):this.$store.commit("resetCursor")}},methods:{setContextMenuEvent:function(t){var e=this.partIndex;this.$store.commit("setContextMenuEvent",{e:t,partIndex:e,borderIndex:this.border.config.allBordersIndex})},dragTag:function(t){this.isCtrlKey?this.dragTagFree(t):this.dragTagStrict(t)},dragTagStrict:function(t){var e=this.border.border.pointsInPx,n=t.x-this.partPosition.x,r=t.y-this.partPosition.y,i=new Q.a(e[2]-e[0],e[3]-e[1]),o=new Q.a(n-e[0],r-e[1]),s=i.angleDeg();s=s;var a=o.angleDeg()-s;a<-180?a+=360:a>180&&(a-=360);var c=i.dot(o)/(i.length()*o.length()),d=Math.acos(c),l=Math.sin(d),u=l*o.length()/this.pxPerMm;this.$store.commit("setSizeTagParams",{i:this.partIndex,j:this.border.border.allBordersIndex,distance:u,isInside:a>0,isShown:!0})},dragTagFree:function(t){var e=t.x-this.partPosition.x,n=t.y-this.partPosition.y,r=this.params.originalTextPosition,i=r.x,o=r.y;this.$store.commit("setSizeTagParams",{i:this.partIndex,j:this.border.border.allBordersIndex,correctPosition:{x:(e-i)/this.pxPerMm,y:(n-o)/this.pxPerMm},isShown:!0})},dragstart:function(t){this.isCtrlKey=t.evt.ctrlKey},dragend:function(){this.$refs.group.getNode().clearCache(),this.$store.commit("addLog")}}}),nt=et,rt=Object(I["a"])(nt,V,tt,!1,null,null,null),it=rt.exports,ot=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.border.border.radiusTag.isShown?n("v-label",{ref:"label",attrs:{config:Object.assign({},t.params.textPosition,{rotation:t.params.angle,offset:t.params.offset,draggable:!0,dragBoundFunc:t.params.dragBoundFunc})},on:{mouseover:function(e){t.over=!0},mouseleave:function(e){t.over=!1},contextmenu:t.setContextMenuEvent,dragend:t.dragend}},[n("v-tag",{attrs:{config:{fill:"white"}}}),n("v-text",{attrs:{config:{text:t.params.radiusText,padding:t.params.padding,fontSize:t.fontSize,fontFamily:"Calibri",fill:t.over?t.selectedColor:"black",type:"radius"}}})],1):t._e()},st=[],at={props:["border","partIndex","part"],data:function(){return{over:!1,offsetInMm:100,correctAngle:0,correctDistance:0}},computed:{pxPerMm:function(){return this.$store.state.pxPerMm},fontSize:function(){return this.$store.state.fontSizeInmM.radius*this.pxPerMm},params:function(){var t=this.border.config,e=t.x,n=t.y,r=this.border.border.radiusTag.correctAngle||0,i=this.border.border.radiusTag.correctDistance||0,o=this.border.config.points,s=new Q.a(o[0],o[1]),a=new Q.a(o[2]-o[0],o[3]-o[1]),c=a.angleDeg();c=c<0?c+360:c;var d=c+r,l=a.length()/2;a=a.norm().multiply(new Q.a(l,l));var u=a.clone().add(s);s=new Q.a(e,n),a=new Q.a(u.x-e,u.y-n);var h=a.angleDeg(),p=this.border.border.isInside?1:-1,m=this.border.config.innerRadius-this.offsetInMm*this.pxPerMm*p,f=m+i*this.pxPerMm;a=a.norm().rotateDeg(r).multiply(new Q.a(f,f));var g=a.clone().add(s).toObject(),x=this.fontSize/2,v="R ".concat(Math.round(this.border.border.radius)),b={x:x*v.length/2,y:x},I=this;return{padding:0,textPosition:g,angle:d,centerAngle:h,originalDistance:m/this.pxPerMm,offset:b,radiusText:v,dragBoundFunc:function(t){return I.dragTag(t),this.absolutePosition()}}},contextMenuAction:function(){return this.$store.state.contextMenuAction},partPosition:function(){return this.part.position},selectedColor:function(){return this.$store.state.selectedColor}},watch:{contextMenuAction:function(t){if(t.partIndex===this.partIndex&&t.borderIndex===this.border.config.allBordersIndex&&["hide","showRadius"].includes(t.action)){var e="hide"===t.action?{}:{isShown:!0};this.$store.commit("setRadiusTagParams",Object(N["a"])({i:t.partIndex,j:t.borderIndex},e)),this.$store.commit("addLog")}},over:function(t){t?this.$store.commit("setCursor","move"):this.$store.commit("resetCursor")}},methods:{setContextMenuEvent:function(t){var e=this.partIndex;this.$store.commit("setContextMenuEvent",{e:t,partIndex:e,borderIndex:this.border.config.allBordersIndex})},dragTag:function(t){var e=this.border.config,n=e.x,r=e.y,i=t.x,o=t.y,s=this.partPosition.x,a=this.partPosition.y,c=new Q.a(i-(n+s),o-(r+a)),d=c.angleDeg(),l=d-this.params.centerAngle,u=c.length()/this.pxPerMm-this.params.originalDistance;this.$store.commit("setRadiusTagParams",{i:this.partIndex,j:this.border.border.allBordersIndex,correctAngle:l,correctDistance:u,isShown:!0})},dragend:function(){this.$refs.label.getNode().clearCache(),this.$store.commit("addLog")}}},ct=at,dt=Object(I["a"])(ct,ot,st,!1,null,null,null),lt=dt.exports,ut=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.edge.isShown&&t.image?n("v-image",{ref:"image",attrs:{config:{image:t.image,x:t.params.x,y:t.params.y,width:t.sizeInPx,height:t.sizeInPx,rotation:t.params.angle,offset:{x:t.imageOffset,y:t.imageOffset},type:"edge",draggable:!0,dragBoundFunc:t.params.dragBoundFunc}},on:{mouseover:function(e){t.over=!0},mouseleave:function(e){t.over=!1},contextmenu:t.setContextMenuEvent,click:function(e){return t.$store.commit("setSelectedElId",t.edge.id)},dragend:t.dragend}}):t._e()},ht=[],pt=(n("2532"),{mixins:[x],props:["border","partIndex","part"],data:function(){return{offsetInMm:50,over:!1,sizeInMm:120}},computed:{selectedElId:function(){return this.$store.state.selectedElId},currentElId:function(){return this.$store.state.currentElId},edge:function(){return this.border.border.edgeTag},image:function(){var t=[this.selectedElId,this.currentElId].includes(this.edge.id)?this.$store.state.files.edges["".concat(this.edge.edgeType,"Hover")]:this.$store.state.files.edges[this.edge.edgeType];return t},pxPerMm:function(){return this.$store.state.pxPerMm},sizeInPx:function(){return this.sizeInMm*this.pxPerMm},imageOffset:function(){return this.sizeInPx/2},params:function(){if(!this.edge.isShown)return{};var t=this.border.border.pointsInPx,e=this,n=this.border.border.edgeTag.correctDistance||0;if("lineBorder"===this.border.border.type){var r=new Q.a(t[0],t[1]),i=new Q.a(t[2]-t[0],t[3]-t[1]),o=i.length()/2,s=o+n*this.pxPerMm,a=i.angleDeg();a=a<0?a+180:a-180,i=i.norm().multiply(new Q.a(s,s)),r=i.clone().add(r);var c=this.offsetInMm*this.pxPerMm;i=i.norm().rotateDeg(-90).multiply(new Q.a(c,c));var d=i.clone().add(r).toObject(),l=d.x,u=d.y;return{angle:a,x:l,y:u,originalDistance:o/this.pxPerMm,dragBoundFunc:function(t){return e.dragTag(t,"line"),this.absolutePosition()}}}var h=this.border.config,p=h.x,m=h.y,f=this.border.border.edgeTag.correctAngle||0,g=new Q.a(t[0],t[1]),x=new Q.a(t[2]-t[0],t[3]-t[1]),v=x.angleDeg();v=v<0?v+180:v-180,v+=f;var b=x.length()/2;x=x.norm().multiply(new Q.a(b,b));var I=x.clone().add(g);g=new Q.a(p,m),x=new Q.a(I.x-p,I.y-m);var y=x.angleDeg(),M=this.border.border.isInside?1:-1,w=this.border.config.innerRadius-this.offsetInMm*this.pxPerMm*M,E=w+n*this.pxPerMm;x=x.norm().rotateDeg(f).multiply(new Q.a(E,E));var $=x.clone().add(g).toObject();return Object(N["a"])(Object(N["a"])({},$),{},{centerAngle:y,originalDistance:w/this.pxPerMm,angle:v,dragBoundFunc:function(t){return e.dragTag(t,"curve"),this.absolutePosition()}})},partPosition:function(){return this.part.position},contextMenuAction:function(){return this.$store.state.contextMenuAction}},watch:{contextMenuAction:function(t){if(t.partIndex===this.partIndex&&t.borderIndex===this.border.config.allBordersIndex&&["addEdge","hideEdge"].includes(t.action)){var e={i:t.partIndex,j:t.borderIndex,isShown:"addEdge"===t.action};"addEdge"===t.action&&(e.id=this.getId()),this.$store.commit("setEdgeTagParams",e),this.$store.commit("addLog")}},"params.originalDistance":function(t){var e=this.border.border.edgeTag.correctDistance||0,n=t+e,r=this.imageOffset/this.pxPerMm;if(n<r)this.$store.commit("setEdgeTagParams",{i:this.partIndex,j:this.border.border.allBordersIndex,correctDistance:r-t});else{var i=2*t-r;n>i&&this.$store.commit("setEdgeTagParams",{i:this.partIndex,j:this.border.border.allBordersIndex,correctDistance:i-t})}},over:function(t){t?(this.$store.commit("setCurrentEl",this.edge.id),this.$store.commit("setCursor","move")):(this.$store.commit("setCurrentEl",null),this.$store.commit("resetCursor"))}},methods:{setContextMenuEvent:function(t){var e=this.partIndex;this.$store.commit("setContextMenuEvent",{e:t,partIndex:e,borderIndex:this.border.config.allBordersIndex})},dragTag:function(t,e){if("curve"===e){var n=this.border.config,r=n.x,i=n.y,o=t.x,s=t.y,a=this.partPosition.x,c=this.partPosition.y,d=new Q.a(o-(r+a),s-(i+c)),l=d.angleDeg(),u=l-this.params.centerAngle;this.$store.commit("setEdgeTagParams",{i:this.partIndex,j:this.border.border.allBordersIndex,correctAngle:u})}else if("line"===e){var h,p=t.x+this.partPosition.x,m=t.y+this.partPosition.y,f=this.border.border.pointsInPx,g=new Q.a(f[2]-f[0],f[3]-f[1]),x=new Q.a(p-f[0],m-f[1]),v=g.dot(x)/(g.length()*x.length()),b=Math.acos(v),I=v*x.length();h=b>Math.PI/2?-this.params.originalDistance+this.imageOffset/this.sizeInPx:I>g.length()?this.params.originalDistance-this.imageOffset/this.sizeInPx:I/this.pxPerMm-this.params.originalDistance,this.$store.commit("setEdgeTagParams",{i:this.partIndex,j:this.border.border.allBordersIndex,correctDistance:h})}},dragend:function(){this.$refs.image.getNode().clearCache(),this.$store.commit("addLog")}}}),mt=pt,ft=Object(I["a"])(mt,ut,ht,!1,null,null,null),gt=ft.exports,xt={mixins:[x],props:["part","partIndex","curves"],components:{SizeArrowTag:it,RadiusTag:lt,Edges:gt},data:function(){return{}},computed:{selectedElId:function(){return this.$store.state.selectedElId},currentElId:function(){return this.$store.state.currentElId},pxPerMm:function(){return this.$store.state.pxPerMm},borders:function(){var t={};return this.part.borders.forEach((function(e,n){e.type in t||(t[e.type]=[]),t[e.type].push(Object(N["a"])(Object(N["a"])({},e),{},{allBordersIndex:n}))})),t},lineBorders:function(){var t=this;return this.borders.lineBorder?this.borders.lineBorder.map((function(e){var n=e.allBordersIndex?t.part.borders[e.allBordersIndex-1]:t.part.borders[t.part.borders.length-1],r=e.allBordersIndex<t.part.borders.length-1?t.part.borders[e.allBordersIndex+1]:t.part.borders[0],i=e.type,o=e.id,s=e.points,a={type:i,id:o,points:s.map((function(e){return e*t.pxPerMm})),strokeWidth:e.skirting?4:1,lineCap:n.skirting&&r.skirting?"square":"butt",hitStrokeWidth:5,allBordersIndex:e.allBordersIndex,isClickable:!["inset","bulge"].includes(e.subType),sizeTag:e.sizeTag};return{config:a,border:e}})):[]},curveBorders:function(){var t=this;return this.borders.curveBorder?this.borders.curveBorder.map((function(e){var n=e.allBordersIndex?t.part.borders[e.allBordersIndex-1]:t.part.borders[t.part.borders.length-1],r=e.allBordersIndex<t.part.borders.length-1?t.part.borders[e.allBordersIndex+1]:t.part.borders[0],i=e.type,o=e.id,s=e.points,a=Object(N["a"])({},t.curves[e.id]),c={type:i,id:o,points:s.map((function(e){return e*t.pxPerMm})),isInside:e.isInside,strokeWidth:e.skirting?4:1,lineJoin:n.skirting&&r.skirting?"round":"miter",hitStrokeWidth:5,allBordersIndex:e.allBordersIndex,innerRadius:a.R,outerRadius:a.R,x:a.c1.x,y:a.c1.y,angle:a.ang2*(180/Math.PI)-a.ang1*(180/Math.PI),rotation:a.ang1*(180/Math.PI),clockwise:a.isInside,radiusTag:e.radiusTag};return{config:c,border:e}})):[]},contextMenuAction:function(){return this.$store.state.contextMenuAction},refreshSelectedElTrigger:function(){return this.$store.state.parts.refreshSelectedElTrigger},selectedColor:function(){return this.$store.state.selectedColor}},watch:{contextMenuAction:function(t){t.partIndex===this.partIndex&&("makeBorderCurve"===t.action?this.makeBorderCurve(t):"makeBorderLine"===t.action?(this.$store.dispatch("makeBorderLine",t),this.$store.commit("addLog")):"makeBulgeInset"===t.action?this.makeBulgeInset(t):"toggleSkirting"===t.action&&(this.$store.commit("toggleSkirting",{i:t.partIndex,j:t.borderIndex}),this.$store.commit("addLog")))},refreshSelectedElTrigger:function(){this.$refs["border".concat(this.selectedElId)][0].getNode().fire("click")}},methods:{setContextMenuEvent:function(t,e){var n=this.partIndex;this.$store.commit("setContextMenuEvent",{e:t,partIndex:n,borderIndex:e})},makeBorderCurve:function(t){var e=this.clone(this.part.borders[t.borderIndex].points),n=Math.sqrt(Math.pow(e[2]-e[0],2)+Math.pow(e[3]-e[1],2)),r=t.isInside?n:n/2+2;this.$store.dispatch("makeBorderCurve",Object.assign(t,{radius:r})),this.$store.commit("addLog")},makeBulgeInset:function(t){var e=this,n=this.clone(this.part.borders[t.borderIndex].points),r=[],i=300,o=t.isInside?1:-1,s=new Q.a(n[0],n[1]),a=new Q.a(n[2]-n[0],n[3]-n[1]),c=a.length(),d=a.norm();a=d.multiply(new Q.a(c/3,c/3)),s=a.clone().add(s),r.push(s.toArray()),a=a.norm().rotateDeg(90*o).multiply(new Q.a(i,i)),s=a.clone().add(s),r.push(s.toArray()),a=a.norm().rotateDeg(-90*o).multiply(new Q.a(c/3,c/3)),s=a.clone().add(s),r.push(s.toArray()),a=a.norm().rotateDeg(-90*o).multiply(new Q.a(i,i)),s=a.clone().add(s),r.push(s.toArray());var l=t.partIndex,u=t.borderIndex,h=t.isInside?"inset":"bulge",p=[],m=this.getId();r.forEach((function(t,n){var r={id:e.getId(),type:"lineBorder",sizeTag:{isShown:!0}};n<3&&(r.subType=h),e.$store.commit("addBorder",{partIndex:l,borderIndex:u+n+1,border:r});var i=e.getId(),o={id:i,c:t,subType:h};e.$store.commit("addPoint",{partIndex:l,pointIndex:u+n+1,point:Object(N["a"])(Object(N["a"])({},o),{},{insetBulgeId:m})}),p.push(i)}));var f={partIndex:l,pointsId:p,id:m};this.$store.commit("addInsetBulge",Object(N["a"])(Object(N["a"])({},f),{},{type:h,depth:i})),this.$store.commit("setSelectedElId",m),this.$store.commit("addLog")}}},vt=xt,bt=Object(I["a"])(vt,X,Y,!1,null,null,null),It=bt.exports,yt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t._l(t.allPoints,(function(e,r){return n("v-circle",{key:e.id,attrs:{config:{type:"point",x:e.cInPx[0],y:e.cInPx[1],radius:t.radius,fill:[t.currentElId,t.selectedElId].includes(e.id)?t.selectedColor:"transparent",angleTag:e.angleTag,isInsetBulge:!!e.insetBulgeId}},on:{mouseover:function(n){e.isClickable&&t.$store.commit("setCurrentEl",e.id)},mouseleave:function(n){e.isClickable&&t.$store.commit("setCurrentEl",null)},dragmove:function(e){return t.movePoint(e,r)},click:function(n){e.isClickable&&t.$store.commit("setSelectedElId",e.id)},contextmenu:function(n){e.isClickable&&t.setContextMenuEvent(n,r)}}})})),t._l(t.allPoints,(function(e,r){return n("angle-tag",{key:"a"+e.id,attrs:{partIndex:t.partIndex,point:e,pointIndex:r,part:t.part}})}))],2)},Mt=[],wt=(n("a9e3"),n("9129"),n("07ac"),n("96cf"),n("1da1")),Et=n("854a"),$t=n.n(Et),Pt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.point.angleTag.isShown?n("div",[n("v-label",{ref:"angle",attrs:{config:Object.assign({},t.params.textPosition,{rotation:t.params.angle,offset:t.params.offset,draggable:!0,dragBoundFunc:t.params.dragBoundFunc})},on:{mouseover:function(e){t.over=!0},mouseleave:function(e){t.over=!1},contextmenu:t.setContextMenuEvent,dragend:t.dragend}},[n("v-tag",{attrs:{config:{fill:"transparent"}}}),n("v-text",{attrs:{config:{text:t.params.angleText,fontSize:t.fontSize,fontFamily:"Calibri",fill:t.over?t.selectedColor:"black",type:"angleTag"}}})],1),n("v-arc",{attrs:{config:{stroke:"black",strokeWidth:1,innerRadius:t.params.radius,outerRadius:t.params.radius,x:t.params.c1.x,y:t.params.c1.y,angle:t.params.ang2*(180/Math.PI)-t.params.ang1*(180/Math.PI),rotation:t.params.ang1*(180/Math.PI),clockwise:!0,dash:t.dash}}})],1):t._e()},Ct=[],Tt=(n("7db0"),{props:["point","partIndex","pointIndex","part"],data:function(){return{over:!1,offsetInMm:100}},computed:{pxPerMm:function(){return this.$store.state.pxPerMm},fontSize:function(){return this.$store.state.fontSizeInmM.radius*this.pxPerMm},params:function(){var t=this,e=this.point.angleTag.distance||0,n=this.part.borders.find((function(e){return e.id===t.point.bordersId[1]})),r=this.part.borders.find((function(e){return e.id===t.point.bordersId[0]})),i=n.pointsInPx,o=new Q.a(i[2],i[3]),s=new Q.a(i[0]-i[2],i[1]-i[3]),a=this.offsetInMm*this.pxPerMm,c=s.clone().norm().multiply(new Q.a(a,a)),d=c.add(o);i=r.pointsInPx;var l=new Q.a(i[2]-i[0],i[3]-i[1]);c=l.clone().norm().multiply(new Q.a(a,a));var u=c.add(o),h=u.clone().subtract(d).length()/2+2,p=l.angleDeg(),m=s.angleDeg()-p;m<0&&(m+=360);var f=m>=180;this.point.angleTag.isOutside&&(f=!f);var g=this.getCurve(d.toObject(),u.toObject(),h,f),x=g.ang1,v=g.ang2,b=g.c1,I="".concat(Math.round(m)," °");c=new Q.a(u.x-d.x,u.y-d.y);var y=c.length()/2;c=c.clone().norm().multiply(new Q.a(y,y)).add(d);var M=new Q.a(c.x-b.x,c.y-b.y),w=e?e*this.pxPerMm:h+1.2*a,E=M.angleDeg(),$=this.point.angleTag.correctAngle||0;f&&($+=180);var P=M.clone().norm().rotateDeg($).multiply(new Q.a(w,w)).add(new Q.a(b.x,b.y)).toObject(),C=this.fontSize/2,T={x:C*I.length/2,y:C},k=this;return{padding:0,textPosition:P,angle:0,offset:T,angleText:I,ang1:x,ang2:v,radius:h,c1:b,originalAngle:E,angleDeg:m,isOpposite:f,pts:i,dragBoundFunc:function(t){return k.dragTag(t),this.absolutePosition()}}},partPosition:function(){return this.part.position},contextMenuAction:function(){return this.$store.state.contextMenuAction},dash:function(){return this.$store.state.dash},selectedColor:function(){return this.$store.state.selectedColor}},watch:{contextMenuAction:function(t){if(t.partIndex===this.partIndex&&t.pointIndex===this.pointIndex&&["hide","showAngle"].includes(t.action)){var e="hide"===t.action?{}:{isShown:!0,isOutside:!1};this.$store.commit("setAngleTagParams",Object(N["a"])({i:t.partIndex,j:t.pointIndex},e)),this.$store.commit("addLog")}},over:function(t){t?this.$store.commit("setCursor","move"):this.$store.commit("resetCursor")}},methods:{setContextMenuEvent:function(t){var e=this.partIndex,n=this.pointIndex;this.$store.commit("setContextMenuEvent",{e:t,partIndex:e,pointIndex:n})},getCurve:function(t,e,n,r){var i={x:.5*(t.x+e.x),y:.5*(t.y+e.y)},o=r?-(t.y-e.y):-(e.y-t.y),s=r?t.x-e.x:e.x-t.x,a=Math.sqrt(Math.pow(o,2)+Math.pow(s,2));o/=a,s/=a;var c=Math.sqrt(Math.pow(i.x-t.x,2)+Math.pow(i.y-t.y,2)),d=c/n;if(d<-1||d>1)return{};var l=Math.sqrt(1-Math.pow(d,2)),u=n*l,h={x:i.x+o*u,y:i.y+s*u},p={x:i.x-o*u,y:i.y-s*u},m=Math.atan2(t.y-h.y,t.x-h.x),f=Math.atan2(e.y-h.y,e.x-h.x),g=Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)),x=(e.x-t.x)/g,v=Math.acos(x),b=t.x>e.x?t.y-e.y:e.y-t.y,I=b>0?-1:1;return{c1:p,p1:t,p2:e,R:n,ang1:Math.PI+2*Math.abs(1.57-v)*I-m,ang2:Math.PI+2*Math.abs(1.57-v)*I-f}},dragTag:function(t){var e=this.params.pts,n=t.x,r=t.y,i=this.partPosition.x,o=this.partPosition.y,s=new Q.a(n-(e[0]+i),r-(e[1]+o)),a=s.angleDeg(),c=a-this.params.originalAngle,d=s.length()/this.pxPerMm;this.$store.commit("setAngleTagParams",{i:this.partIndex,j:this.pointIndex,correctAngle:this.params.isOpposite?c+180:c,distance:d,isShown:!0,isOutside:this.point.angleTag.isOutside})},dragend:function(){this.$refs.angle.getNode().clearCache(),this.$store.commit("addLog")}}}),kt=Tt,Bt=Object(I["a"])(kt,Pt,Ct,!1,null,null,null),jt=Bt.exports,_t=function(t){return new Promise((function(e){var n=t.body,r=t.actions,i=t.input,o=t.title,s=D()("#confirm_modal");D()(s).find(".modal-body").text(n),D()(s).find(".modal-title").text(o);var a=r||[{action:"0",style:"secondary",text:"Нет"},{action:"1",style:"primary",text:"Да"}],c=a.map((function(t){var e=D()('<button class="btn" type="button"></button>');return D()(e).attr("data-action",t.action).addClass("btn-".concat(t.style)).text(t.text),e}));if(D()(s).find(".modal-footer").html(c),i){var d=D()('<input id="data" type="'.concat(i.type,'" placeholder="').concat(i.placeholder,'" />'));D()(d).addClass("form-control mt-3"),D()(s).find(".modal-body").append(d)}D()(s).modal("show").on("hide.bs.modal",(function(t){var n=D()(t.target).attr("data-result");if(i&&"1"===n){var r=D()(s).find("#data").val();e(r)}else e("1"===n);D()(s).off("hide.bs.modal")}))}))},St={mixins:[x],components:{AngleTag:jt},props:["points","partIndex","part"],computed:{selectedElId:function(){return this.$store.state.selectedElId},currentElId:function(){return this.$store.state.currentElId},contextMenuAction:function(){return this.$store.state.contextMenuAction},pxPerMm:function(){return this.$store.state.pxPerMm},radius:function(){return 60*this.pxPerMm},allPoints:function(){return this.points.map((function(t){var e=Object(N["a"])(Object(N["a"])({},t),{},{isClickable:!0});return e}))},selectedColor:function(){return this.$store.state.selectedColor}},watch:{contextMenuAction:function(t){t.partIndex===this.partIndex&&(this.$store.commit("setContextMenuEvent",null),"addPoint"===t.action?this.addPoint(t):"deletePoint"===t.action?this.deletePoint(t):"makeCorderCut"===t.action?this.makeCorderCut(t):"makeRounded"===t.action&&this.makeRounded(t))}},methods:{setContextMenuEvent:function(t,e){var n=this.partIndex;this.$store.commit("setContextMenuEvent",{e:t,partIndex:n,pointIndex:e})},movePoint:function(t,e){var n=this,r=this.partIndex,i=Object.values(t.target.position()).map((function(t){return t/n.pxPerMm}));this.$store.commit("movePoint",{pointIndex:e,partIndex:r,c:i})},addPoint:function(t){var e=t.borderIndex,n=this.part.points[e].c,r=e<this.part.points.length-1?this.part.points[e+1].c:this.part.points[0].c,i=[n[0]+(r[0]-n[0])/2,n[1]+(r[1]-n[1])/2],o=t.partIndex;this.$store.commit("addBorder",{partIndex:o,borderIndex:e+1,border:{id:this.getId(),type:"lineBorder"}}),this.$store.commit("addPoint",{partIndex:o,pointIndex:e+1,point:{id:this.getId(),c:i}}),this.$store.commit("addLog")},deletePoint:function(t){this.$store.commit("deletePoint",t),this.$store.commit("addLog")},makeCorderCut:function(t){var e=this,n=t.pointIndex,r=t.partIndex,i=this.points[n],o=n?this.points[n-1]:this.points[this.points.length-1],s=[],a=300,c=new Q.a(i.c[0],i.c[1]),d=new Q.a(o.c[0]-i.c[0],o.c[1]-i.c[1]);d=d.norm().multiply(new Q.a(a,a)),c=d.clone().add(c),s.push(c.toObject()),d=d.norm().rotateDeg(-90).multiply(new Q.a(a,a)),c=d.clone().add(c),s.push(c.toArray()),d=d.norm().rotateDeg(-90).multiply(new Q.a(a,a)),c=d.clone().add(c),s.push(c.toArray()),s.forEach((function(t,i){if(i){var o={id:e.getId(),type:"lineBorder",sizeTag:{isShown:!0}};e.$store.commit("addBorder",{partIndex:r,borderIndex:n+i,border:o});var s=e.getId();e.$store.commit("addPoint",{partIndex:r,pointIndex:n+i,point:{id:s,c:t}})}else{var a={i:r,j:n,point:t};e.$store.dispatch("changePoint",a)}})),this.$store.commit("addLog")},makeRounded:function(t){var e=this;return Object(wt["a"])(regeneratorRuntime.mark((function n(){var r,i,o,s,a,c,d,l,u,h,p,m,f,g,x,v,b;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r={body:"Введите радиус",title:"Закруглить угол"},r=Object(N["a"])(Object(N["a"])({},r),{},{input:{type:"number",placeholder:"радиус в мм"}}),r.actions=[{action:"0",style:"secondary",text:"Отмена"},{action:"1",style:"primary",text:"Применить"}],n.next=5,_t(r);case 5:if(i=n.sent,i){n.next=8;break}return n.abrupt("return");case 8:o=parseInt(i,10),Number.isNaN(o)&&$t.a.warning("Радиус введен неверно"),s=t.pointIndex,a=s>0?s-1:e.points.length-1,c=e.part.borders[a],d=c.points,l=e.part.borders[s],u=l.points,h=new Q.a(d[2],d[3]),p=new Q.a(d[0]-d[2],d[1]-d[3]),m=p.norm().multiply(new Q.a(o,o)).add(h).toArray(),f=new Q.a(u[2]-u[0],u[3]-u[1]),g=f.norm().multiply(new Q.a(o,o)).add(h).toArray(),x=t.partIndex,v=t.pointIndex,e.$store.commit("addBorder",{partIndex:x,borderIndex:s+1,border:{id:e.getId(),type:"lineBorder"}}),e.$store.commit("addPoint",{partIndex:x,pointIndex:s+1,point:{id:e.getId(),c:g}}),e.$store.commit("movePoint",{pointIndex:v,partIndex:x,c:m}),b={borderIndex:s,radius:o,isInside:!1},e.$store.dispatch("makeBorderCurve",Object(N["a"])(Object(N["a"])({},b),{},{partIndex:x})),e.$store.commit("addLog");case 28:case"end":return n.stop()}}),n)})))()}}},Ot=St,Lt=Object(I["a"])(Ot,yt,Mt,!1,null,null,null),zt=Lt.exports,At=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",t._l(t.insetsBulges,(function(e,r){return n("v-line",{key:e.id,attrs:{config:Object.assign({},t.configs[r],{strokeWidth:[t.currentElId,t.selectedElId].includes(e.id)?2:0})},on:{mouseover:function(n){return t.$store.commit("setCurrentEl",e.id)},mouseleave:function(e){return t.$store.commit("setCurrentEl",null)},click:function(n){return t.$store.commit("setSelectedElId",e.id)},contextmenu:function(e){return t.setContextMenuEvent(e,r)}}})})),1)},Dt=[],Rt=(n("c740"),{props:["part","partIndex"],computed:{insetsBulges:function(){return this.part.insetsBulges},pxPerMm:function(){return this.$store.state.pxPerMm},dash:function(){return[30*this.pxPerMm,15*this.pxPerMm]},selectedColor:function(){return this.$store.state.selectedColor},configs:function(){var t=this;return this.insetsBulges.map((function(e){return{id:e.id,points:e.pointsInPx,closed:!0,dash:t.dash,stroke:t.selectedColor,type:e.type}}))},selectedElId:function(){return this.$store.state.selectedElId},currentElId:function(){return this.$store.state.currentElId},contextMenuAction:function(){return this.$store.state.contextMenuAction}},watch:{contextMenuAction:function(t){t.partIndex===this.partIndex&&"deleteInsetBulge"===t.action&&this.deleteInsetBulge(t)}},methods:{setContextMenuEvent:function(t,e){var n=this.partIndex;this.$store.commit("setContextMenuEvent",{e:t,partIndex:n,insetBulgeIndex:e})},deleteInsetBulge:function(t){var e=this,n=this.insetsBulges[t.insetBulgeIndex].pointsId,r=this.partIndex;this.$store.commit("setSelectedElId",null);var i=this.part.points.findIndex((function(t){return n.includes(t.id)}));new Array(4).fill("").forEach((function(){e.$store.commit("deletePoint",{partIndex:r,pointIndex:i})}))}}}),Ft=Rt,Nt=Object(I["a"])(Ft,At,Dt,!1,null,null,null),Wt=Nt.exports,qt=function(t){var e,n=t.type,r=t.color,i=t.size||10,o="rotate(90 ".concat(i/2," ").concat(i/2,")");switch(n){case"dots":e="\n        <svg xmlns='http://www.w3.org/2000/svg' width='".concat(i,"' height='").concat(i,'\'>\n          <circle cx="1" cy="1" r="1" fill="').concat(r,'"/>\n        </svg>\n      ');break;case"verticalLines":e="\n        <svg xmlns='http://www.w3.org/2000/svg' width='".concat(i/2,"' height='").concat(i,"'>\n          <rect x='0' y='0' width='1' height='").concat(i,"' fill='").concat(r,"' />\n        </svg>\n      ");break;case"horizontalLines":e="\n        <svg xmlns='http://www.w3.org/2000/svg' width='".concat(i,"' height='").concat(i/2,"'>\n          <rect x='0' y='0' width='").concat(i,"' height='1' fill='").concat(r,"' />\n        </svg>\n      ");break;case"rightDiagonalLines":e="\n        <svg xmlns='http://www.w3.org/2000/svg' width='".concat(i,"' height='").concat(i,"'>\n          <path d='M-1,1 l2,-2 M0,10 l10,-10 M9,11 l2,-2' stroke='").concat(r,"' stroke-width='1'/>\n        </svg>\n      ");break;case"leftDiagonalLines":e="\n        <svg xmlns='http://www.w3.org/2000/svg' width='".concat(i,"' height='").concat(i,"'>\n          <path d='M-1,1 l2,-2 M0,10 l10,-10 M9,11 l2,-2' stroke='").concat(r,"' stroke-width='1' transform=\"").concat(o,'"/>\n        </svg>\n      ');break;case"rightSmallDiagonalLines":e="\n        <svg xmlns='http://www.w3.org/2000/svg' width='5' height='5'>\n          <path d='M0 5L5 0ZM6 4L4 6ZM-1 1L1 -1Z' stroke='".concat(r,"' stroke-width='1'/>\n        </svg>\n      ");break;case"rhombus":e="\n        <svg xmlns='http://www.w3.org/2000/svg' width='8' height='8'>\n          <path d='M0 0L8 8ZM8 0L0 8Z' stroke-width='0.5' stroke='".concat(r,"'/>\n        </svg>\n      ");break;default:return null}var s=(new XMLSerializer).serializeToString(D()(e)[0]),a=new Image;return a.src="data:image/svg+xml;charset=utf-8,".concat(s),a},Ht={props:["partIndex","part"],data:function(){return{}},components:{Borders:It,Points:zt,InsetsBulges:Wt},computed:{selectedElId:function(){return this.$store.state.selectedElId},currentElId:function(){return this.$store.state.currentElId},curves:function(){var t={};return this.part.borders.forEach((function(e){if("curveBorder"===e.type){var n=e.radiusInPx,r=e.pointsInPx,i={x:r[0],y:r[1]},o={x:r[2],y:r[3]},s={x:.5*(i.x+o.x),y:.5*(i.y+o.y)},a=-(o.y-i.y),c=o.x-i.x,d=Math.sqrt(Math.pow(a,2)+Math.pow(c,2));a/=d,c/=d;var l=Math.sqrt(Math.pow(s.x-i.x,2)+Math.pow(s.y-i.y,2)),u=l/n;if(!(u<-1||u>1)){var h=Math.sqrt(1-Math.pow(u,2)),p=n*h,m={x:s.x+a*p,y:s.y+c*p},f={x:s.x-a*p,y:s.y-c*p},g=Math.atan2(i.y-m.y,i.x-m.x),x=Math.atan2(o.y-m.y,o.x-m.x),v=Math.sqrt(Math.pow(o.x-i.x,2)+Math.pow(o.y-i.y,2)),b=(o.x-i.x)/v,I=Math.acos(b),y=i.x>o.x?i.y-o.y:o.y-i.y,M=y>0?-1:1;t[e.id]={c1:e.isInside?f:m,p1:i,p2:o,R:n,ang1:e.isInside?Math.PI+2*Math.abs(1.57-I)*M-g:g,ang2:e.isInside?Math.PI+2*Math.abs(1.57-I)*M-x:x,isInside:e.isInside}}}})),t},partShapeConfig:function(){var t=this.part,e=t.points,n=t.borders,r=t.type,i=this.curves;return{type:r,id:this.part.id,sceneFunc:function(t,r){t.beginPath(),t.moveTo.apply(t,Object(Z["a"])(e[0].cInPx)),e.forEach((function(e,r){if("lineBorder"===n[r].type)t.lineTo.apply(t,Object(Z["a"])(e.cInPx));else if("curveBorder"===n[r].type){var o=i[n[r].id];t.arc(o.c1.x,o.c1.y,o.R,o.ang1,o.ang2,o.isInside)}})),t.fillStrokeShape(r)}}},otherPartsBB:function(){var t=this;return this.$store.getters.boundingBoxes.filter((function(e){return e.id!==t.part.id}))},myBB:function(){return this.$store.getters.boundingBoxes[this.partIndex]},groupConfig:function(){var t=this.otherPartsBB,e=this.myBB.absolute,n=null,r={type:"part",draggable:!0,dragBoundFunc:function(r){var i=r;if(t.length){var o=e.x1+r.x,s=e.x2+r.x,a=e.y1+r.y,c=e.y2+r.y,d=t.some((function(t){var r=t.relative;if(o>=r.x2||s<=r.x1)return!1;if(a>=r.y2||c<=r.y1)return!1;var d={x:0,y:0};return d.x=s>r.x2?r.x2-o:s-r.x1,d.y=c>r.y2?r.y2-a:c-r.y1,d.x<d.y&&(null===n||"x"===n)?(i.x=s>=r.x2?r.x2-e.x1:r.x1-e.x2,n="x"):(i.y=c>=r.y2?r.y2-e.y1:r.y1-e.y2,n="y"),!0}));n=d?n:null}return i}};return this.part.position&&Object.assign(r,Object(N["a"])({},this.part.position)),r},fill:function(){var t=this.$store.state.parts.partsInit[this.partIndex].fill,e={color:null,image:null};return t?("color"===t?e.color="#80808054":e.image=qt({type:t,color:"rgb(200,200,200)"}),e):e},contextMenuAction:function(){return this.$store.state.contextMenuAction}},watch:{contextMenuAction:function(t){var e=this;t.partIndex===this.partIndex&&"deletePart"===t.action&&setTimeout((function(){e.$store.commit("deletePart",t.partIndex),e.$store.commit("addLog")}),0)}},methods:{log:function(t){"part"===t.target.attrs.type&&this.setPartPosition(t.target.getPosition())},setPartPosition:function(t){this.$store.commit("setPartPosition",{i:this.partIndex,pos:t}),this.$store.commit("addLog")},setContextMenuEvent:function(t){var e=this.partIndex;this.$store.commit("setContextMenuEvent",{e:t,partIndex:e})}}},Kt=Ht,Jt=Object(I["a"])(Kt,J,U,!1,null,null,null),Ut=Jt.exports,Zt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.element?n("div",{staticClass:"d-inline-block bg-white p-4 position-absolute element-menu"},["lineBorder"===t.element.type?n("line-border"):t._e(),"curveBorder"===t.element.type?n("curve-border"):t._e(),["inset","bulge"].includes(t.element.type)?n("inset-bulge"):t._e(),"edge"===t.element.type?n("edge",{attrs:{initType:t.element.edgeType}}):t._e(),"part"===t.element.type?n("part-menu"):t._e(),["totalText","partText"].includes(t.element.type)?n("text-menu"):t._e()],1):t._e()},Xt=[],Yt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("form",{on:{submit:function(e){return e.preventDefault(),t.setBorderLength(e)}}},[n("div",{staticClass:"form-group row no-gutters"},[n("label",{staticClass:"col-auto col-form-label text-left"},[t._v("Длина")]),n("div",{staticClass:"col-auto px-1"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.lengthInMm,expression:"lengthInMm"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.lengthInMm},on:{input:function(e){e.target.composing||(t.lengthInMm=e.target.value)}}})]),n("span",{staticClass:"col-auto d-flex align-items-center"},[t._v("мм")])]),n("div",{staticClass:"form-group row no-gutters"},[t._m(0),n("div",{staticClass:"col-auto"},[n("change-line-by-end",{attrs:{element:t.element,points:t.points},on:{setChoosedPoint:function(e){t.choosedPoint=e}}})],1)])])])},Gt=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"col-auto text-left"},[n("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[t._v("Установить")])])}],Qt=(n("a434"),n("3835")),Vt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"btn-group ml-3",attrs:{role:"group",title:"За счет какой стороны менять длину"}},[n("button",{staticClass:"btn",class:["btn"+(1===t.choosed?"":"-outline")+"-secondary"],attrs:{type:"button"},on:{click:function(e){t.choosed=1}}},[n("font-awesome-icon",{style:t.angleStyle,attrs:{icon:"long-arrow-alt-right"}})],1),n("button",{staticClass:"btn",class:["btn"+(t.choosed?"-outline":"")+"-secondary"],attrs:{type:"button"},on:{click:function(e){t.choosed=0}}},[n("font-awesome-icon",{style:t.angleStyle,attrs:{icon:"long-arrow-alt-left"}})],1),n("button",{staticClass:"btn",class:["btn"+("both"===t.choosed?"":"-outline")+"-secondary"],attrs:{type:"button"},on:{click:function(e){t.choosed="both"}}},[n("font-awesome-icon",{style:t.angleStyle,attrs:{icon:"arrows-alt-h"}})],1)])},te=[],ee={props:["element","points"],data:function(){return{choosed:1}},computed:{angleStyle:function(){if(!this.points)return null;var t=this.points,e=t[0],n=t[1],r=Math.sqrt(Math.pow(n.x-e.x,2)+Math.pow(n.y-e.y,2)),i=(n.x-e.x)/r,o=Math.acos(i)*(180/Math.PI);return o=n.y>e.y?o:-o,{transform:"rotate(".concat(o,"deg)")}}},watch:{choosed:{handler:function(t){this.$emit("setChoosedPoint",t)},immediate:!0}}},ne=ee,re=Object(I["a"])(ne,Vt,te,!1,null,null,null),ie=re.exports,oe={components:{ChangeLineByEnd:ie},data:function(){return{choosedPoint:null,lengthInMm:0}},computed:{parts:function(){return this.$store.getters.parts},selectedEl:function(){return this.$store.getters.selectedEl},part:function(){return this.parts[this.selectedEl.i]},element:function(){return this.selectedEl.el},elementId:function(){return this.element.id},points:function(){var t=this.clone(this.element.points),e=this.element.pointsId;return t=[{x:t[0],y:t[1],id:e[0]},{x:t[2],y:t[3],id:e[1]}].sort((function(t,e){return t.x-e.x})),t[0].x===t[1].x&&(t=t.sort((function(t,e){return t.y-e.y}))),t},pxPerMm:function(){return this.$store.state.pxPerMm},currentLengthInMm:function(){var t=Object(Qt["a"])(this.points,2),e=t[0],n=t[1],r=Math.sqrt(Math.pow(n.x-e.x,2)+Math.pow(n.y-e.y,2));return Math.round(r)}},watch:{points:{handler:function(){this.getLength()},immediate:!0}},methods:{getLength:function(){this.lengthInMm=this.currentLengthInMm},setBorderLength:function(){var t=this;return Object(wt["a"])(regeneratorRuntime.mark((function e(){var n,r,i,o,s,a,c,d,l,u,h,p,m,f,g;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.getLinearEquation(),r=n.m,i=n.n,o=t.points,s="both"===t.choosedPoint?[0,1]:[t.choosedPoint],a=[],c=t.currentLengthInMm,d=(o[0].x-o[1].x)/c,l=t.lengthInMm,s.forEach((function(e){var n=t.clone(o[e]),s=e?t.clone(o[0]):t.clone(o[1]),u="both"===t.choosedPoint?(l-c)/2:l-c;if(n.x===s.x){var h=n.y>s.y?1:-1;n.y+=u*h}else if(n.y===s.y){var p=n.x>s.x?1:-1;n.x+=u*p}else{var m=n.y>s.y&&r<0||n.y<s.y&&r>0?1:-1,f=d*u*m;n.x+=f,n.y=n.x*r+i}a.push(n)})),u=t.selectedEl.i,h=t.checkIfNeedFixCurvesRadiuses(a,u),!h.length){e.next=18;break}return p="При изменении данной длины будут увеличены радиус(ы) прилегающих выпуклых/вогнутых линий. Продолжить?",m="Подтверждение",e.next=15,_t({body:p,title:m});case 15:if(f=e.sent,f){e.next=18;break}return e.abrupt("return");case 18:h.length&&h.forEach((function(e){var n=e.j,r=e.radius;t.$store.dispatch("changeRadius",{i:u,j:n,radius:r})})),g=[],t.parts[u].points.some((function(e,n){var r=a.findIndex((function(t){return t.id===e.id}));return r>=0&&(["inset","bulge"].includes(e.subType)&&g.push({insetBulgeId:e.insetBulgeId,fromPointId:e.id,x:a[r].x-e.c[0],y:a[r].y-e.c[1]}),t.$store.dispatch("changePoint",{i:u,j:n,point:a.splice(r,1)[0]})),!a.length})),g.length&&g.forEach((function(e){var n=t.part.insetsBulges.find((function(t){return t.id===e.insetBulgeId}));n.pointsId.filter((function(t){return t!==e.fromPointId})).forEach((function(n){var r=t.part.points.findIndex((function(t){return t.id===n})),i=Object(Qt["a"])(t.part.points[r].c,2),o=i[0],s=i[1];t.$store.dispatch("changePoint",{i:u,j:r,point:{x:o+e.x,y:s+e.y}})}))})),t.$store.commit("addLog");case 23:case"end":return e.stop()}}),e)})))()},getLinearEquation:function(){var t=this.points,e=(t[1].y-t[0].y)/(t[1].x-t[0].x),n=-t[0].x*e+t[0].y;return{m:e,n:n}},checkIfNeedFixCurvesRadiuses:function(t,e){var n=t.map((function(t){return t.id})),r=[];return this.parts[e].borders.some((function(e,i){if("curveBorder"!==e.type)return!1;var o=e.pointsId.findIndex((function(t){return n.includes(t)}));if(o<0)return!1;var s=t.find((function(t){return t.id===e.pointsId[o]})),a=0===o?{x:e.points[2],y:e.points[3]}:{x:e.points[0],y:e.points[1]},c=Math.sqrt(Math.pow(a.x-s.x,2)+Math.pow(a.y-s.y,2))/2+2;return!(e.radius>=c)&&(r.push({j:i,radius:c}),!0)})),r}}},se=oe,ae=Object(I["a"])(se,Yt,Gt,!1,null,null,null),ce=ae.exports,de=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("form",{on:{submit:function(e){return e.preventDefault(),t.setParams(e)}}},[n("div",{staticClass:"form-group row no-gutters"},[n("label",{staticClass:"col-auto col-form-label text-left"},[t._v("Радиус")]),n("div",{staticClass:"col-auto px-1"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.radiusInMm,expression:"radiusInMm"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.radiusInMm},on:{input:function(e){e.target.composing||(t.radiusInMm=e.target.value)}}})]),n("span",{staticClass:"col-auto d-flex align-items-center"},[t._v("мм")]),n("div",{staticClass:"w-100"}),n("small",{staticClass:"form-text text-muted col-auto text-left"},[t._v(" "+t._s("Минимальный радиус "+t.minRadius+" мм")+" ")])]),n("div",{staticClass:"form-group row no-gutters"},[n("label",{staticClass:"col-auto col-form-label text-left"},[t._v("Длина по прямой")]),n("div",{staticClass:"col-auto px-1"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.lengthInMm,expression:"lengthInMm"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.lengthInMm},on:{input:function(e){e.target.composing||(t.lengthInMm=e.target.value)}}})]),n("span",{staticClass:"col-auto d-flex align-items-center"},[t._v("мм")]),n("div",{staticClass:"w-100"}),n("small",{staticClass:"form-text text-muted col-auto text-left"},[t._v(" "+t._s("Максимальная длина "+t.maxLength+" мм")+" ")])]),n("div",{staticClass:"form-group row no-gutters"},[t._m(0),n("div",{staticClass:"col-auto"},[n("change-line-by-end",{attrs:{element:t.element,points:t.points},on:{setChoosedPoint:function(e){t.choosedPoint=e}}})],1)])])])},le=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"col-auto text-left"},[n("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[t._v("Установить")])])}],ue={components:{ChangeLineByEnd:ie},data:function(){return{radiusInMm:0,choosedPoint:null,lengthInMm:0}},computed:{parts:function(){return this.$store.getters.parts},selectedEl:function(){return this.$store.getters.selectedEl},element:function(){return this.selectedEl.el},elementId:function(){return this.element.id},pxPerMm:function(){return this.$store.state.pxPerMm},points:function(){var t=this.clone(this.element.points),e=this.element.pointsId;return t=[{x:t[0],y:t[1],id:e[0]},{x:t[2],y:t[3],id:e[1]}].sort((function(t,e){return t.x-e.x})),t[0].x===t[1].x&&(t=t.sort((function(t,e){return t.y-e.y}))),t},currentLengthInMm:function(){var t=Object(Qt["a"])(this.points,2),e=t[0],n=t[1],r=Math.sqrt(Math.pow(n.x-e.x,2)+Math.pow(n.y-e.y,2));return Math.round(r)},minRadius:function(){return Math.round(this.lengthInMm/2)+2},maxLength:function(){return 2*this.radiusInMm-2}},watch:{points:{handler:function(){this.radiusInMm=Math.round(this.element.radius),this.lengthInMm=this.currentLengthInMm},immediate:!0}},methods:{setParams:function(){this.lengthInMm>this.maxLength?$t.a.warning("При таком радиусе длина не может быть больше ".concat(this.maxLength," мм")):this.radiusInMm<this.minRadius?$t.a.warning("Радиус не может быть меньше ".concat(this.minRadius," мм")):(this.setRadius(),this.setBorderLength(),this.$store.commit("addLog"))},setRadius:function(){var t=this.selectedEl,e=t.i,n=t.j;this.$store.dispatch("changeRadius",{i:e,j:n,radius:this.radiusInMm})},setBorderLength:function(){var t=this;return Object(wt["a"])(regeneratorRuntime.mark((function e(){var n,r,i,o,s,a,c,d,l,u,h,p,m,f;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.getLinearEquation(),r=n.m,i=n.n,o=t.points,s="both"===t.choosedPoint?[0,1]:[t.choosedPoint],a=[],c=t.currentLengthInMm,d=(o[0].x-o[1].x)/c,l=t.lengthInMm,s.forEach((function(e){var n=t.clone(o[e]),s=e?t.clone(o[0]):t.clone(o[1]),u="both"===t.choosedPoint?(l-c)/2:l-c;if(n.x===s.x){var h=n.y>s.y?1:-1;n.y+=u*h}else if(n.y===s.y){var p=n.x>s.x?1:-1;n.x+=u*p}else{var m=n.y>s.y&&r<0||n.y<s.y&&r>0?1:-1,f=d*u*m;n.x+=f,n.y=n.x*r+i}a.push(n)})),u=t.selectedEl.i,h=t.checkIfNeedFixCurvesRadiuses(a,u),!h.length){e.next=18;break}return p="При изменении данной длины будут увеличены радиус(ы) прилегающих выпуклых/вогнутых линий. Продолжить?",m="Подтверждение",e.next=15,_t({body:p,title:m});case 15:if(f=e.sent,f){e.next=18;break}return e.abrupt("return");case 18:h.length&&h.forEach((function(e){var n=e.j,r=e.radius;t.$store.dispatch("changeRadius",{i:u,j:n,radius:r})})),t.parts[u].points.some((function(e,n){var r=a.findIndex((function(t){return t.id===e.id}));return r>=0&&t.$store.dispatch("changePoint",{i:u,j:n,point:a.splice(r,1)[0]}),!a.length}));case 20:case"end":return e.stop()}}),e)})))()},getLinearEquation:function(){var t=this.points,e=(t[1].y-t[0].y)/(t[1].x-t[0].x),n=-t[0].x*e+t[0].y;return{m:e,n:n}},checkIfNeedFixCurvesRadiuses:function(t,e){var n=t.map((function(t){return t.id})),r=[];return this.parts[e].borders.some((function(e,i){if("curveBorder"!==e.type)return!1;var o=e.pointsId.findIndex((function(t){return n.includes(t)}));if(o<0)return!1;var s=t.find((function(t){return t.id===e.pointsId[o]})),a=0===o?{x:e.points[2],y:e.points[3]}:{x:e.points[0],y:e.points[1]},c=Math.sqrt(Math.pow(a.x-s.x,2)+Math.pow(a.y-s.y,2))/2+2;return!(e.radius>=c)&&(r.push({j:i,radius:c}),!0)})),r}}},he=ue,pe=Object(I["a"])(he,de,le,!1,null,null,null),me=pe.exports,fe=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("form",{on:{submit:function(e){return e.preventDefault(),t.setParams(e)}}},[n("div",{staticClass:"form-group row no-gutters"},[n("label",{staticClass:"col-auto col-form-label text-left"},[t._v("Внешняя длина")]),n("div",{staticClass:"col-auto px-1"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.outLengthInMm,expression:"outLengthInMm"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.outLengthInMm},on:{input:function(e){e.target.composing||(t.outLengthInMm=e.target.value)}}})]),n("span",{staticClass:"col-auto d-flex align-items-center"},[t._v("мм")])]),n("div",{staticClass:"form-group row no-gutters"},[n("label",{staticClass:"col-auto col-form-label text-left"},[t._v("Внутренняя длина")]),n("div",{staticClass:"col-auto px-1"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.inLengthInMm,expression:"inLengthInMm"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.inLengthInMm},on:{input:function(e){e.target.composing||(t.inLengthInMm=e.target.value)}}})]),n("span",{staticClass:"col-auto d-flex align-items-center"},[t._v("мм")])]),n("div",{staticClass:"form-group row no-gutters"},[n("label",{staticClass:"col-auto col-form-label text-left"},[t._v("Глубина")]),n("div",{staticClass:"col-auto px-1"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.depthInMm,expression:"depthInMm"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.depthInMm},on:{input:function(e){e.target.composing||(t.depthInMm=e.target.value)}}})]),n("span",{staticClass:"col-auto d-flex align-items-center"},[t._v("мм")])]),t._m(0)])])},ge=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"form-group row no-gutters"},[n("div",{staticClass:"col-auto text-left"},[n("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[t._v("Установить")])])])}],xe={data:function(){return{outLengthInMm:0,inLengthInMm:0,depthInMm:0}},computed:{parts:function(){return this.$store.getters.parts},selectedEl:function(){return this.$store.getters.selectedEl},element:function(){return this.selectedEl.el},points:function(){var t=this,e=this.element.pointsId.map((function(e,n){return{id:e,c:[t.element.points[2*n],t.element.points[2*n+1]]}}));return{out:"inset"===this.element.type?[e[0],e[3]]:[e[1],e[2]],in:"inset"===this.element.type?[e[1],e[2]]:[e[0],e[3]]}},currentOutLength:function(){var t=this.points.out.map((function(t){return t.c}));return Math.sqrt(Math.pow(t[1][0]-t[0][0],2)+Math.pow(t[1][1]-t[0][1],2))},currentInLength:function(){var t=this.points.in.map((function(t){return t.c}));return Math.sqrt(Math.pow(t[1][0]-t[0][0],2)+Math.pow(t[1][1]-t[0][1],2))}},watch:{points:{handler:function(){this.outLengthInMm=Math.round(this.currentOutLength),this.inLengthInMm=Math.round(this.currentInLength),this.depthInMm=this.element.depth},immediate:!0}},methods:{setParams:function(){if(Math.round(this.outLengthInMm)!==Math.round(this.currentOutLength)&&this.setPoints(this.points.out,this.outLengthInMm,this.currentOutLength),Math.round(this.inLengthInMm)!==Math.round(this.currentInLength)&&this.setPoints(this.points.in,this.inLengthInMm,this.currentInLength),Math.round(this.depthInMm)!==Math.round(this.element.depth)){var t=this.points["inset"===this.element.type?"in":"out"];this.setDepth(t,this.depthInMm,this.element.depth)}this.$store.commit("addLog")},setPoints:function(t,e,n){var r=new Q.a(t[0].c[0],t[0].c[1]),i=new Q.a(t[1].c[0]-t[0].c[0],t[1].c[1]-t[0].c[1]),o=Math.abs(e-n)/2,s=e>n?180:0;i=i.norm().rotateDeg(s).multiply(new Q.a(o,o)),r=i.clone().add(r),this.setPoint({id:t[0].id,c:r.toObject()}),i=i.norm().rotateDeg(s).multiply(new Q.a(e,e)),r=i.clone().add(r),this.setPoint({id:t[1].id,c:r.toObject()})},setPoint:function(t){var e={i:this.selectedEl.i,j:this.parts[this.selectedEl.i].points.findIndex((function(e){return e.id===t.id})),point:t.c};this.$store.dispatch("changePoint",e)},setDepth:function(t,e,n){var r=new Q.a(t[0].c[0],t[0].c[1]),i=new Q.a(t[1].c[0]-t[0].c[0],t[1].c[1]-t[0].c[1]),o=i.length(),s=Math.abs(e-n),a=e>n&&"inset"===this.element.type||e<n&&"bulge"===this.element.type?1:-1;i=i.norm().rotateDeg(90*a).multiply(new Q.a(s,s)),r=i.clone().add(r),this.setPoint({id:t[0].id,c:r.toObject()}),i=i.norm().rotateDeg(-90*a).multiply(new Q.a(o,o)),r=i.clone().add(r),this.setPoint({id:t[1].id,c:r.toObject()});var c=this.selectedEl,d=c.i,l=c.j;this.$store.commit("setInsetBulgeDepth",{i:d,j:l,depth:e})}}},ve=xe,be=Object(I["a"])(ve,fe,ge,!1,null,null,null),Ie=be.exports,ye=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("p",{staticClass:"mb-0 text-left"},[t._v("Тип")]),t._l(t.types,(function(e){return n("div",{key:e.type,staticClass:"custom-control custom-radio text-left"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.selectedType,expression:"selectedType"}],staticClass:"custom-control-input",attrs:{type:"radio",id:e.type},domProps:{value:e.type,checked:t._q(t.selectedType,e.type)},on:{change:function(n){t.selectedType=e.type}}}),n("label",{staticClass:"custom-control-label d-flex align-items-center",attrs:{for:e.type}},[n("img",{staticClass:"mx-2",staticStyle:{width:"1rem"},attrs:{src:t.files[e.type].src}}),t._v(" "+t._s(e.name)+" ")])])}))],2)},Me=[],we={props:["initType"],data:function(){return{types:[{name:"Empty",type:"empty"},{name:"Half",type:"half"},{name:"Full",type:"full"}],selectedType:this.initType}},computed:{selectedEl:function(){return this.$store.getters.selectedEl},files:function(){return this.$store.state.files.edges}},watch:{selectedType:function(t){var e=this.selectedEl,n=e.i,r=e.j;this.$store.commit("setEdgeTagParams",{i:n,j:r,edgeType:t}),this.$store.commit("addLog")}}},Ee=we,$e=Object(I["a"])(Ee,ye,Me,!1,null,null,null),Pe=$e.exports,Ce=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("p",{staticClass:"mb-0 text-left"},[t._v("Фон")]),n("select",{directives:[{name:"model",rawName:"v-model",value:t.fill,expression:"fill"}],staticClass:"custom-select",on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.fill=e.target.multiple?n:n[0]}}},[n("option",{domProps:{value:null}},[t._v("Без фона")]),n("option",{attrs:{value:"color"}},[t._v("Цвет")]),n("option",{attrs:{value:"dots"}},[t._v("Точки")]),n("option",{attrs:{value:"verticalLines"}},[t._v("Вертикальные линии")]),n("option",{attrs:{value:"horizontalLines"}},[t._v("Горизонтальные линии")]),n("option",{attrs:{value:"rightDiagonalLines"}},[t._v("Правый штрих")]),n("option",{attrs:{value:"leftDiagonalLines"}},[t._v("Левый штрих")]),n("option",{attrs:{value:"rightSmallDiagonalLines"}},[t._v("Мелкий штрих")]),n("option",{attrs:{value:"rhombus"}},[t._v("Ромб")])])])},Te=[],ke={data:function(){return{fill:null}},computed:{selectedEl:function(){return this.$store.getters.selectedEl}},watch:{fill:function(t){this.$store.commit("setPartFill",{fill:t,i:this.selectedEl.i}),this.$store.commit("addLog")},selectedEl:function(t){t.el.fill!==this.fill&&(this.fill=this.selectedEl.el.fill)}},mounted:function(){this.fill=this.selectedEl.el.fill}},Be=ke,je=Object(I["a"])(Be,Ce,Te,!1,null,null,null),_e=je.exports,Se=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"text-left"},[n("p",{staticClass:"mb-0 text-left"},[t._v("Размер шрифта")]),t._l(5,(function(e){return n("button",{key:e,staticClass:"btn btn-outline-secondary mr-1",class:{active:t.fontSizeK===t.sizes[e-1]},on:{click:function(n){return t.setFontSize(e-1)}}},[n("font-awesome-icon",{style:{transform:"scale("+t.sizes[e-1]/3+")"},attrs:{icon:"font"}})],1)}))],2)},Oe=[],Le={data:function(){return{sizes:[1,1.5,2,2.5,3]}},computed:{selectedEl:function(){return this.$store.getters.selectedEl},fontSizeK:function(){return this.selectedEl.el.fontSizeK}},watch:{fill:function(t){this.$store.commit("setPartFill",{fill:t,i:this.selectedEl.i}),this.$store.commit("addLog")},selectedEl:function(t){t.el.fill!==this.fill&&(this.fill=this.selectedEl.el.fill)}},mounted:function(){this.fill=this.selectedEl.el.fill},methods:{setFontSize:function(t){this.fontSizeK!==this.sizes[t]&&(this.$store.commit("setTextParams",Object(N["a"])(Object(N["a"])({i:this.selectedEl.i},this.selectedEl.el),{},{fontSizeK:this.sizes[t]})),this.$store.commit("addLog"))}}},ze=Le,Ae=Object(I["a"])(ze,Se,Oe,!1,null,null,null),De=Ae.exports,Re={components:{LineBorder:ce,CurveBorder:me,InsetBulge:Ie,Edge:Pe,PartMenu:_e,TextMenu:De},computed:{element:function(){return this.$store.getters.selectedEl.el}}},Fe=Re,Ne=(n("ef9c"),Object(I["a"])(Fe,Zt,Xt,!1,null,null,null)),We=Ne.exports,qe=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"d-inline-block bg-white position-absolute logs-menu"},[n("button",{ref:"logBack",staticClass:"btn btn-outline-dark mr-2",attrs:{type:"button",disabled:t.disabledBack},on:{click:function(e){return t.$store.commit("logBack")}}},[n("font-awesome-icon",{attrs:{icon:"reply"}})],1),n("button",{ref:"logForward",staticClass:"btn btn-outline-dark",attrs:{type:"button",disabled:t.disabledForward},on:{click:function(e){return t.$store.commit("logForward")}}},[n("font-awesome-icon",{attrs:{icon:"share"}})],1),n("save")],1)},He=[],Ke=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"d-inline-block"},[n("button",{staticClass:"btn btn-outline-dark ml-2",attrs:{type:"button",title:"Скачать изображение"},on:{click:t.saveImage}},[n("font-awesome-icon",{attrs:{icon:"file-image"}})],1),n("button",{staticClass:"btn btn-outline-dark ml-2",attrs:{type:"button",title:"Скачать PDF"},on:{click:t.savePDF}},[n("font-awesome-icon",{attrs:{icon:"file-pdf"}})],1)])},Je=[],Ue=n("e511"),Ze=n.n(Ue),Xe={methods:{getDataUrl:function(){var t=this;return new Promise((function(e){var n=t.$store.state.selectedElId;n&&t.$store.commit("setSelectedElId",null),setTimeout((function(){var r={pixelRatio:3,mimeType:"image/jpeg"};e(t.$store.state.stage.toDataURL(r)),n&&t.$store.commit("setSelectedElId",n)}),0)}))},saveImage:function(){var t=this;return Object(wt["a"])(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getDataUrl();case 2:n=e.sent,r=document.createElement("a"),r.download="stage.jpg",r.href=n,document.body.appendChild(r),r.click(),document.body.removeChild(r);case 9:case"end":return e.stop()}}),e)})))()},savePDF:function(){var t=this;return Object(wt["a"])(regeneratorRuntime.mark((function e(){var n,r,i,o,s,a,c,d;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getDataUrl();case 2:n=e.sent,r=new Ze.a("l","mm","a4"),i=r.internal.pageSize.getWidth(),o=r.internal.pageSize.getHeight(),s=i/o,a=t.$store.state.stage.width()/t.$store.state.stage.height(),c=0,d=0,s<a?(o=i/a,c=(r.internal.pageSize.getHeight()-o)/2):(i=o/a,d=(r.internal.pageSize.getWidth()-i)/2),r.addImage(n,"JPEG",d,c,i,o),r.save("stage.pdf");case 13:case"end":return e.stop()}}),e)})))()}}},Ye=Xe,Ge=Object(I["a"])(Ye,Ke,Je,!1,null,null,null),Qe=Ge.exports,Ve={components:{Save:Qe},computed:{logs:function(){return this.$store.state.logs},logStep:function(){return this.$store.state.logStep},disabledBack:function(){return!this.logs.length||!this.logStep},disabledForward:function(){return this.logStep>=this.logs.length-1}},mounted:function(){var t=this;window.addEventListener("keydown",(function(e){e.ctrlKey&&("KeyZ"===e.code?t.$refs.logBack.click():"KeyY"===e.code&&t.$refs.logForward.click())}))}},tn=Ve,en=(n("e572"),Object(I["a"])(tn,qe,He,!1,null,null,null)),nn=en.exports,rn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.style?n("div",{staticClass:"position-absolute",style:t.style},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.text,expression:"text"}],ref:"text",staticClass:"w-100 h-100",staticStyle:{"line-height":"1",resize:"none"},domProps:{value:t.text},on:{blur:t.saveText,input:function(e){e.target.composing||(t.text=e.target.value)}}})]):t._e()},on=[],sn=(n("498a"),{data:function(){return{text:"",width:0,height:0}},computed:{selectedEl:function(){return this.$store.getters.selectedEl},isTextEditMode:function(){return this.$store.state.isTextEditMode},pxPerMm:function(){return this.$store.state.pxPerMm},style:function(){var t=this.selectedEl.el;if(!t||!this.isTextEditMode)return null;if(!["text","totalText"].includes(t.type))return null;var e,n=this.$store.state.fontSizeInmM.text*this.pxPerMm*this.selectedEl.el.fontSizeK;if("totalText"===t.type){e={top:"".concat(t.y,"px"),left:"".concat(t.x,"px"),fontSize:"".concat(Math.round(n),"px")};var r=this.$store.state.stage.find("Text"),i=r.toArray().find((function(e){return e.id()===t.id})),o=i.width(),s=i.height();return o&&(e.width="".concat(o+30,"px")),s>n&&(e.height="".concat(s+10,"px")),e}return null}},watch:{style:function(t){var e=this;t&&(this.text=this.selectedEl.el.text,setTimeout((function(){e.$refs.text.focus()}),0))}},methods:{saveText:function(){var t=this.text.trim(),e=this.selectedEl,n=e.i,r=e.j,i=e.el,o=i.type,s={i:n,j:r,type:o};t.length?(this.$store.commit("setTextBlock",Object(N["a"])(Object(N["a"])({},s),{},{text:t})),this.$store.commit("addLog")):(this.$store.commit("deleteTextBlock",s),i.text.length&&this.$store.commit("addLog")),this.$store.commit("setTextEditMode",!1)}}}),an=sn,cn=Object(I["a"])(an,rn,on,!1,null,null,null),dn=cn.exports,ln=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-text",{attrs:{config:{type:t.text.type,id:t.text.id,x:t.text.x,y:t.text.y,text:t.text.text,fontFamily:"Calibri",fontSize:t.fontSize,fill:[t.currentElId,t.selectedElId].includes(t.text.id)?t.selectedColor:"black",draggable:!0,visible:!(t.selectedElId===t.text.id&&t.isTextEditMode)}},on:{mouseover:function(e){t.over=!0},mouseleave:function(e){t.over=!1},dragend:t.dragend,click:function(e){return t.$store.commit("setSelectedElId",t.text.id)},dblclick:t.editText,contextmenu:t.setContextMenuEvent}})],1)},un=[],hn={props:["text","textIndex"],data:function(){return{over:!1}},computed:{selectedColor:function(){return this.$store.state.selectedColor},selectedElId:function(){return this.$store.state.selectedElId},currentElId:function(){return this.$store.state.currentElId},pxPerMm:function(){return this.$store.state.pxPerMm},fontSize:function(){return this.$store.state.fontSizeInmM.text*this.pxPerMm*this.text.fontSizeK},isTextEditMode:function(){return this.$store.state.isTextEditMode},contextMenuAction:function(){return this.$store.state.contextMenuAction}},watch:{over:function(t){t?(this.$store.commit("setCursor","move"),this.$store.commit("setCurrentEl",this.text.id)):(this.$store.commit("resetCursor"),this.$store.commit("setCurrentEl",null))},contextMenuAction:function(t){t.textIndex===this.textIndex&&"deleteTotalText"===t.action&&(this.$store.commit("deleteTextBlock",{type:"totalText",i:t.textIndex}),this.$store.commit("addLog"))}},methods:{dragend:function(t){var e=t.target.getPosition();this.$store.commit("setTextParams",Object(N["a"])(Object(N["a"])(Object(N["a"])({},this.text),e),{},{i:this.textIndex})),this.$store.commit("addLog")},editText:function(){this.$store.commit("setTextEditMode",!0)},setContextMenuEvent:function(t){var e=this.textIndex;this.$store.commit("setContextMenuEvent",{e:t,textIndex:e,type:"totalText"})}}},pn=hn,mn=Object(I["a"])(pn,ln,un,!1,null,null,null),fn=mn.exports,gn={mixins:[x],components:{ContextMenu:K,Part:Ut,ElementMenu:We,Logs:nn,TextEdit:dn,TotalText:fn},data:function(){return{content:"",editorOptions:{placeholder:"Введите текст"}}},computed:{contextMenuAction:function(){return this.$store.state.contextMenuAction},parts:function(){return this.$store.getters.parts},totalTexts:function(){return this.$store.state.parts.totalTexts},canvasHeightInMm:function(){return this.$store.state.canvasHeightInMm},canvasWidthInMm:function(){return this.$store.state.canvasWidthInMm},canvasWidthInPx:function(){return this.canvasWidthInMm?this.canvasWidthInMm*this.pxPerMm:0},pxPerMm:function(){return this.$store.state.pxPerMm},cursor:function(){return this.$store.state.cursor},selectedEl:function(){return this.$store.getters.selectedEl}},watch:{cursor:function(t){this.$refs.stage.getNode().container().style.cursor=t}},mounted:function(){var t=this,e=this.$el.clientHeight/this.canvasHeightInMm;this.$store.commit("setPxPerMm",e);var n=this.$el.clientWidth/e;this.$store.commit("setCanvasWidthInMm",n);var r=1e3,i=2e3,o=[(n-r)/2,(this.canvasHeightInMm-i)/2],s={id:this.getId(),position:{x:0,y:0},fill:null,type:"part",points:[{id:this.getId(),c:o},{id:this.getId(),c:[o[0]+r,o[1]]},{id:this.getId(),c:[o[0]+r,o[1]+i]},{id:this.getId(),c:[o[0],o[1]+i]}]};s.borders=s.points.map((function(){return{id:t.getId(),type:"lineBorder",sizeTag:{isShown:!0},radiusPosition:"usual"}})),this.$store.commit("addPart",s),this.$store.commit("addLog"),D()(this.$refs.nocontext).on("contextmenu",(function(t){return t.preventDefault()})),this.$store.commit("setStage",this.$refs.stage.getNode()),window.addEventListener("keypress",(function(e){if("Delete"===e.code&&t.selectedEl.el){var n;switch(t.selectedEl.el.type){case"part":n={action:"deletePart",partIndex:t.selectedEl.i};break;case"totalText":n={action:"deleteTotalText",textIndex:t.selectedEl.i};break;default:return}t.$store.commit("setContextMenuAction",n)}}))},methods:{deselect:function(t){"bgRect"===t.target.attrs.type&&this.$store.commit("setSelectedElId",null)}}},xn=gn,vn=Object(I["a"])(xn,L,z,!1,null,null,null),bn=vn.exports,In={components:{Konva:bn},data:function(){return{isMounted:!1}},mounted:function(){this.isMounted=!0}},yn=In,Mn=Object(I["a"])(yn,S,O,!1,null,null,null),wn=Mn.exports,En={components:{Manage:_,Canvas:wn}},$n=En,Pn=Object(I["a"])($n,u,h,!1,null,null,null),Cn=Pn.exports,Tn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"modal",staticClass:"modal",attrs:{id:"confirm_modal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalCenterTitle","aria-hidden":"true","data-result":t.result}},[t._m(0)])},kn=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"modal-dialog modal-dialog-centered",attrs:{role:"document"}},[n("div",{staticClass:"modal-content"},[n("div",{staticClass:"modal-header"},[n("h5",{staticClass:"modal-title"}),n("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[n("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])]),n("div",{staticClass:"modal-body text-left",staticStyle:{"white-space":"pre-wrap"}}),n("div",{staticClass:"modal-footer"})])])}],Bn={data:function(){return{result:0}},mounted:function(){var t=this;D()(this.$refs.modal).on("show.bs.modal",(function(){t.result=0,D()(t.$refs.modal).find("input").length&&setTimeout((function(){D()(t.$refs.modal).find("input").trigger("focus")}),0)})).on("keypress","input",(function(e){["Enter","NumpadEnter"].includes(e.code)&&D()(t.$refs.modal).find(".modal-footer > button[data-action=1]").click()})),D()(this.$refs.modal).on("click",".modal-footer > button",(function(e){t.result=Number(D()(e.target).attr("data-action")),setTimeout((function(){D()(t.$refs.modal).modal("hide")}),0)}))}},jn=Bn,_n=Object(I["a"])(jn,Tn,kn,!1,null,null,null),Sn=_n.exports,On={name:"App",components:{Drawer:Cn,ConfirmModal:Sn},created:function(){this.$store.dispatch("downloadImages")}},Ln=On,zn=(n("5c0b"),Object(I["a"])(Ln,d,l,!1,null,null,null)),An=zn.exports,Dn=(n("b0c0"),n("b64b"),n("2f62")),Rn=n("15fd"),Fn=function(t){return JSON.parse(JSON.stringify(t))},Nn={state:{partsInit:[],totalTexts:[],refreshSelectedElTrigger:0,defaultEdgeType:"empty"},getters:{parts:function(t,e,n){return t.partsInit.map((function(t){var e=Fn(t),r=e.points,i=e.borders,o=n.pxPerMm;return r.forEach((function(t,n){var s=n<r.length-1?n+1:0;i[n].points=[].concat(Object(Z["a"])(t.c),Object(Z["a"])(r[s].c)),i[n].pointsId=[t.id,r[s].id];var a=n?n-1:r.length-1;if(r[n].bordersId=[i[n].id,i[a].id],r[n].pBId=[].concat(Object(Z["a"])(r[n].bordersId),[t.id]),r[n].cInPx=t.c.map((function(t){return t*o})),i[n].pointsInPx=i[n].points.map((function(t){return t*o})),i[n].radius&&(i[n].radiusInPx=i[n].radius*o),["inset","bulge"].includes(t.subType)){var c,d,l=e.insetsBulges.findIndex((function(e){return e.id===t.insetBulgeId}));(c=e.insetsBulges[l].points).push.apply(c,Object(Z["a"])(t.c)),(d=e.insetsBulges[l].pointsInPx).push.apply(d,Object(Z["a"])(r[n].cInPx))}["radiusTag","edgeTag","sizeTag"].forEach((function(t){t in i[n]||(i[n][t]={})})),"angleTag"in t||(r[n].angleTag={})})),e}))},canvasSizeInPx:function(t,e,n){var r=n.canvasHeightInMm,i=n.canvasWidthInMm,o=n.pxPerMm,s={width:0,height:0};return i&&(s.width=i*o,s.height=r*o),s},boundingBoxes:function(t,e){return e.parts.map((function(t){var e=t.points.map((function(t){return t.cInPx[0]})),n=t.points.map((function(t){return t.cInPx[1]})),r={id:t.id,absolute:{x1:Math.min.apply(Math,Object(Z["a"])(e)),x2:Math.max.apply(Math,Object(Z["a"])(e)),y1:Math.min.apply(Math,Object(Z["a"])(n)),y2:Math.max.apply(Math,Object(Z["a"])(n))}};return r.relative={x1:r.absolute.x1+t.position.x,x2:r.absolute.x2+t.position.x,y1:r.absolute.y1+t.position.y,y2:r.absolute.y2+t.position.y},r.width=Math.abs(r.absolute.x2-r.absolute.x1),r.height=Math.abs(r.absolute.y2-r.absolute.y1),r}))},selectedEl:function(t,e,n){var r=n.selectedElId;if(!r)return{};var i={};if(e.parts.some((function(t,e){if(t.id===r)return i={i:e,el:t},!0;var n="points",o=null,s=t.points.findIndex((function(t){return t.id===r}));return s<0&&(o=null,n="borders",s=t.borders.findIndex((function(t){return t.id===r}))),s<0&&(o="edgeTag",n="borders",s=t.borders.findIndex((function(t){return t.edgeTag&&t.edgeTag.id===r}))),s<0&&t.insetsBulges&&(o=null,n="insetsBulges",s=t.insetsBulges.findIndex((function(t){return t.id===r}))),s<0&&t.texts&&t.texts.length&&(o=null,n="texts",s=t.texts.findIndex((function(t){return t.id===r}))),!(s<0)&&(i={i:e,j:s,el:o?t[n][s][o]:t[n][s]},!0)})),!Object.keys(i).length&&t.totalTexts.length){var o=t.totalTexts.findIndex((function(t){return t.id===r}));o>=0&&(i={i:o,el:t.totalTexts[o]})}return i}},mutations:{addPart:function(t,e){t.partsInit.push(e)},movePoint:function(t,e){var n=e.partIndex,i=e.pointIndex,o=e.c;r["default"].set(t.partsInit[n].points[i],"c",o)},addPoint:function(t,e){var n=e.partIndex,r=e.pointIndex,i=e.point;t.partsInit[n].points.splice(r,0,i)},addBorder:function(t,e){var n=e.partIndex,r=e.borderIndex,i=e.border,o=i.sizeTag||{isShown:!0};t.partsInit[n].borders.splice(r,0,Object(N["a"])(Object(N["a"])({},i),{},{sizeTag:o}))},deleteBorder:function(t,e){var n=e.partIndex,r=e.borderIndex;t.partsInit[n].borders.splice(r,1)},deletePoint:function(t,e){var n=e.partIndex,r=e.pointIndex;t.partsInit[n].borders.splice(r,1),t.partsInit[n].points.splice(r,1)},makeBorderCurve:function(t,e){var n=e.partIndex,i=e.borderIndex,o=e.radius,s=Fn(t.partsInit[n].borders[i]);r["default"].set(t.partsInit[n].borders,i,Object.assign(s,{type:"curveBorder",radius:o,isInside:e.isInside,radiusTag:{isShown:!0},edgeTag:{isShown:!1},sizeTag:{isShown:!1}}))},makeBorderLine:function(t,e){var n=e.partIndex,i=e.borderIndex,o=Fn(t.partsInit[n].borders[i]);delete o.radius,delete o.isInside,o.type="lineBorder",o.radiusTag={isShown:!1},o.edgeTag={isShown:!1},o.sizeTag={isShown:!0},r["default"].set(t.partsInit[n].borders,i,o)},addInsetBulge:function(t,e){var n=e.partIndex,i=Object(Rn["a"])(e,["partIndex"]),o=t.partsInit[n].insetsBulges||[];i.points=[],o.push(Object(N["a"])(Object(N["a"])({},i),{},{pointsInPx:[],type:e.type})),r["default"].set(t.partsInit[n],"insetsBulges",o)},setInsetBulgeDepth:function(t,e){var n=e.i,i=e.j,o=e.depth;r["default"].set(t.partsInit[n].insetsBulges[i],"depth",o)},deleteInsetBulge:function(t,e){var n=e.partIndex,r=e.insetBulgeIndex;t.partsInit[n].insetsBulges.splice(r,1)},refreshSelectedEl:function(t){setTimeout((function(){t.refreshSelectedElTrigger=Math.random()}),0)},changePoint:function(t,e){var n=e.i,i=e.j,o=e.point;r["default"].set(t.partsInit[n].points[i],"c",[o.x,o.y])},changeRadius:function(t,e){var n=e.i,i=e.j,o=e.radius;r["default"].set(t.partsInit[n].borders[i],"radius",o)},setPartPosition:function(t,e){var n=e.i,i=e.pos;r["default"].set(t.partsInit[n],"position",i)},toggleSkirting:function(t,e){var n=e.i,i=e.j;r["default"].set(t.partsInit[n].borders[i],"skirting",!t.partsInit[n].borders[i].skirting)},setRadiusTagParams:function(t,e){var n=e.i,i=e.j,o=Object(Rn["a"])(e,["i","j"]);r["default"].set(t.partsInit[n].borders[i],"radiusTag",o)},setEdgeTagParams:function(t,e){var n,i=e.i,o=e.j,s=Object(Rn["a"])(e,["i","j"]);!1===s.isShown?n={}:(n=t.partsInit[i].borders[o].edgeTag||{},Object.assign(n,{edgeType:t.defaultEdgeType,type:"edge"})),r["default"].set(t.partsInit[i].borders[o],"edgeTag",Object(N["a"])(Object(N["a"])({},n),s)),s.edgeType&&(t.defaultEdgeType=s.edgeType)},setSizeTagParams:function(t,e){var n=e.i,i=e.j,o=Object(Rn["a"])(e,["i","j"]);r["default"].set(t.partsInit[n].borders[i],"sizeTag",o)},setAngleTagParams:function(t,e){var n=e.i,i=e.j,o=Object(Rn["a"])(e,["i","j"]);r["default"].set(t.partsInit[n].points[i],"angleTag",o)},setPartFill:function(t,e){var n=e.i,i=e.fill;r["default"].set(t.partsInit[n],"fill",i)},deletePart:function(t,e){t.partsInit.splice(e,1)},addTextBlock:function(t,e){var n=e.i,i=Object(Rn["a"])(e,["i"]);"totalText"===e.type?t.totalTexts.push(Object(N["a"])({},i)):(t.partsInit[n].texts||r["default"].set(t.partsInit[n],"texts",[]),t.partsInit[n].texts.push(Object(N["a"])({},i)))},setTextBlock:function(t,e){"totalText"===e.type?r["default"].set(t.totalTexts[e.i],"text",e.text):r["default"].set(t.partsInit[e.i].texts[e.j],"text",e.text)},deleteTextBlock:function(t,e){"totalText"===e.type?t.totalTexts.splice(e.i,1):t.partsInit[e.i].texts.splice(e.j,1)},setTextParams:function(t,e){var n=e.i,i=(e.j,Object(Rn["a"])(e,["i","j"]));"totalText"===i.type?r["default"].set(t.totalTexts,n,i):r["default"].set(t.partsInit[n].texts[i.j],"x",i.text)}},actions:{refreshSelectedEl:function(t){var e=t.commit,n=t.rootState;n.selectedEl&&e("refreshSelectedEl")},makeBorderCurve:function(t,e){var n=t.commit,r=t.dispatch;n("makeBorderCurve",e),r("refreshSelectedEl")},makeBorderLine:function(t,e){var n=t.commit,r=t.dispatch;n("makeBorderLine",e),r("refreshSelectedEl")},changePoint:function(t,e){var n=t.commit;n("changePoint",e)},changeRadius:function(t,e){var n=t.commit;n("changeRadius",e)},addTextBlock:function(t,e){var n=t.commit;n("addTextBlock",e),n("setSelectedElId",e.id),n("setTextEditMode",!0)}}};r["default"].use(Dn["a"]);var Wn=function(t){return JSON.parse(JSON.stringify(t))},qn=new Dn["a"].Store({state:{stage:null,canvasHeightInMm:4e3,pxPerMm:0,contextMenuEvent:null,cursor:"default",contextMenuAction:{},selectedElId:null,currentElId:null,id:0,fontSizeInmM:{sizeArrow:90,radius:90,text:90},files:{edges:{},fills:{}},logs:[{parts:[],totalTexts:[]}],logStep:0,dash:[1,2],selectedColor:"#536dfe",isTextEditMode:!1},getters:{gridSize:function(){return 10}},mutations:{setStage:function(t,e){t.stage=e},setPxPerMm:function(t,e){t.pxPerMm=e},setCanvasWidthInMm:function(t,e){r["default"].set(t,"canvasWidthInMm",e)},setContextMenuEvent:function(t,e){t.contextMenuEvent=e},setContextMenuAction:function(t,e){t.contextMenuAction=e},setSelectedElId:function(t,e){t.selectedElId=e},setCurrentEl:function(t,e){t.currentElId=e},incrementId:function(t){t.id+=1},addFile:function(t,e){r["default"].set(t.files[e.type],e.name,e.image)},setCursor:function(t,e){t.cursor=e},resetCursor:function(t){t.cursor="default"},addLog:function(t){t.logs.push({parts:Wn(t.parts.partsInit),totalTexts:Wn(t.parts.totalTexts)}),t.logStep+=1,t.logs.splice(t.logStep+1)},logBack:function(t){t.selectedElId=null,t.contextMenuEvent=null,t.parts.partsInit=Wn(t.logs[t.logStep-1].parts),t.parts.totalTexts=Wn(t.logs[t.logStep-1].totalTexts),t.logStep-=1},logForward:function(t){t.selectedElId=null,t.contextMenuEvent=null,t.logStep+=1,t.parts.partsInit=Wn(t.logs[t.logStep].parts),t.parts.totalTexts=Wn(t.logs[t.logStep].totalTexts)},setTextEditMode:function(t,e){t.isTextEditMode=e}},actions:{downloadImages:function(t){var e=t.commit,r={edges:{empty:n("b39e"),half:n("c101"),full:n("eabb"),emptyHover:n("2e97"),halfHover:n("6192"),fullHover:n("7e33")}};Object.keys(r).forEach((function(t){Object.keys(r[t]).forEach((function(n){var i=new Image;i.onload=function(r){e("addFile",{type:t,name:n,image:r.target})},i.src=r[t][n]}))}))}},modules:{parts:Nn}});s["c"].add(a["a"],a["f"],a["d"],a["e"],a["g"],a["i"],a["h"],a["b"],a["c"]),r["default"].component("font-awesome-icon",c["a"]),r["default"].config.productionTip=!1,r["default"].use(o.a),r["default"].mixin({methods:{clone:function(t){return JSON.parse(JSON.stringify(t))}}}),new r["default"]({store:qn,render:function(t){return t(An)}}).$mount("#app")},"5c0b":function(t,e,n){"use strict";var r=n("9c0c"),i=n.n(r);i.a},6192:function(t,e,n){t.exports=n.p+"img/edge_half_hover.a02e39f9.svg"},"7e33":function(t,e,n){t.exports=n.p+"img/edge_full_hover.0e25cee9.svg"},"9c0c":function(t,e,n){},b39e:function(t,e,n){t.exports=n.p+"img/edge_empty.3662e72a.svg"},c101:function(t,e,n){t.exports=n.p+"img/edge_half.10bb9dfa.svg"},e572:function(t,e,n){"use strict";var r=n("13c9"),i=n.n(r);i.a},eabb:function(t,e,n){t.exports=n.p+"img/edge_full.a70ba3da.svg"},ef9c:function(t,e,n){"use strict";var r=n("39d3"),i=n.n(r);i.a}});
//# sourceMappingURL=app.06b6840c.js.map