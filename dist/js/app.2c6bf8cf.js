(function(t){function e(e){for(var i,o,a=e[0],c=e[1],d=e[2],u=0,h=[];u<a.length;u++)o=a[u],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&h.push(r[o][0]),r[o]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(t[i]=c[i]);l&&l(e);while(h.length)h.shift()();return s.push.apply(s,d||[]),n()}function n(){for(var t,e=0;e<s.length;e++){for(var n=s[e],i=!0,a=1;a<n.length;a++){var c=n[a];0!==r[c]&&(i=!1)}i&&(s.splice(e--,1),t=o(o.s=n[0]))}return t}var i={},r={app:0},s=[];function o(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=i,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)o.d(n,i,function(e){return t[e]}.bind(null,i));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/Drawer/dist/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=e,a=a.slice();for(var d=0;d<a.length;d++)e(a[d]);var l=c;s.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"0a73":function(t,e,n){t.exports=n.p+"img/855.b825a08f.svg"},"13c9":function(t,e,n){},1948:function(t,e,n){var i={"./410.svg":"7637","./813.svg":"83bd","./851.svg":"8a10","./853.svg":"a4de","./855.svg":"0a73","./871.svg":"36bb"};function r(t){var e=s(t);return n(e)}function s(t){if(!n.o(i,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return i[t]}r.keys=function(){return Object.keys(i)},r.resolve=s,t.exports=r,r.id="1948"},"2e97":function(t,e,n){t.exports=n.p+"img/edge_empty_hover.8f8f3dc2.svg"},"36bb":function(t,e,n){t.exports=n.p+"img/871.4da8c959.svg"},"39d3":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var i=n("2b0e"),r=n("7591"),s=n.n(r),o=n("ecee"),a=n("c074"),c=n("ad3d"),d=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("drawer"),n("confirm-modal")],1)},l=[],u=(n("4989"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container mt-5"},[n("manage"),n("Canvas")],1)}),h=[],p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"text-left"},[n("add-part"),n("add-text",{staticClass:"ml-2"}),n("add-legend",{staticClass:"ml-2"})],1)},g=[],m=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"d-inline-block w-auto"},[n("input",{directives:[{name:"model",rawName:"v-model.number",value:t.width,expression:"width",modifiers:{number:!0}}],attrs:{type:"text"},domProps:{value:t.width},on:{input:function(e){e.target.composing||(t.width=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}}),t._v(" X "),n("input",{directives:[{name:"model",rawName:"v-model.number",value:t.height,expression:"height",modifiers:{number:!0}}],attrs:{type:"text"},domProps:{value:t.height},on:{input:function(e){e.target.composing||(t.height=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}}),n("button",{staticClass:"btn btn-secondary ml-2",attrs:{type:"button"},on:{click:t.add}},[t._v(" Элемент ")])])},f=[],x=(n("d81d"),{computed:{id:function(){return this.$store.state.id}},methods:{getId:function(){this.$store.commit("incrementId");var t=this.id;return t}}}),v={mixins:[x],data:function(){return{els:[],width:1e3,height:2e3}},computed:{pxPerMm:function(){return this.$store.state.pxPerMm},canvasWidthInMm:function(){return this.$store.state.canvasWidthInMm},canvasHeightInMm:function(){return this.$store.state.canvasHeightInMm}},methods:{add:function(){var t=this,e=this.width,n=this.height,i=[(this.canvasWidthInMm-e)/2,(this.canvasHeightInMm-n)/2],r={id:this.getId(),position:{x:0,y:0},type:"part",fill:null,insetsBulges:[],texts:[],singleSizeTags:[],washings:[],points:[{id:this.getId(),c:i,angleTag:{}},{id:this.getId(),c:[i[0]+e,i[1]],angleTag:{}},{id:this.getId(),c:[i[0]+e,i[1]+n],angleTag:{}},{id:this.getId(),c:[i[0],i[1]+n],angleTag:{}}]};r.borders=r.points.map((function(){return{id:t.getId(),type:"lineBorder",sizeTag:{isShown:!0},radiusPosition:"usual"}})),this.$store.dispatch("addPart",r),this.$store.commit("addLog")}}},I=v,b=n("2877"),y=Object(b["a"])(I,m,f,!1,null,null,null),M=y.exports,w=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"d-inline-block"},[n("button",{staticClass:"btn btn-secondary",attrs:{type:"button"},on:{click:t.addText}},[t._v(" Текст ")])])},P=[],$={mixins:[x],computed:{canvasHeightInMm:function(){return this.$store.state.canvasHeightInMm}},methods:{addText:function(){this.$store.dispatch("addTextBlock",{id:this.getId(),x:100,y:this.canvasHeightInMm/2,type:"totalText",fontSizeK:1,text:""})}}},C=$,E=Object(b["a"])(C,w,P,!1,null,null,null),T=E.exports,j=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"d-inline-block w-auto"},[n("button",{staticClass:"btn btn-secondary ml-2",attrs:{type:"button"},on:{click:t.openModal}},[t._v(" Легенда ")]),n("div",{ref:"modal",staticClass:"modal",attrs:{tabindex:"-1",role:"dialog","aria-hidden":"true"}},[n("div",{staticClass:"modal-dialog modal-dialog-centered modal-lg"},[n("div",{staticClass:"modal-content"},[t._m(0),n("div",{staticClass:"modal-body"},[n("div",{staticClass:"row justify-content-center"},t._l(t.elements,(function(e){return n("div",{key:e.subType,staticClass:"col-3 border border-dark rounded m-2 p-2",staticStyle:{cursor:"pointer"},on:{click:function(n){return t.addLegend(e)}}},[0==e.subType.indexOf("edge")?n("div",{staticClass:"text-center"},[n("img",{staticStyle:{width:"3rem"},attrs:{src:e.img,alt:"кромка"}})]):"skirting"===e.subType?n("div",{staticClass:"text-center"},[t._m(1,!0)]):n("div",{staticClass:"text-center"},[n("div",{staticClass:"inline-block border border-dark rounded m-auto",staticStyle:{width:"3rem",height:"3rem",background:"contain repeat"},style:{backgroundImage:e.bg?"url('"+e.bg+"')":null,backgroundColor:"color"===e.subType?"rgb(200,200,200)":null}})]),n("div",{staticClass:"text-center"},[t._v(t._s(e.title))])])})),0)]),t._m(2)])])])])},S=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"modal-header"},[n("h5",{staticClass:"modal-title",attrs:{id:"exampleModalLabel"}},[t._v("Выберите элемент")]),n("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[n("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"inline-block m-auto",staticStyle:{width:"3rem",height:"3rem"}},[n("div",{staticClass:"bg-dark m-auto position-relative",staticStyle:{height:"0.3rem",top:"50%"}})])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"modal-footer"},[n("button",{staticClass:"btn btn-secondary",attrs:{type:"button","data-dismiss":"modal"}},[t._v("Отмена")]),n("button",{staticClass:"btn btn-primary",attrs:{type:"button"}},[t._v("Выбрать")])])}],k=(n("99af"),n("5530")),B=n("2909"),_=n("1157"),O=n.n(_),z=n("b39e"),L=n.n(z),D=n("c101"),A=n.n(D),R=n("eabb"),F=n.n(R),W=function(t){var e,n=t.type,i=t.color,r=t.size||10,s="rotate(90 ".concat(r/2," ").concat(r/2,")");switch(n){case"dots":e="\n        <svg xmlns='http://www.w3.org/2000/svg' width='".concat(r,"' height='").concat(r,'\'>\n          <style>svg { background-color: white; }</style>\n          <circle cx="1" cy="1" r="1" fill="').concat(i,'"/>\n        </svg>\n      ');break;case"verticalLines":e="\n        <svg xmlns='http://www.w3.org/2000/svg' width='".concat(r/2,"' height='").concat(r,"'>\n          <style>svg { background-color: white; }</style>\n          <rect x='0' y='0' width='1' height='").concat(r,"' fill='").concat(i,"' />\n        </svg>\n      ");break;case"horizontalLines":e="\n        <svg xmlns='http://www.w3.org/2000/svg' width='".concat(r,"' height='").concat(r/2,"'>\n          <style>svg { background-color: white; }</style>\n          <rect x='0' y='0' width='").concat(r,"' height='1' fill='").concat(i,"' />\n        </svg>\n      ");break;case"rightDiagonalLines":e="\n        <svg xmlns='http://www.w3.org/2000/svg' width='".concat(r,"' height='").concat(r,"'>\n          <style>svg { background-color: white; }</style>\n          <path d='M-1,1 l2,-2 M0,10 l10,-10 M9,11 l2,-2' stroke='").concat(i,"' stroke-width='1'/>\n        </svg>\n      ");break;case"leftDiagonalLines":e="\n        <svg xmlns='http://www.w3.org/2000/svg' width='".concat(r,"' height='").concat(r,"'>\n          <style>svg { background-color: white; }</style>\n          <path d='M-1,1 l2,-2 M0,10 l10,-10 M9,11 l2,-2' stroke='").concat(i,"' stroke-width='1' transform=\"").concat(s,'"/>\n        </svg>\n      ');break;case"rightSmallDiagonalLines":e="\n        <svg xmlns='http://www.w3.org/2000/svg' width='5' height='5'>\n          <style>svg { background-color: white; }</style>\n          <path d='M0 5L5 0ZM6 4L4 6ZM-1 1L1 -1Z' stroke='".concat(i,"' stroke-width='1'/>\n        </svg>\n      ");break;case"rhombus":e="\n        <svg xmlns='http://www.w3.org/2000/svg' width='8' height='8'>\n          <style>svg { background-color: white; }</style>\n          <path d='M0 0L8 8ZM8 0L0 8Z' stroke-width='0.5' stroke='".concat(i,"'/>\n        </svg>\n      ");break;case"square":e="\n        <svg xmlns='http://www.w3.org/2000/svg' width='20' height='20'>\n          <style>svg { background-color: white; }</style>\n          <rect x='10' y='0' width='2' height='20' fill='".concat(i,"' />\n          <rect x='0' y='10' width='20' height='2' fill='").concat(i,"' />\n        </svg>\n      ");break;default:return null}var o=(new XMLSerializer).serializeToString(O()(e)[0]),a=new Image;return a.src="data:image/svg+xml;charset=utf-8,".concat(o),a},N={mixins:[x],data:function(){return{elements:[{subType:"edge_empty",title:"Кромка 1",img:L.a},{subType:"edge_half",title:"Кромка 2",img:A.a},{subType:"edge_full",title:"Кромка 3",img:F.a},{subType:"skirting",title:"Бортик"},{subType:"noBg",title:"Без фона"}].concat(Object(B["a"])(this.$store.state.fills.map((function(t){var e="color"===t.type?null:W({type:t.type,color:"rgb(200,200,200)"});return Object(k["a"])(Object(k["a"])({},t),{},{subType:t.type,bg:e?e.src:null})}))))}},computed:{pxPerMm:function(){return this.$store.state.pxPerMm},canvasWidthInMm:function(){return this.$store.state.canvasWidthInMm},canvasHeightInMm:function(){return this.$store.state.canvasHeightInMm}},methods:{openModal:function(){O()(this.$refs.modal).modal("show")},addLegend:function(t){O()(this.$refs.modal).modal("hide");var e=t.subType;this.$store.commit("addLegend",{id:this.getId(),type:"legend",subType:e,text:"Описание",x:.4*this.canvasWidthInMm,y:.8*this.canvasHeightInMm,sizeK:1.6}),this.$store.commit("addLog")}}},K=N,q=Object(b["a"])(K,j,S,!1,null,null,null),H=q.exports,J={components:{AddPart:M,AddText:T,AddLegend:H}},U=J,Z=Object(b["a"])(U,p,g,!1,null,null,null),X=Z.exports,Y=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.isMounted?[n("konva")]:t._e()],2)},G=[],Q=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"position-relative",staticStyle:{"margin-bottom":"300px"}},[n("div",{ref:"nocontext"},[n("context-menu"),n("v-stage",{ref:"stage",attrs:{config:{width:t.canvasWidthInPx,height:500,type:"stage"}}},[n("v-layer",[n("v-rect",{attrs:{config:{x:0,y:0,width:t.canvasWidthInPx,height:500,fill:"white",type:"bgRect",fillPatternImage:t.bgPattern,fillPriority:"pattern",fillPatternScale:{x:.35,y:.35}}},on:{click:t.deselect}}),t._l(t.parts,(function(t,e){return n("part",{key:t.id,attrs:{partIndex:e,part:t}})})),t._l(t.totalTexts,(function(t,e){return n("total-text",{key:t.id,attrs:{textIndex:e,text:t}})})),t._l(t.legends,(function(t,e){return n("legends",{key:t.id,attrs:{legend:t,legendIndex:e}})}))],2)],1)],1),n("element-menu"),n("logs"),n("text-edit"),n("add-washing",{attrs:{trigger:t.addWashingTrigger}})],1)},V=[],tt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"menu",staticClass:"dropdown-menu",style:t.coords,attrs:{role:"menu"}},t._l(t.items,(function(e,i){return n("a",{key:i,staticClass:"dropdown-item",attrs:{href:"#"},on:{click:function(n){return n.preventDefault(),t.handleClick(e)}}},[t._v(" "+t._s(e.name)+" ")])})),0)},et=[],nt={computed:{contextMenuEvent:function(){return this.$store.state.contextMenuEvent},pxPerMm:function(){return this.$store.state.pxPerMm},coords:function(){var t={top:0,left:0};return this.contextMenuEvent&&(t.top="".concat(this.contextMenuEvent.e.evt.layerY,"px"),t.left="".concat(this.contextMenuEvent.e.evt.layerX,"px")),t},part:function(){return"partIndex"in this.contextMenuEvent?this.$store.state.parts.partsInit[this.contextMenuEvent.partIndex]:null},border:function(){return this.part&&"borderIndex"in this.contextMenuEvent?this.part.borders[this.contextMenuEvent.borderIndex]:null},point:function(){return this.part&&"pointIndex"in this.contextMenuEvent?this.part.points[this.contextMenuEvent.pointIndex]:null},items:function(){if(!this.contextMenuEvent)return[];var t=[],e=this.contextMenuEvent.e.target.attrs,n=this.contextMenuEvent,i=n.partIndex,r=n.borderIndex;switch(e.type){case"part":return[{name:"Удалить элемент",action:"deletePart",partIndex:i},{name:"Добавить размер",action:"addSingleSizeTag",partIndex:i},{name:"Добавить мойку",action:"addWashing",partIndex:i,left:this.contextMenuEvent.e.evt.layerX/this.pxPerMm,top:this.contextMenuEvent.e.evt.layerY/this.pxPerMm}];case"lineBorder":return e.isClickable&&t.push.apply(t,[{name:"Вставить точку",action:"addPoint",borderIndex:r},{name:"Сделать выпуклой",isInside:!1,action:"makeBorderCurve",borderIndex:r},{name:"Сделать вогнутой",isInside:!0,action:"makeBorderCurve",borderIndex:r},{name:"Сделать вырез",isInside:!0,action:"makeBulgeInset",borderIndex:r},{name:"Сделать выступ",isInside:!1,action:"makeBulgeInset",borderIndex:r}]),t.push({name:"Добавить/убрать бортик",action:"toggleSkirting",borderIndex:r}),!this.border.sizeTag.isShown&&e.isHoverable&&t.push({name:"Показать размер",action:"showSizeArrow",borderIndex:r}),!this.border||this.border.edgeTag&&this.border.edgeTag.isShown||t.push({name:"Добавить кромку",action:"addEdge",borderIndex:r}),t;case"curveBorder":return t.push({name:"Сделать прямой",action:"makeBorderLine",borderIndex:r},{name:"Добавить/убрать бортик",action:"toggleSkirting",borderIndex:r}),e.isInside?t.push({name:"Сделать выпуклой",isInside:!1,action:"makeBorderCurve",borderIndex:r}):t.push({name:"Сделать вогнутой",isInside:!0,action:"makeBorderCurve",borderIndex:r}),this.border.radiusTag.isShown||t.push({name:"Показать радиус",action:"showRadius",borderIndex:r}),this.border&&this.border.edgeTag&&!this.border.edgeTag.isShown&&t.push({name:"Добавить кромку",action:"addEdge",borderIndex:r}),t;case"point":var s=this.contextMenuEvent.pointIndex,o=s>0?s-1:this.part.points.length-1,a=this.part.borders[o],c=this.part.borders[s];return"lineBorder"===a.type&&"lineBorder"===c.type&&("insetBulgeId"in this.point||t.push.apply(t,[{name:"Удалить точку",action:"deletePoint",pointIndex:this.contextMenuEvent.pointIndex},{name:"Сделать вырез",action:"makeCorderCut",pointIndex:this.contextMenuEvent.pointIndex}]),t.push({name:"Закруглить угол",action:"makeRounded",pointIndex:this.contextMenuEvent.pointIndex}),this.point.angleTag.isShown||t.push({name:"Показать угол",action:"showAngle",pointIndex:this.contextMenuEvent.pointIndex})),t;case"inset":case"bulge":return[{name:"Удалить выступ/вырез",action:"deleteInsetBulge",insetBulgeIndex:this.contextMenuEvent.insetBulgeIndex}];case"sizeArrow":return[{name:"Скрыть",action:"hideSizeArrow",borderIndex:r}];case"radius":return[{name:"Скрыть",action:"hide",borderIndex:r}];case"angleTag":return[{name:"Скрыть",action:"hideAngle",pointIndex:this.contextMenuEvent.pointIndex}];case"edge":return[{name:"Скрыть",action:"hideEdge",borderIndex:r}];case"totalText":return[{name:"Удалить текст",action:"deleteTotalText",textIndex:this.contextMenuEvent.textIndex}];case"singleSizeTag":return[{name:"Удалить размер",action:"deleteSingleSizeTag",sizeTagIndex:this.contextMenuEvent.sizeTagIndex}];case"legend":return[{name:"Удалить элемент легенды",action:"deleteLegend",legendIndex:this.contextMenuEvent.legendIndex}];case"washing":return[{name:"Удалить мойку",action:"deleteWashing",washingIndex:this.contextMenuEvent.washingIndex}];default:return[]}}},watch:{contextMenuEvent:function(){this.console.log("ctxtmenu"),O()(this.$refs.menu).dropdown("show")}},mounted:function(){var t=this;O()("body").click((function(){O()(t.$refs.menu).dropdown("hide")}))},methods:{handleClick:function(t){var e=this,n=Object(k["a"])(Object(k["a"])({},t),{},{partIndex:this.contextMenuEvent.partIndex});this.$store.commit("setContextMenuEvent",null),this.$store.commit("setContextMenuAction",n),setTimeout((function(){O()(e.$refs.menu).dropdown("hide")}),0)}}},it=nt,rt=Object(b["a"])(it,tt,et,!1,null,null,null),st=rt.exports,ot=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-group",{attrs:{config:t.groupConfig},on:{dragend:t.log}},[n("v-shape",{ref:"shape",attrs:{config:Object.assign({},t.partShapeConfig,{fill:t.fill.color,fillPatternImage:t.fill.image,fillPriority:"pattern"})},on:{mouseover:function(e){return t.$store.commit("setCurrentEl",t.part.id)},mouseleave:function(e){return t.$store.commit("setCurrentEl",null)},click:function(e){return t.$store.commit("setSelectedElId",t.part.id)},contextmenu:t.setContextMenuEvent}}),t._l(t.part.insetsBulges,(function(e,i){return n("inset-bulge",{key:e.id,attrs:{partIndex:t.partIndex,iBIndex:i}})})),n("borders",{attrs:{part:t.part,partIndex:t.partIndex,curves:t.curves}}),t._l(t.points,(function(e,i){return n("p-point",{key:e.id,attrs:{pointIndex:i,partIndex:t.partIndex}})})),t._l(t.part.singleSizeTags,(function(e,i){return n("single-size-tag",{key:e.id,attrs:{partIndex:t.partIndex,sizeTagIndex:i}})})),t._l(t.part.washings,(function(e,i){return n("washing",{key:e.id,attrs:{partIndex:t.partIndex,washingIndex:i}})}))],2)],1)},at=[],ct=(n("cb29"),n("4de4"),n("4160"),n("45fc"),n("159b"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t._l(t.borders.lineBorder,(function(e){return n("line-border",{key:e.id,attrs:{borderIndex:e.allBordersIndex,partIndex:t.partIndex}})})),t._l(t.borders.curveBorder,(function(e){return n("curve-border",{key:e.id,attrs:{borderIndex:e.allBordersIndex,partIndex:t.partIndex,curves:t.curves}})}))],2)}),dt=[],lt=(n("a9e3"),n("9129"),n("96cf"),n("1da1")),ut=n("1266"),ht=n.n(ut),pt=n("854a"),gt=n.n(pt),mt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-line",{ref:"border",attrs:{config:Object.assign({},t.config,{stroke:t.stroke})},on:{dragstart:function(e){return t.startBorderDrag(e,t.border)},dragend:t.dragend,contextmenu:function(e){return t.setContextMenuEvent(e,t.borderIndex)},mouseover:function(e){return t.changeMouseOver(!0,t.border.id)},mouseleave:function(e){return t.changeMouseOver(!1)},click:function(e){t.config.isClickable&&t.$store.commit("setSelectedElId",t.border.id)}}}),t.border.sizeTag&&t.border.sizeTag.isShown?n("size-arrow-tag",{attrs:{border:t.border,borderConfig:t.config,partIndex:t.partIndex,part:t.part}}):t._e(),t.border.edgeTag&&t.border.edgeTag.isShown?n("edge-tag",{attrs:{border:t.border,borderConfig:t.config,partIndex:t.partIndex,part:t.part}}):t._e()],1)},ft=[],xt=(n("7db0"),n("c740"),n("caad"),n("2532"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.sizeTag.isShown?n("v-group",{ref:"group"},[n("v-arrow",{attrs:{config:{points:t.params.arrowPoints,stroke:"black",fill:"black",pointerAtBeginning:!0,strokeWidth:1,pointerLength:t.arrowLength,pointerWidth:3,dash:t.dash}}}),n("v-label",{attrs:{config:Object.assign({},t.params.textPosition,{rotation:t.params.angle,offset:t.params.offset,draggable:!0,dragBoundFunc:t.params.dragBoundFunc})},on:{mouseover:function(e){t.over=!0},mouseleave:function(e){t.over=!1},contextmenu:t.setContextMenuEvent,dragstart:t.dragstart,dragend:t.dragend}},[n("v-tag",{attrs:{config:{fill:"white"}}}),n("v-text",{attrs:{config:{text:t.params.lengthText,padding:t.params.padding,fontSize:t.fontSize,fontFamily:"Calibri",fill:t.over?t.selectedColor:"black",type:"sizeArrow"}}})],1)],1):t._e()}),vt=[],It=(n("d3b7"),n("25f0"),{props:["border","partIndex","part","borderConfig"],data:function(){return{over:!1,isCtrlKey:!1,arrowLength:3}},computed:{sizeTag:function(){return this.border.sizeTag},isControlPressed:function(){return this.$store.state.isControlPressed},offsetInMm:function(){var t=this.sizeTag;return"distance"in t?t.distance:this.border.skirting?70:50},pxPerMm:function(){return this.$store.state.pxPerMm},fontSize:function(){return this.$store.state.fontSizeInmM.sizeArrow*this.pxPerMm},borderPoints:function(){return this.borderConfig.points},params:function(){this.console.log("sizeTag",this.border.id);var t=this.borderPoints,e=this.sizeTag.isInside?-1:1,n=new ht.a(t[0],t[1]),i=new ht.a(t[2]-t[0],t[3]-t[1]),r=i.angleDeg();r=r<0?r+360:r;var s=this.fontSize/2,o=i.length(),a=Math.round(o/this.pxPerMm).toString();o-=2*this.arrowLength;var c={x:s*a.length,y:s},d=.5*o+c.x/2,l=this.offsetInMm*this.pxPerMm;i=i.norm().multiply(new ht.a(this.arrowLength,this.arrowLength)),n=i.clone().add(n),i=i.norm().rotateDeg(-90*e).multiply(new ht.a(l,l)),n=i.clone().add(n);var u,h,p,g=n.toArray(),m=i.clone().norm().rotateDeg(90*e).multiply(new ht.a(d,d)),f=m.add(n).toObject(),x=this.sizeTag.correctPosition;x?(h=x.x*this.pxPerMm,p=x.y*this.pxPerMm,u={x:f.x+h,y:f.y+p},g[0]+=h,g[1]+=p):u=f,i=i.norm().rotateDeg(90*e).multiply(new ht.a(o,o)),n=i.clone().add(n);var v=n.toArray();x&&(v[0]+=h,v[1]+=p);var I=this;return{arrowPoints:[].concat(Object(B["a"])(g),Object(B["a"])(v)),originalTextPosition:f,textPosition:u,lengthText:a,padding:0,angle:r,offset:c,dragBoundFunc:function(t){return I.dragTag(t),this.absolutePosition()}}},partPosition:function(){return this.part.position},contextMenuAction:function(){return this.$store.state.contextMenuAction},dash:function(){return this.$store.state.dash},selectedColor:function(){return this.$store.state.selectedColor}},watch:{contextMenuAction:function(t){t.partIndex===this.partIndex&&t.borderIndex===this.borderConfig.allBordersIndex&&"hideSizeArrow"===t.action&&(this.$store.commit("setSizeTagParams",{i:t.partIndex,j:t.borderIndex}),this.$store.commit("addLog"))},over:function(t){t?this.$store.commit("setCursor","move"):this.$store.commit("resetCursor")}},methods:{setContextMenuEvent:function(t){var e=this.partIndex;this.$store.commit("setContextMenuEvent",{e:t,partIndex:e,borderIndex:this.borderConfig.allBordersIndex})},dragTag:function(t){this.isCtrlKey?this.dragTagFree(t):this.dragTagStrict(t)},dragTagStrict:function(t){var e=this.borderConfig.points,n=t.x-this.partPosition.x,i=t.y-this.partPosition.y,r=new ht.a(e[2]-e[0],e[3]-e[1]),s=new ht.a(n-e[0],i-e[1]),o=r.angleDeg();o=o;var a=s.angleDeg()-o;a<-180?a+=360:a>180&&(a-=360);var c=r.dot(s)/(r.length()*s.length()),d=Math.acos(c),l=Math.sin(d),u=l*s.length()/this.pxPerMm;this.$store.commit("setSizeTagParams",{i:this.partIndex,j:this.borderConfig.allBordersIndex,distance:u,isInside:a>0,isShown:!0})},dragTagFree:function(t){var e=t.x-this.partPosition.x,n=t.y-this.partPosition.y,i=this.params.originalTextPosition,r=i.x,s=i.y;this.$store.commit("setSizeTagParams",{i:this.partIndex,j:this.borderConfig.allBordersIndex,correctPosition:{x:(e-r)/this.pxPerMm,y:(n-s)/this.pxPerMm},isShown:!0})},dragstart:function(t){this.isCtrlKey=t.evt.ctrlKey},dragend:function(){this.$refs.group.getNode().clearCache(),this.$store.commit("addLog")}}}),bt=It,yt=Object(b["a"])(bt,xt,vt,!1,null,null,null),Mt=yt.exports,wt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.edge.isShown&&t.image?n("v-image",{ref:"image",attrs:{config:{image:t.image,x:t.params.x,y:t.params.y,width:t.sizeInPx,height:t.sizeInPx,rotation:t.params.angle,offset:{x:t.imageOffset,y:t.imageOffset},type:"edge",draggable:!0,dragBoundFunc:t.params.dragBoundFunc}},on:{mouseover:function(e){t.over=!0},mouseleave:function(e){t.over=!1},contextmenu:t.setContextMenuEvent,click:function(e){return t.$store.commit("setSelectedElId",t.edge.id)},dragend:t.dragend}}):t._e()},Pt=[],$t={mixins:[x],props:["border","partIndex","part","borderConfig"],data:function(){return{offsetInMm:50,over:!1,sizeInMm:120}},computed:{selectedElId:function(){return this.$store.state.selectedElId},currentElId:function(){return this.$store.state.currentElId},edge:function(){return this.border.edgeTag},image:function(){var t=[this.selectedElId,this.currentElId].includes(this.edge.id)?this.$store.state.files.edges["".concat(this.edge.edgeType,"Hover")]:this.$store.state.files.edges[this.edge.edgeType];return t},pxPerMm:function(){return this.$store.state.pxPerMm},sizeInPx:function(){return this.sizeInMm*this.pxPerMm},imageOffset:function(){return this.sizeInPx/2},params:function(){if(this.console.log("edgeTag",this.border.id),!this.edge.isShown)return{};var t=this.borderConfig.points,e=this,n=this.border.edgeTag.correctDistance||0;if("lineBorder"===this.border.type){var i=new ht.a(t[0],t[1]),r=new ht.a(t[2]-t[0],t[3]-t[1]),s=r.length()/2,o=s+n*this.pxPerMm,a=r.angleDeg();a=a<0?a+180:a-180,r=r.norm().multiply(new ht.a(o,o)),i=r.clone().add(i);var c=this.offsetInMm*this.pxPerMm;r=r.norm().rotateDeg(-90).multiply(new ht.a(c,c));var d=r.clone().add(i).toObject(),l=d.x,u=d.y;return{angle:a,x:l,y:u,originalDistance:s/this.pxPerMm,dragBoundFunc:function(t){return e.dragTag(t,"line"),this.absolutePosition()}}}var h=this.borderConfig,p=h.x,g=h.y,m=this.border.edgeTag.correctAngle||0,f=new ht.a(t[0],t[1]),x=new ht.a(t[2]-t[0],t[3]-t[1]),v=x.angleDeg();v=v<0?v+180:v-180,v+=m;var I=x.length()/2;x=x.norm().multiply(new ht.a(I,I));var b=x.clone().add(f);f=new ht.a(p,g),x=new ht.a(b.x-p,b.y-g);var y=x.angleDeg(),M=this.border.isInside?1:-1,w=this.borderConfig.innerRadius-this.offsetInMm*this.pxPerMm*M,P=w+n*this.pxPerMm;x=x.norm().rotateDeg(m).multiply(new ht.a(P,P));var $=x.clone().add(f).toObject();return Object(k["a"])(Object(k["a"])({},$),{},{centerAngle:y,originalDistance:w/this.pxPerMm,angle:v,dragBoundFunc:function(t){return e.dragTag(t,"curve"),this.absolutePosition()}})},partPosition:function(){return this.part.position},contextMenuAction:function(){return this.$store.state.contextMenuAction}},watch:{contextMenuAction:function(t){if(t.partIndex===this.partIndex&&t.borderIndex===this.borderConfig.allBordersIndex&&"hideEdge"===t.action){var e={i:t.partIndex,j:t.borderIndex,isShown:!1};this.$store.commit("setEdgeTagParams",e),this.$store.commit("addLog")}},"params.originalDistance":function(t){var e=this.border.edgeTag.correctDistance||0,n=t+e,i=this.imageOffset/this.pxPerMm;if(n<i)this.$store.commit("setEdgeTagParams",{i:this.partIndex,j:this.borderConfig.allBordersIndex,correctDistance:i-t});else{var r=2*t-i;n>r&&this.$store.commit("setEdgeTagParams",{i:this.partIndex,j:this.borderConfig.allBordersIndex,correctDistance:r-t})}},over:function(t){t?(this.$store.commit("setCurrentEl",this.edge.id),this.$store.commit("setCursor","move")):(this.$store.commit("setCurrentEl",null),this.$store.commit("resetCursor"))}},methods:{setContextMenuEvent:function(t){var e=this.partIndex;this.$store.commit("setContextMenuEvent",{e:t,partIndex:e,borderIndex:this.borderConfig.allBordersIndex})},dragTag:function(t,e){if("curve"===e){var n=this.borderConfig,i=n.x,r=n.y,s=t.x,o=t.y,a=this.partPosition.x,c=this.partPosition.y,d=new ht.a(s-(i+a),o-(r+c)),l=d.angleDeg(),u=l-this.params.centerAngle;this.$store.commit("setEdgeTagParams",{i:this.partIndex,j:this.borderConfig.allBordersIndex,correctAngle:u})}else if("line"===e){var h,p=t.x-this.partPosition.x,g=t.y-this.partPosition.y,m=this.borderConfig.points,f=new ht.a(m[2]-m[0],m[3]-m[1]),x=new ht.a(p-m[0],g-m[1]),v=f.dot(x)/(f.length()*x.length()),I=Math.acos(v),b=v*x.length();h=I>Math.PI/2?-this.params.originalDistance+this.imageOffset/this.sizeInPx:b>f.length()?this.params.originalDistance-this.imageOffset/this.sizeInPx:b/this.pxPerMm-this.params.originalDistance,this.$store.commit("setEdgeTagParams",{i:this.partIndex,j:this.borderConfig.allBordersIndex,correctDistance:h})}},dragend:function(){this.$refs.image.getNode().clearCache(),this.$store.commit("addLog")}}},Ct=$t,Et=Object(b["a"])(Ct,wt,Pt,!1,null,null,null),Tt=Et.exports,jt={props:["partIndex","borderIndex"],components:{SizeArrowTag:Mt,EdgeTag:Tt},data:function(){return{borderStartPoint:[0,0],isCtrlKey:!1,dependentInsetDepth:null}},computed:{selectedElId:function(){return this.$store.state.selectedElId},currentElId:function(){return this.$store.state.currentElId},pxPerMm:function(){return this.$store.state.pxPerMm},part:function(){return this.$store.state.parts.partsInit[this.partIndex]},border:function(){return this.part.borders[this.borderIndex]},partPosition:function(){return this.part.position},selectedColor:function(){return this.$store.state.selectedColor},lineCap:function(){var t=this.borderIndex?this.part.borders[this.borderIndex-1]:this.part.borders[this.part.borders.length-1],e=this.borderIndex<this.part.borders.length-1?this.part.borders[this.borderIndex+1]:this.part.borders[0];return t.skirting&&e.skirting?"square":"butt"},points:function(){var t=this,e=this.$store.state.parts.partsInit[this.partIndex].points.find((function(e){return e.id===t.border.pointsId[0]})).c,n=this.$store.state.parts.partsInit[this.partIndex].points.find((function(e){return e.id===t.border.pointsId[1]})).c;return[].concat(Object(B["a"])(e),Object(B["a"])(n))},isSizeTagShown:function(){return this.border.sizeTag.isShown},stroke:function(){return[this.currentElId,this.selectedElId].includes(this.border.id)||this.selectedElId===this.part.id?this.selectedColor:"black"},config:function(){var t=this;this.console.log("lineBorder",this.border.id);var e=this.border,n=e.type,i=e.id,r=this.border,s=r.skirting,o=r.subType,a=this;return{type:n,id:i,points:this.points.map((function(e){return e*t.pxPerMm})),strokeWidth:s?4:1,lineCap:this.lineCap,hitStrokeWidth:5,allBordersIndex:this.borderIndex,isClickable:!["inset","bulge"].includes(o),isHoverable:!0,draggable:!0,dragBoundFunc:function(t){return a.dragBorder(t),this.absolutePosition()}}}},watch:{},methods:{setContextMenuEvent:function(t,e){var n=this.partIndex;this.$store.commit("setContextMenuEvent",{e:t,partIndex:n,borderIndex:e})},dragBorder:function(t){var e=this.border,n=this.points,i=this.borderStartPoint,r=(t.x-this.partPosition.x)/this.pxPerMm+i[0],s=(t.y-this.partPosition.y)/this.pxPerMm+i[1],o=new ht.a(n[2]-n[0],n[3]-n[1]),a=o.length(),c=new ht.a(r-i[0],s-i[1]),d=o.angleDeg();d=d;var l=c.angleDeg()-d;l<-180?l+=360:l>180&&(l-=360);var u=o.dot(c)/(o.length()*c.length()),h=Math.acos(u),p=Math.sin(h),g=p*c.length();if(this.isCtrlKey||(g=10*Math.round(g/10)),g){var m=new ht.a(i[0],i[1]),f=l>0?1:-1;o=o.norm().rotateDeg(90*f).multiply(new ht.a(g,g));var x=o.clone().add(m).toObject();o=o.norm().rotateDeg(-90*f).multiply(new ht.a(a,a));var v=o.clone().add(new ht.a(x.x,x.y)).toObject();this.checkSiblingLines(x,v)&&(this.$store.commit("changePoint",{i:this.partIndex,j:e.pointsIndexes[0],point:x}),this.$store.commit("changePoint",{i:this.partIndex,j:e.pointsIndexes[1],point:v}),this.dependentInsetDepth&&this.setInsetBulgeDepth(x,d))}},checkSiblingLines:function(t,e){var n=this.borderIndex?this.part.borders[this.borderIndex-1]:this.part.borders[this.part.borders.length-1],i=this.borderIndex<this.part.borders.length-1?this.part.borders[this.borderIndex+1]:this.part.borders[0];if("curveBorder"===n.type){var r=this.part.points[n.pointsIndexes[0]].c,s=new ht.a(t.x-r[0],t.y-r[1]);if(s.length()>Math.ceil(2*n.radius))return!1}if("curveBorder"===i.type){var o=this.part.points[i.pointsIndexes[1]].c,a=new ht.a(o[0]-e.x,o[1]-e.y);if(a.length()>Math.ceil(2*i.radius))return!1}return!0},setInsetBulgeDepth:function(t,e){var n=this.part.points[this.dependentInsetDepth.insetBulge.pointsIndexes[0]].c,i=new ht.a(n[0]-t.x,n[1]-t.y),r=e-i.angleDeg(),s=i.length()*Math.sin(r*(Math.PI/180));this.$store.commit("setInsetBulgeDepth",{i:this.partIndex,j:this.dependentInsetDepth.index,depth:"inset"===this.dependentInsetDepth.insetBulge.type?s:-s})},startBorderDrag:function(t,e){this.isCtrlKey=t.evt.ctrlKey;var n=this.points;this.borderStartPoint=[n[0],n[1]];var i=-1;this.part.insetsBulges&&(i=this.part.insetsBulges.findIndex((function(t){var n=[t.pointsId[1],t.pointsId[2]];return n.includes(e.pointsId[0])&&n.includes(e.pointsId[1])}))),this.dependentInsetDepth=i<0?null:{index:i,insetBulge:this.clone(this.part.insetsBulges[i])}},dragend:function(){var t=this;this.$refs.border.getNode().clearCache(),setTimeout((function(){t.$store.commit("addLog")}),0)},changeMouseOver:function(t,e){var n=t?e:null,i=t?"setCursor":"resetCursor";this.$store.commit("setCurrentEl",n),this.$store.commit(i,"move")}}},St=jt,kt=Object(b["a"])(St,mt,ft,!1,null,null,null),Bt=kt.exports,_t=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-arc",{ref:"border",attrs:{config:Object.assign({},t.config,{stroke:t.stroke})},on:{contextmenu:function(e){return t.setContextMenuEvent(e,t.config.allBordersIndex)},mouseover:function(e){return t.$store.commit("setCurrentEl",t.border.id)},mouseleave:function(e){return t.$store.commit("setCurrentEl",null)},click:function(e){return t.$store.commit("setSelectedElId",t.border.id)}}}),t.border.edgeTag&&t.border.edgeTag.isShown?n("edge-tag",{attrs:{border:t.border,borderConfig:t.config,partIndex:t.partIndex,part:t.part}}):t._e(),t.border.radiusTag&&t.border.radiusTag.isShown?n("radius-tag",{attrs:{border:t.border,borderConfig:t.config,partIndex:t.partIndex,part:t.part}}):t._e()],1)},Ot=[],zt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.border.radiusTag.isShown?n("v-label",{ref:"label",attrs:{config:Object.assign({},t.params.textPosition,{rotation:t.params.angle,offset:t.params.offset,draggable:!0,dragBoundFunc:t.params.dragBoundFunc})},on:{mouseover:function(e){t.over=!0},mouseleave:function(e){t.over=!1},contextmenu:t.setContextMenuEvent,dragend:t.dragend}},[n("v-tag",{attrs:{config:{fill:"white"}}}),n("v-text",{attrs:{config:{text:t.params.radiusText,padding:t.params.padding,fontSize:t.fontSize,fontFamily:"Calibri",fill:t.over?t.selectedColor:"black",type:"radius"}}})],1):t._e()},Lt=[],Dt={props:["border","partIndex","part","borderConfig"],data:function(){return{over:!1,offsetInMm:100,correctAngle:0,correctDistance:0}},computed:{pxPerMm:function(){return this.$store.state.pxPerMm},fontSize:function(){return this.$store.state.fontSizeInmM.radius*this.pxPerMm},params:function(){this.console.log("radiusTag",this.border.id);var t=this.borderConfig,e=t.x,n=t.y,i=this.border.radiusTag.correctAngle||0,r=this.border.radiusTag.correctDistance||0,s=this.borderConfig.points,o=new ht.a(s[0],s[1]),a=new ht.a(s[2]-s[0],s[3]-s[1]),c=a.angleDeg();c=c<0?c+360:c;var d=c+i,l=a.length()/2;a=a.norm().multiply(new ht.a(l,l));var u=a.clone().add(o);o=new ht.a(e,n),a=new ht.a(u.x-e,u.y-n);var h=a.angleDeg(),p=this.border.isInside?1:-1,g=this.borderConfig.innerRadius-this.offsetInMm*this.pxPerMm*p,m=g+r*this.pxPerMm;a=a.norm().rotateDeg(i).multiply(new ht.a(m,m));var f=a.clone().add(o).toObject(),x=this.fontSize/2,v="R ".concat(Math.round(this.border.radius)),I={x:x*v.length/2,y:x},b=this;return{padding:0,textPosition:f,angle:d,centerAngle:h,originalDistance:g/this.pxPerMm,offset:I,radiusText:v,dragBoundFunc:function(t){return b.dragTag(t),this.absolutePosition()}}},contextMenuAction:function(){return this.$store.state.contextMenuAction},partPosition:function(){return this.part.position},selectedColor:function(){return this.$store.state.selectedColor}},watch:{contextMenuAction:function(t){t.partIndex===this.partIndex&&t.borderIndex===this.borderConfig.allBordersIndex&&"hide"===t.action&&(this.$store.commit("setRadiusTagParams",{i:t.partIndex,j:t.borderIndex}),this.$store.commit("addLog"))},over:function(t){t?this.$store.commit("setCursor","move"):this.$store.commit("resetCursor")}},methods:{setContextMenuEvent:function(t){var e=this.partIndex;this.$store.commit("setContextMenuEvent",{e:t,partIndex:e,borderIndex:this.borderConfig.allBordersIndex})},dragTag:function(t){var e=this.borderConfig,n=e.x,i=e.y,r=t.x,s=t.y,o=this.partPosition.x,a=this.partPosition.y,c=new ht.a(r-(n+o),s-(i+a)),d=c.angleDeg(),l=d-this.params.centerAngle,u=c.length()/this.pxPerMm-this.params.originalDistance;this.$store.commit("setRadiusTagParams",{i:this.partIndex,j:this.borderConfig.allBordersIndex,correctAngle:l,correctDistance:u,isShown:!0})},dragend:function(){this.$refs.label.getNode().clearCache(),this.$store.commit("addLog")}}},At=Dt,Rt=Object(b["a"])(At,zt,Lt,!1,null,null,null),Ft=Rt.exports,Wt={props:["partIndex","curves","borderIndex"],components:{EdgeTag:Tt,RadiusTag:Ft},computed:{selectedElId:function(){return this.$store.state.selectedElId},currentElId:function(){return this.$store.state.currentElId},pxPerMm:function(){return this.$store.state.pxPerMm},part:function(){return this.$store.state.parts.partsInit[this.partIndex]},border:function(){return this.part.borders[this.borderIndex]},partPosition:function(){return this.part.position},selectedColor:function(){return this.$store.state.selectedColor},points:function(){var t=this,e=this.$store.state.parts.partsInit[this.partIndex].points.find((function(e){return e.id===t.border.pointsId[0]})).c,n=this.$store.state.parts.partsInit[this.partIndex].points.find((function(e){return e.id===t.border.pointsId[1]})).c;return[].concat(Object(B["a"])(e),Object(B["a"])(n))},lineJoin:function(){var t=this.borderIndex?this.part.borders[this.borderIndex-1]:this.part.borders[this.part.borders.length-1],e=this.borderIndex<this.part.borders.length-1?this.part.borders[this.borderIndex+1]:this.part.borders[0];return t.skirting&&e.skirting?"round":"miter"},stroke:function(){return[this.currentElId,this.selectedElId].includes(this.border.id)||this.selectedElId===this.part.id?this.selectedColor:"black"},config:function(){var t=this;this.console.log("curveBorder",this.border.id);var e=this.border,n=e.type,i=e.id,r=e.isInside,s=this.border.skirting,o=Object(k["a"])({},this.curves[i]);return{type:n,id:i,points:this.points.map((function(e){return e*t.pxPerMm})),isInside:r,strokeWidth:s?4:1,lineJoin:this.lineJoin,hitStrokeWidth:5,allBordersIndex:this.borderIndex,innerRadius:o.R,outerRadius:o.R,x:o.c1.x,y:o.c1.y,angle:o.ang2*(180/Math.PI)-o.ang1*(180/Math.PI),rotation:o.ang1*(180/Math.PI),clockwise:o.isInside}}},methods:{setContextMenuEvent:function(t,e){var n=this.partIndex;this.$store.commit("setContextMenuEvent",{e:t,partIndex:n,borderIndex:e})}}},Nt=Wt,Kt=Object(b["a"])(Nt,_t,Ot,!1,null,null,null),qt=Kt.exports,Ht=function(t){return new Promise((function(e){var n=t.body,i=t.actions,r=t.input,s=t.title,o=O()("#confirm_modal");O()(o).find(".modal-body").text(n),O()(o).find(".modal-title").text(s);var a=i||[{action:"0",style:"secondary",text:"Нет"},{action:"1",style:"primary",text:"Да"}],c=a.map((function(t){var e=O()('<button class="btn" type="button"></button>');return O()(e).attr("data-action",t.action).addClass("btn-".concat(t.style)).text(t.text),e}));if(O()(o).find(".modal-footer").html(c),r){var d=O()('<input id="data" type="'.concat(r.type,'" placeholder="').concat(r.placeholder,'" />'));O()(d).addClass("form-control mt-3"),O()(o).find(".modal-body").append(d)}O()(o).modal("show").on("hide.bs.modal",(function(t){var n=O()(t.target).attr("data-result");if(r&&"1"===n){var i=O()(o).find("#data").val();e(i)}else e("1"===n);O()(o).off("hide.bs.modal")}))}))},Jt={mixins:[x],props:["part","partIndex","curves"],components:{LineBorder:Bt,CurveBorder:qt},computed:{selectedElId:function(){return this.$store.state.selectedElId},currentElId:function(){return this.$store.state.currentElId},pxPerMm:function(){return this.$store.state.pxPerMm},partPosition:function(){return this.part.position},borders:function(){var t={};return this.part.borders.forEach((function(e,n){e.type in t||(t[e.type]=[]),t[e.type].push(Object(k["a"])(Object(k["a"])({},e),{},{allBordersIndex:n}))})),t},contextMenuAction:function(){return this.$store.state.contextMenuAction},refreshSelectedElTrigger:function(){return this.$store.state.parts.refreshSelectedElTrigger},selectedColor:function(){return this.$store.state.selectedColor}},watch:{contextMenuAction:function(t){if(t.partIndex===this.partIndex)if("makeBorderCurve"===t.action)this.makeBorderCurve(t);else if("makeBorderLine"===t.action)this.$store.dispatch("makeBorderLine",t),this.$store.commit("addLog");else if("makeBulgeInset"===t.action)this.makeBulgeInset(t);else if("toggleSkirting"===t.action)this.$store.commit("toggleSkirting",{i:t.partIndex,j:t.borderIndex}),this.$store.commit("addLog");else if("showSizeArrow"===t.action)this.$store.commit("setSizeTagParams",{i:t.partIndex,j:t.borderIndex,isShown:!0}),this.$store.commit("addLog");else if("addEdge"===t.action){var e={i:t.partIndex,j:t.borderIndex,isShown:!0,id:this.getId()};this.$store.commit("setEdgeTagParams",e),this.$store.commit("addLog")}else"addPoint"===t.action?this.addPoint(t):"showRadius"===t.action&&(this.$store.commit("setRadiusTagParams",{i:t.partIndex,j:t.borderIndex,isShown:!0}),this.$store.commit("addLog"))},refreshSelectedElTrigger:function(){this.$refs["border".concat(this.selectedElId)][0].getNode().fire("click")}},methods:{setContextMenuEvent:function(t,e){var n=this.partIndex;this.$store.commit("setContextMenuEvent",{e:t,partIndex:n,borderIndex:e})},makeBorderCurve:function(t){var e=this;return Object(lt["a"])(regeneratorRuntime.mark((function n(){var i,r,s,o,a,c,d,l,u,h;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return i=e.part.points,r=e.part.borders[t.borderIndex],s=i[r.pointsIndexes[0]].c,o=i[r.pointsIndexes[1]].c,a=[].concat(Object(B["a"])(s),Object(B["a"])(o)),c=Math.sqrt(Math.pow(a[2]-a[0],2)+Math.pow(a[3]-a[1],2)),d={body:"Введите отступ ".concat(t.isInside?"вогнутой":"выпуклой"," от прямой"),title:"Сделать ".concat(t.isInside?"вогнутой":"выпуклой")},d=Object(k["a"])(Object(k["a"])({},d),{},{input:{type:"number",placeholder:"отступ в мм, максимум ".concat(Math.ceil(c/2))}}),d.actions=[{action:"0",style:"secondary",text:"Отмена"},{action:"1",style:"primary",text:"Применить"}],n.next=11,Ht(d);case 11:if(l=n.sent,l){n.next=14;break}return n.abrupt("return");case 14:if(u=parseInt(l,10),!(Number.isNaN(u)||!u||u>c/2)){n.next=18;break}return gt.a.warning("Отступ введен неверно"),n.abrupt("return");case 18:h=(Math.pow(c/2,2)+Math.pow(u,2))/(2*u),e.$store.dispatch("makeBorderCurve",Object.assign(t,{radius:h})),e.$store.commit("addLog");case 21:case"end":return n.stop()}}),n)})))()},makeBulgeInset:function(t){var e=this,n=this.part.points,i=this.part.borders[t.borderIndex],r=n[i.pointsIndexes[0]].c,s=n[i.pointsIndexes[1]].c,o=[].concat(Object(B["a"])(r),Object(B["a"])(s)),a=[],c=300,d=t.isInside?1:-1,l=new ht.a(o[0],o[1]),u=new ht.a(o[2]-o[0],o[3]-o[1]),h=u.length(),p=u.norm();u=p.multiply(new ht.a(h/3,h/3)),l=u.clone().add(l),a.push(l.toArray()),u=u.norm().rotateDeg(90*d).multiply(new ht.a(c,c)),l=u.clone().add(l),a.push(l.toArray()),u=u.norm().rotateDeg(-90*d).multiply(new ht.a(h/3,h/3)),l=u.clone().add(l),a.push(l.toArray()),u=u.norm().rotateDeg(-90*d).multiply(new ht.a(c,c)),l=u.clone().add(l),a.push(l.toArray());var g=t.partIndex,m=t.borderIndex,f=t.isInside?"inset":"bulge",x=[],v=this.getId();a.forEach((function(t,n){var r={id:e.getId(),type:"lineBorder"};n<3&&(i.subType=f);var s=e.getId(),o={id:s,c:t,subType:f};e.$store.dispatch("addPoint",{i:g,j:m+n+1,point:Object(k["a"])(Object(k["a"])({},o),{},{insetBulgeId:v}),border:r}),x.push(s)}));var I={partIndex:g,pointsId:x,id:v};this.$store.dispatch("addInsetBulge",Object(k["a"])(Object(k["a"])({},I),{},{type:f,depth:c})),this.$store.commit("setSelectedElId",v),this.$store.commit("addLog")},addPoint:function(t){var e=t.borderIndex,n=this.part.points[e].c,i=e<this.part.points.length-1?this.part.points[e+1].c:this.part.points[0].c,r=[n[0]+(i[0]-n[0])/2,n[1]+(i[1]-n[1])/2],s=t.partIndex;this.$store.dispatch("addPoint",{i:s,j:e+1,border:{id:this.getId(),type:"lineBorder"},point:{id:this.getId(),c:r,addedByUser:!0}}),this.$store.commit("addLog")}}},Ut=Jt,Zt=Object(b["a"])(Ut,ct,dt,!1,null,null,null),Xt=Zt.exports,Yt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-circle",{attrs:{config:{type:"point",x:t.point.c[0]*t.pxPerMm,y:t.point.c[1]*t.pxPerMm,radius:t.radius,fill:[t.currentElId,t.selectedElId].includes(t.point.id)?t.selectedColor:"transparent"}},on:{mouseover:function(e){return t.$store.commit("setCurrentEl",t.point.id)},mouseleave:function(e){return t.$store.commit("setCurrentEl",null)},dragmove:function(e){return t.movePoint(e,t.pointIndex)},click:function(e){return t.$store.commit("setSelectedElId",t.point.id)},contextmenu:function(e){return t.setContextMenuEvent(e,t.pointIndex)}}}),t.point.addedByUser?n("v-circle",{attrs:{config:{x:t.point.c[0]*t.pxPerMm,y:t.point.c[1]*t.pxPerMm,radius:2,fill:"black"}}}):t._e(),t.point.angleTag&&t.point.angleTag.isShown?n("angle-tag",{attrs:{partIndex:t.partIndex,point:t.point,pointIndex:t.pointIndex}}):t._e()],1)},Gt=[],Qt=(n("07ac"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.point.angleTag.isShown?n("div",[n("v-label",{ref:"angle",attrs:{config:Object.assign({},t.params.textPosition,{rotation:t.params.angle,offset:t.params.offset,draggable:!0,dragBoundFunc:t.params.dragBoundFunc})},on:{mouseover:function(e){t.over=!0},mouseleave:function(e){t.over=!1},contextmenu:t.setContextMenuEvent,dragend:t.dragend}},[n("v-tag",{attrs:{config:{fill:"transparent"}}}),n("v-text",{attrs:{config:{text:t.params.angleText,fontSize:t.fontSize,fontFamily:"Calibri",fill:t.over?t.selectedColor:"black",type:"angleTag"}}})],1),n("v-arc",{attrs:{config:{stroke:"black",strokeWidth:1,innerRadius:t.params.radius,outerRadius:t.params.radius,x:t.params.c1.x,y:t.params.c1.y,angle:t.params.ang2*(180/Math.PI)-t.params.ang1*(180/Math.PI),rotation:t.params.ang1*(180/Math.PI),clockwise:!0,dash:t.dash}}})],1):t._e()}),Vt=[],te={props:["point","partIndex","pointIndex"],data:function(){return{over:!1,offsetInMm:100}},computed:{pxPerMm:function(){return this.$store.state.pxPerMm},fontSize:function(){return this.$store.state.fontSizeInmM.radius*this.pxPerMm},part:function(){return this.$store.state.parts.partsInit[this.partIndex]},params:function(){var t=this;this.console.log("angleTag",this.point.id);var e=this.point.angleTag.distance||0,n=this.part,i=n.borders,r=n.points,s=i[this.point.bordersIndexes[0]],o=i[this.point.bordersIndexes[1]],a=[].concat(Object(B["a"])(r[s.pointsIndexes[0]].c),Object(B["a"])(this.point.c)).map((function(e){return e*t.pxPerMm})),c=new ht.a(a[2],a[3]),d=new ht.a(a[0]-a[2],a[1]-a[3]),l=this.offsetInMm*this.pxPerMm,u=d.clone().norm().multiply(new ht.a(l,l)),h=u.add(c);a=[].concat(Object(B["a"])(this.point.c),Object(B["a"])(r[o.pointsIndexes[1]].c)).map((function(e){return e*t.pxPerMm}));var p=new ht.a(a[2]-a[0],a[3]-a[1]);u=p.clone().norm().multiply(new ht.a(l,l));var g=u.add(c),m=g.clone().subtract(h).length()/2+2,f=p.angleDeg(),x=d.angleDeg()-f;x<0&&(x+=360);var v=x>=180;this.point.angleTag.isOutside&&(v=!v);var I=this.getCurve(h.toObject(),g.toObject(),m,v),b=I.ang1,y=I.ang2,M=I.c1,w="".concat(Math.round(x)," °");u=new ht.a(g.x-h.x,g.y-h.y);var P=u.length()/2;u=u.clone().norm().multiply(new ht.a(P,P)).add(h);var $=new ht.a(u.x-M.x,u.y-M.y),C=e?e*this.pxPerMm:m+1.2*l,E=$.angleDeg(),T=this.point.angleTag.correctAngle||0;v&&(T+=180);var j=$.clone().norm().rotateDeg(T).multiply(new ht.a(C,C)).add(new ht.a(M.x,M.y)).toObject(),S=this.fontSize/2,k={x:S*w.length/2,y:S},_=this;return{padding:0,textPosition:j,angle:0,offset:k,angleText:w,ang1:b,ang2:y,radius:m,c1:M,originalAngle:E,angleDeg:x,isOpposite:v,pts:a,dragBoundFunc:function(t){return _.dragTag(t),this.absolutePosition()}}},partPosition:function(){return this.part.position},contextMenuAction:function(){return this.$store.state.contextMenuAction},dash:function(){return this.$store.state.dash},selectedColor:function(){return this.$store.state.selectedColor}},watch:{contextMenuAction:function(t){t.partIndex===this.partIndex&&t.pointIndex===this.pointIndex&&"hideAngle"===t.action&&(this.$store.commit("setAngleTagParams",{i:t.partIndex,j:t.pointIndex,angleTag:{}}),this.$store.commit("addLog"))},over:function(t){t?this.$store.commit("setCursor","move"):this.$store.commit("resetCursor")}},methods:{setContextMenuEvent:function(t){var e=this.partIndex,n=this.pointIndex;this.$store.commit("setContextMenuEvent",{e:t,partIndex:e,pointIndex:n})},getCurve:function(t,e,n,i){var r={x:.5*(t.x+e.x),y:.5*(t.y+e.y)},s=i?-(t.y-e.y):-(e.y-t.y),o=i?t.x-e.x:e.x-t.x,a=Math.sqrt(Math.pow(s,2)+Math.pow(o,2));s/=a,o/=a;var c=Math.sqrt(Math.pow(r.x-t.x,2)+Math.pow(r.y-t.y,2)),d=c/n;if(d<-1||d>1)return{};var l=Math.sqrt(1-Math.pow(d,2)),u=n*l,h={x:r.x+s*u,y:r.y+o*u},p={x:r.x-s*u,y:r.y-o*u},g=Math.atan2(t.y-h.y,t.x-h.x),m=Math.atan2(e.y-h.y,e.x-h.x),f=Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)),x=(e.x-t.x)/f,v=Math.acos(x),I=t.x>e.x?t.y-e.y:e.y-t.y,b=I>0?-1:1;return{c1:p,p1:t,p2:e,R:n,ang1:Math.PI+2*Math.abs(1.57-v)*b-g,ang2:Math.PI+2*Math.abs(1.57-v)*b-m}},dragTag:function(t){var e=this.params.pts,n=t.x,i=t.y,r=this.partPosition.x,s=this.partPosition.y,o=new ht.a(n-(e[0]+r),i-(e[1]+s)),a=o.angleDeg(),c=a-this.params.originalAngle,d=o.length()/this.pxPerMm;this.$store.commit("setAngleTagParams",{i:this.partIndex,j:this.pointIndex,correctAngle:this.params.isOpposite?c+180:c,distance:d,isShown:!0,isOutside:this.point.angleTag.isOutside})},dragend:function(){this.$refs.angle.getNode().clearCache(),this.$store.commit("addLog")}}},ee=te,ne=Object(b["a"])(ee,Qt,Vt,!1,null,null,null),ie=ne.exports,re={mixins:[x],components:{AngleTag:ie},props:["partIndex","pointIndex"],computed:{selectedElId:function(){return this.$store.state.selectedElId},currentElId:function(){return this.$store.state.currentElId},contextMenuAction:function(){return this.$store.state.contextMenuAction},part:function(){return this.$store.state.parts.partsInit[this.partIndex]},point:function(){return this.part.points[this.pointIndex]},pxPerMm:function(){return this.$store.state.pxPerMm},radius:function(){return 60*this.pxPerMm},selectedColor:function(){return this.$store.state.selectedColor}},watch:{contextMenuAction:function(t){t.partIndex===this.partIndex&&t.pointIndex===this.pointIndex&&("deletePoint"===t.action?this.deletePoint(t):"makeCorderCut"===t.action?this.makeCorderCut(t):"makeRounded"===t.action?this.makeRounded(t):"showAngle"===t.action&&this.showAngle(t))}},methods:{setContextMenuEvent:function(t,e){var n=this.partIndex;this.$store.commit("setContextMenuEvent",{e:t,partIndex:n,pointIndex:e})},movePoint:function(t,e){var n=this,i=this.partIndex,r=Object.values(t.target.position()).map((function(t){return t/n.pxPerMm}));this.$store.commit("movePoint",{pointIndex:e,partIndex:i,c:r})},deletePoint:function(t){var e=t.partIndex,n=t.pointIndex;this.$store.dispatch("deletePoint",{i:e,j:n}),this.$store.commit("addLog")},makeCorderCut:function(t){var e=this,n=t.pointIndex,i=t.partIndex,r=this.part.points,s=n?r[n-1]:r[this.points.length-1],o=[],a=300,c=new ht.a(this.point.c[0],this.point.c[1]),d=new ht.a(s.c[0]-this.point.c[0],s.c[1]-this.point.c[1]);d=d.norm().multiply(new ht.a(a,a)),c=d.clone().add(c),o.push(c.toObject()),d=d.norm().rotateDeg(-90).multiply(new ht.a(a,a)),c=d.clone().add(c),o.push(c.toArray()),d=d.norm().rotateDeg(-90).multiply(new ht.a(a,a)),c=d.clone().add(c),o.push(c.toArray()),o.forEach((function(t,r){if(r){var s={id:e.getId(),type:"lineBorder"},o=e.getId();e.$store.dispatch("addPoint",{i:i,j:n+r,border:s,point:{id:o,c:t}})}else{var a={i:i,j:n,point:t};e.$store.dispatch("changePoint",a)}})),this.$store.commit("addLog")},makeRounded:function(t){var e=this;return Object(lt["a"])(regeneratorRuntime.mark((function n(){var i,r,s,o,a,c,d,l,u,h,p,g,m,f,x,v,I,b;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return i={body:"Введите радиус",title:"Закруглить угол"},i=Object(k["a"])(Object(k["a"])({},i),{},{input:{type:"number",placeholder:"радиус в мм"}}),i.actions=[{action:"0",style:"secondary",text:"Отмена"},{action:"1",style:"primary",text:"Применить"}],n.next=5,Ht(i);case 5:if(r=n.sent,r){n.next=8;break}return n.abrupt("return");case 8:s=parseInt(r,10),Number.isNaN(s)&&gt.a.warning("Радиус введен неверно"),o=e.part.points,a=t.pointIndex,c=a>0?a-1:o.length-1,d=e.part.borders[c],l=[].concat(Object(B["a"])(o[d.pointsIndexes[0]].c),Object(B["a"])(e.point.c)),u=e.part.borders[a],h=[].concat(Object(B["a"])(e.point.c),Object(B["a"])(o[u.pointsIndexes[1]].c)),p=new ht.a(l[2],l[3]),g=new ht.a(l[0]-l[2],l[1]-l[3]),m=g.norm().multiply(new ht.a(s,s)).add(p).toArray(),f=new ht.a(h[2]-h[0],h[3]-h[1]),x=f.norm().multiply(new ht.a(s,s)).add(p).toArray(),v=t.partIndex,I=t.pointIndex,e.$store.dispatch("addPoint",{i:v,j:a+1,border:{id:e.getId(),type:"lineBorder"},point:{id:e.getId(),c:x}}),e.$store.commit("movePoint",{pointIndex:I,partIndex:v,c:m}),b={borderIndex:a,radius:s,isInside:!1},e.$store.dispatch("makeBorderCurve",Object(k["a"])(Object(k["a"])({},b),{},{partIndex:v})),e.$store.commit("addLog");case 28:case"end":return n.stop()}}),n)})))()},showAngle:function(t){var e={isShown:!0,isOutside:!1};this.$store.commit("setAngleTagParams",Object(k["a"])({i:t.partIndex,j:t.pointIndex},e)),this.$store.commit("addLog")}}},se=re,oe=Object(b["a"])(se,Yt,Gt,!1,null,null,null),ae=oe.exports,ce=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-line",{ref:"iB",attrs:{config:Object.assign({},t.config,{strokeWidth:[t.currentElId,t.selectedElId].includes(t.iB.id)?2:0})},on:{dragstart:t.startIBDrag,dragend:t.dragend,mouseover:function(e){return t.$store.commit("setCurrentEl",t.iB.id)},mouseleave:function(e){return t.$store.commit("setCurrentEl",null)},click:function(e){return t.$store.commit("setSelectedElId",t.iB.id)},contextmenu:function(e){return t.setContextMenuEvent(e,t.iBIndex)}}})],1)},de=[],le={props:["partIndex","iBIndex"],data:function(){return{iBStartPoint:[0,0],isCtrlKey:!1}},computed:{part:function(){return this.$store.state.parts.partsInit[this.partIndex]},iB:function(){return this.part.insetsBulges[this.iBIndex]},pxPerMm:function(){return this.$store.state.pxPerMm},dash:function(){return[30*this.pxPerMm,15*this.pxPerMm]},selectedColor:function(){return this.$store.state.selectedColor},points:function(){var t=this,e=[];return this.iB.pointsIndexes.forEach((function(n){e.push.apply(e,Object(B["a"])(t.part.points[n].c))})),e},config:function(){var t=this,e=this,n=this.iB,i=this.points,r=n.id,s=n.type;return this.console.log("insetBulge",r),{id:r,points:i.map((function(e){return e*t.pxPerMm})),closed:!0,dash:this.dash,stroke:this.selectedColor,type:s,draggable:!0,dragBoundFunc:function(t){return e.dragIB(t),this.absolutePosition()}}},selectedElId:function(){return this.$store.state.selectedElId},currentElId:function(){return this.$store.state.currentElId},partPosition:function(){return this.part.position},contextMenuAction:function(){return this.$store.state.contextMenuAction}},watch:{contextMenuAction:function(t){t.partIndex===this.partIndex&&t.insetBulgeIndex===this.iBIndex&&"deleteInsetBulge"===t.action&&this.deleteInsetBulge()}},methods:{setContextMenuEvent:function(t,e){var n=this.partIndex;this.$store.commit("setContextMenuEvent",{e:t,partIndex:n,insetBulgeIndex:e})},deleteInsetBulge:function(){var t=this,e=this.iB.pointsIndexes,n=this.partIndex;this.$store.commit("setSelectedElId",null),this.$store.dispatch("deleteInsetBulge",{i:n,j:this.iBIndex}),new Array(4).fill("").forEach((function(){t.$store.dispatch("deletePoint",{i:n,j:e[0]})})),this.$store.commit("addLog")},startIBDrag:function(t){this.isCtrlKey=t.evt.ctrlKey,this.iBStartPoint=this.clone(this.points)},dragIB:function(t){var e=this,n=this.points,i=this.iBStartPoint,r=(t.x-this.partPosition.x)/this.pxPerMm+i[0],s=(t.y-this.partPosition.y)/this.pxPerMm+i[1],o=new ht.a(n[6]-n[0],n[7]-n[1]),a=new ht.a(r-i[0],s-i[1]),c=o.angleDeg();c=c;var d=a.angleDeg()-c;d<-180?d+=360:d>180&&(d-=360);var l=o.dot(a)/(o.length()*a.length()),u=l*a.length();if(this.isCtrlKey||(u=10*Math.round(u/10)),u){var h=(new ht.a).norm().rotateDeg(c).multiply(new ht.a(u,u));this.iB.pointsId.forEach((function(t,n){e.$store.commit("changePoint",{i:e.partIndex,j:e.iB.pointsIndexes[n],point:new ht.a(i[2*n],i[2*n+1]).add(h).toObject()})}))}},dragend:function(){this.$refs.iB.getNode().clearCache(),this.$store.commit("addLog")}}},ue=le,he=Object(b["a"])(ue,ce,de,!1,null,null,null),pe=he.exports,ge=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-group",{ref:"group",on:{mouseover:function(e){return t.$store.commit("setCurrentEl",t.sizeTag.id)},mouseleave:function(e){return t.$store.commit("setCurrentEl",null)},click:function(e){return t.$store.commit("setSelectedElId",t.sizeTag.id)}}},[n("v-arrow",{attrs:{config:{points:t.params.arrowPoints,stroke:"black",fill:"black",pointerAtBeginning:!0,strokeWidth:1,pointerLength:t.arrowLength,pointerWidth:3,dash:t.dash}}}),n("v-label",{attrs:{config:Object.assign({},t.params.textPosition,{rotation:t.params.angle,offset:t.params.offset,draggable:!0,dragBoundFunc:t.params.dragBoundFunc})},on:{mouseover:function(e){t.over=!0},mouseleave:function(e){t.over=!1},contextmenu:t.setContextMenuEvent,dragstart:t.dragstart,dragend:t.dragend}},[n("v-tag",{attrs:{config:{fill:"white"}}}),n("v-text",{attrs:{config:{text:t.params.lengthText,padding:t.params.padding,fontSize:t.fontSize,fontFamily:"Calibri",fill:t.over?t.selectedColor:"black",type:"singleSizeTag"}}})],1),n("v-circle",{attrs:{config:Object.assign({},t.circles,{x:t.params.arrowPoints[0],y:t.params.arrowPoints[1],draggable:!0,dragBoundFunc:t.dragPointFunc})},on:{dragstart:function(e){return t.dragstart(e,1)},dragend:t.dragend}}),n("v-circle",{attrs:{config:Object.assign({},t.circles,{x:t.params.arrowPoints[2],y:t.params.arrowPoints[3],draggable:!0,dragBoundFunc:t.dragPointFunc})},on:{dragstart:function(e){return t.dragstart(e,2)},dragend:t.dragend}})],1)},me=[],fe={props:["partIndex","sizeTagIndex"],data:function(){var t=this;return{over:!1,isCtrlKey:!1,arrowLength:3,startDragData:{},dragPointFunc:function(e){return t.dragPoint(e),this.absolutePosition()}}},computed:{pxPerMm:function(){return this.$store.state.pxPerMm},fontSize:function(){return this.$store.state.fontSizeInmM.sizeArrow*this.pxPerMm},selectedElId:function(){return this.$store.state.selectedElId},currentElId:function(){return this.$store.state.currentElId},part:function(){return this.$store.state.parts.partsInit[this.partIndex]},sizeTag:function(){return this.part.singleSizeTags[this.sizeTagIndex]},points:function(){return this.sizeTag.points},circles:function(){var t={radius:60*this.pxPerMm,fill:"transparent"};return[this.currentElId,this.selectedElId].includes(this.sizeTag.id)&&(t.fill=this.selectedColor),t},params:function(){var t=this,e=this.sizeTag.points.map((function(e){return e*t.pxPerMm})),n=new ht.a(e[0],e[1]),i=new ht.a(e[2]-e[0],e[3]-e[1]),r=i.angleDeg();r=r<0?r+360:r;var s=this.fontSize/2,o=i.length(),a=Math.round((o+2*this.arrowLength)/this.pxPerMm).toString(),c={x:s*a.length,y:s},d=.5*o+c.x/2,l=i.clone().norm().multiply(new ht.a(d,d)),u=l.add(n).toObject(),h=this;return{arrowPoints:e,textPosition:u,lengthText:a,padding:0,angle:r,offset:c,dragBoundFunc:function(t){return h.dragTag(t),this.absolutePosition()}}},partPosition:function(){return this.part.position},contextMenuAction:function(){return this.$store.state.contextMenuAction},dash:function(){return this.$store.state.dash},selectedColor:function(){return this.$store.state.selectedColor}},watch:{contextMenuAction:function(t){var e=this;t.partIndex===this.partIndex&&t.sizeTagIndex===this.sizeTagIndex&&"deleteSingleSizeTag"===t.action&&setTimeout((function(){e.$store.commit("deleteSingleSizeTag",{i:t.partIndex,j:t.sizeTagIndex}),e.$store.commit("addLog")}),0)},over:function(t){t?this.$store.commit("setCursor","move"):this.$store.commit("resetCursor")}},methods:{setContextMenuEvent:function(t){var e=this.partIndex,n=this.sizeTagIndex;this.$store.commit("setContextMenuEvent",{e:t,partIndex:e,sizeTagIndex:n})},dragTag:function(t){var e=this.startDragData,n=e.startPoint,i=e.pts,r=(t.x-n.x)/this.pxPerMm,s=(t.y-n.y)/this.pxPerMm,o=[i[0]+r,i[1]+s,i[2]+r,i[3]+s];this.$store.commit("setSingleSizeTagParams",{i:this.partIndex,j:this.sizeTagIndex,points:o})},dragPoint:function(t){var e=this.startDragData,n=e.startPoint,i=e.pts,r=e.pointNum,s=(t.x-n.x)/this.pxPerMm,o=(t.y-n.y)/this.pxPerMm,a=this.clone(i);1===r?(a[0]+=s,a[1]+=o):(a[2]+=s,a[3]+=o),this.$store.commit("setSingleSizeTagParams",{i:this.partIndex,j:this.sizeTagIndex,points:a})},dragstart:function(t,e){this.isCtrlKey=t.evt.ctrlKey,this.startDragData={startPoint:t.target.absolutePosition(),pts:this.clone(this.sizeTag.points),pointNum:e}},dragend:function(){this.$refs.group.getNode().clearCache(),this.$store.commit("addLog")}}},xe=fe,ve=Object(b["a"])(xe,ge,me,!1,null,null,null),Ie=ve.exports,be=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-image",{ref:"image",attrs:{config:Object.assign({},t.config)},on:{dragend:t.dragend,contextmenu:t.setContextMenuEvent}})},ye=[],Me={props:["washingIndex","partIndex"],data:function(){return{isCtrlKey:!1,startPoint:{}}},computed:{pxPerMm:function(){return this.$store.state.pxPerMm},part:function(){return this.$store.state.parts.partsInit[this.partIndex]},washing:function(){return this.part.washings[this.washingIndex]},partPosition:function(){return this.part.position},contextMenuAction:function(){return this.$store.state.contextMenuAction},config:function(){var t=this.washing;return{x:t.x*this.pxPerMm,y:t.y*this.pxPerMm,height:t.height*this.pxPerMm,width:t.width*this.pxPerMm,type:"washing",draggable:!0,subType:t.subType,image:this.$store.state.files.washings[t.subType]}}},watch:{contextMenuAction:function(t){var e=this;t.partIndex===this.partIndex&&t.washingIndex===this.washingIndex&&"deleteWashing"===t.action&&setTimeout((function(){e.$store.commit("deleteWashing",{i:t.partIndex,j:t.washingIndex}),e.$store.commit("addLog")}),0)}},methods:{setContextMenuEvent:function(t){var e=this.partIndex,n=this.washingIndex;this.$store.commit("setContextMenuEvent",{e:t,partIndex:e,washingIndex:n})},dragend:function(t){this.$refs.image.getNode().clearCache();var e=t.target.absolutePosition();this.$store.commit("setWashingParams",{i:this.partIndex,j:this.washingIndex,x:(e.x-this.partPosition.x)/this.pxPerMm,y:(e.y-this.partPosition.y)/this.pxPerMm}),this.$store.commit("addLog")}}},we=Me,Pe=Object(b["a"])(we,be,ye,!1,null,null,null),$e=Pe.exports,Ce={mixins:[x],props:["partIndex","part"],data:function(){return{}},components:{Borders:Xt,PPoint:ae,InsetBulge:pe,SingleSizeTag:Ie,Washing:$e},computed:{selectedElId:function(){return this.$store.state.selectedElId},currentElId:function(){return this.$store.state.currentElId},pxPerMm:function(){return this.$store.state.pxPerMm},curveBorders:function(){return this.part.borders.filter((function(t){return"curveBorder"===t.type})).map((function(t){return{pointsIndexes:t.pointsIndexes,isInside:t.isInside,id:t.id,radius:t.radius}}))},curves:function(){var t=this,e={},n=this.part.points;return this.curveBorders.forEach((function(i){var r=i.radius*t.pxPerMm,s=n[i.pointsIndexes[0]].c.map((function(e){return e*t.pxPerMm})),o=n[i.pointsIndexes[1]].c.map((function(e){return e*t.pxPerMm})),a={x:s[0],y:s[1]},c={x:o[0],y:o[1]},d={x:.5*(a.x+c.x),y:.5*(a.y+c.y)},l=-(c.y-a.y),u=c.x-a.x,h=Math.sqrt(Math.pow(l,2)+Math.pow(u,2));l/=h,u/=h;var p=Math.sqrt(Math.pow(d.x-a.x,2)+Math.pow(d.y-a.y,2)),g=p/r;if(!(g<-1||g>1)){var m=Math.sqrt(1-Math.pow(g,2)),f=r*m,x={x:d.x+l*f,y:d.y+u*f},v={x:d.x-l*f,y:d.y-u*f},I=Math.atan2(a.y-x.y,a.x-x.x),b=Math.atan2(c.y-x.y,c.x-x.x),y=Math.sqrt(Math.pow(c.x-a.x,2)+Math.pow(c.y-a.y,2)),M=(c.x-a.x)/y,w=Math.acos(M),P=a.x>c.x?a.y-c.y:c.y-a.y,$=P>0?-1:1;e[i.id]={c1:i.isInside?v:x,p1:a,p2:c,R:r,ang1:i.isInside?Math.PI+2*Math.abs(1.57-w)*$-I:I,ang2:i.isInside?Math.PI+2*Math.abs(1.57-w)*$-b:b,isInside:i.isInside}}})),e},points:function(){var t=this;return this.part.points.map((function(e){return e.c.map((function(e){return e*t.pxPerMm}))}))},borders:function(){return this.part.borders.map((function(t){return{type:t.type,id:t.id}}))},partShapeConfig:function(){this.console.log("partShape",this.part.id);var t=this.part,e=t.type,n=t.id,i=this.points,r=this.curves,s=this.borders;return{type:e,id:n,sceneFunc:function(t,e){t.beginPath(),t.moveTo.apply(t,Object(B["a"])(i[0])),i.forEach((function(e,n){if("lineBorder"===s[n].type)t.lineTo.apply(t,Object(B["a"])(e));else if("curveBorder"===s[n].type){var i=r[s[n].id];t.arc(i.c1.x,i.c1.y,i.R,i.ang1,i.ang2,i.isInside)}})),t.fillStrokeShape(e)}}},myBB:function(){var t=this,e=this.part,n=e.points.map((function(e){return e.c[0]*t.pxPerMm})),i=e.points.map((function(e){return e.c[1]*t.pxPerMm})),r={id:e.id,absolute:{x1:Math.min.apply(Math,Object(B["a"])(n)),x2:Math.max.apply(Math,Object(B["a"])(n)),y1:Math.min.apply(Math,Object(B["a"])(i)),y2:Math.max.apply(Math,Object(B["a"])(i))}};return r.relative={x1:r.absolute.x1+e.position.x,x2:r.absolute.x2+e.position.x,y1:r.absolute.y1+e.position.y,y2:r.absolute.y2+e.position.y},r.width=Math.abs(r.absolute.x2-r.absolute.x1),r.height=Math.abs(r.absolute.y2-r.absolute.y1),r},otherPartsBB:function(){var t=this;return this.$store.state.parts.boundingBoxes.filter((function(e){return e.id!==t.part.id}))},groupConfig:function(){var t=this.otherPartsBB,e=this.myBB.absolute,n=!1,i=null,r={type:"part",draggable:!0,dragBoundFunc:function(r){if(!n)return r;var s=r;if(t.length){var o=e.x1+r.x,a=e.x2+r.x,c=e.y1+r.y,d=e.y2+r.y,l=t.some((function(t){var n=t.relative;if(o>=n.x2||a<=n.x1)return!1;if(c>=n.y2||d<=n.y1)return!1;var r={x:0,y:0};return r.x=a>n.x2?n.x2-o:a-n.x1,r.y=d>n.y2?n.y2-c:d-n.y1,r.x<r.y&&(null===i||"x"===i)?(s.x=a>=n.x2?n.x2-e.x1:n.x1-e.x2,i="x"):(s.y=d>=n.y2?n.y2-e.y1:n.y1-e.y2,i="y"),!0}));i=l?i:null}return s}};return this.part.position&&Object.assign(r,Object(k["a"])({},this.part.position)),r},fill:function(){var t=this.$store.state.parts.partsInit[this.partIndex].fill,e={color:"white",image:null};return t?("color"===t?e.color="rgb(200,200,200)":e.image=W({type:t,color:"rgb(200,200,200)"}),e):e},contextMenuAction:function(){return this.$store.state.contextMenuAction}},watch:{contextMenuAction:function(t){var e=this;if(t.partIndex===this.partIndex)if("deletePart"===t.action)setTimeout((function(){e.$store.commit("deletePart",t.partIndex),e.$store.commit("addLog")}),0);else if("addSingleSizeTag"===t.action){var n={points:[this.part.points[0].c[0],this.part.points[0].c[1]-500,this.part.points[0].c[0]+500,this.part.points[0].c[1]-500],id:this.getId(),i:t.partIndex,type:"singleSizeTag"};this.$store.commit("addSingleSizeTag",n),this.$store.commit("addLog")}},myBB:{handler:function(t){this.$store.commit("setBoundingBox",{i:this.partIndex,bb:t})},immediate:!0}},methods:{log:function(t){"part"===t.target.attrs.type&&this.setPartPosition(t.target.getPosition())},setPartPosition:function(t){this.$store.commit("setPartPosition",{i:this.partIndex,pos:t}),this.$store.commit("addLog")},setContextMenuEvent:function(t){var e=this.partIndex;this.$store.commit("setContextMenuEvent",{e:t,partIndex:e})}}},Ee=Ce,Te=Object(b["a"])(Ee,ot,at,!1,null,null,null),je=Te.exports,Se=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.element?n("div",{staticClass:"d-inline-block bg-white p-4 position-absolute element-menu"},["lineBorder"===t.element.type?n("line-border-menu"):"curveBorder"===t.element.type?n("curve-border-menu"):["inset","bulge"].includes(t.element.type)?n("inset-bulge-menu"):"edge"===t.element.type?n("edge-menu",{attrs:{initType:t.element.edgeType}}):"part"===t.element.type?n("part-menu"):["totalText","partText"].includes(t.element.type)?n("text-menu"):"singleSizeTag"===t.element.type?n("single-size-tag-menu"):"legend"===t.element.type?n("legend-menu"):t._e()],1):t._e()},ke=[],Be=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("form",{on:{submit:function(e){return e.preventDefault(),t.setBorderLength(e)}}},[n("div",{staticClass:"form-group row no-gutters"},[n("label",{staticClass:"col-auto col-form-label text-left"},[t._v("Длина")]),n("div",{staticClass:"col-auto px-1"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.lengthInMm,expression:"lengthInMm"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.lengthInMm},on:{input:function(e){e.target.composing||(t.lengthInMm=e.target.value)}}})]),n("span",{staticClass:"col-auto d-flex align-items-center"},[t._v("мм")])]),n("div",{staticClass:"form-group row no-gutters"},[t._m(0),n("div",{staticClass:"col-auto"},[n("change-line-by-end",{attrs:{element:t.element,points:t.points},on:{setChoosedPoint:function(e){t.choosedPoint=e}}})],1)])])])},_e=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"col-auto text-left"},[n("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[t._v("Установить")])])}],Oe=(n("a434"),n("3835")),ze=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"btn-group ml-3",attrs:{role:"group",title:"За счет какой стороны менять длину"}},[n("button",{staticClass:"btn",class:["btn"+(1===t.choosed?"":"-outline")+"-secondary"],attrs:{type:"button"},on:{click:function(e){t.choosed=1}}},[n("font-awesome-icon",{style:t.angleStyle,attrs:{icon:"long-arrow-alt-right"}})],1),n("button",{staticClass:"btn",class:["btn"+(t.choosed?"-outline":"")+"-secondary"],attrs:{type:"button"},on:{click:function(e){t.choosed=0}}},[n("font-awesome-icon",{style:t.angleStyle,attrs:{icon:"long-arrow-alt-left"}})],1),n("button",{staticClass:"btn",class:["btn"+("both"===t.choosed?"":"-outline")+"-secondary"],attrs:{type:"button"},on:{click:function(e){t.choosed="both"}}},[n("font-awesome-icon",{style:t.angleStyle,attrs:{icon:"arrows-alt-h"}})],1)])},Le=[],De={props:["element","points"],data:function(){return{choosed:1}},computed:{angleStyle:function(){if(!this.points)return null;var t=this.points,e=t[0],n=t[1],i=Math.sqrt(Math.pow(n.x-e.x,2)+Math.pow(n.y-e.y,2)),r=(n.x-e.x)/i,s=Math.acos(r)*(180/Math.PI);return s=n.y>e.y?s:-s,{transform:"rotate(".concat(s,"deg)")}}},watch:{choosed:{handler:function(t){this.$emit("setChoosedPoint",t)},immediate:!0}}},Ae=De,Re=Object(b["a"])(Ae,ze,Le,!1,null,null,null),Fe=Re.exports,We={components:{ChangeLineByEnd:Fe},data:function(){return{choosedPoint:null,lengthInMm:0}},computed:{selectedEl:function(){return this.$store.getters.selectedEl},part:function(){return this.$store.state.parts.partsInit[this.selectedEl.i]},element:function(){return this.selectedEl.el},elementId:function(){return this.element.id},points:function(){var t=this.selectedEl.j,e=t<this.part.points.length-1?t+1:0,n=this.part.points[t],i=this.part.points[e],r=[{x:n.c[0],y:n.c[1],id:n.id},{x:i.c[0],y:i.c[1],id:i.id}].sort((function(t,e){return t.x-e.x}));return r[0].x===r[1].x&&r.sort((function(t,e){return t.y-e.y})),r},pxPerMm:function(){return this.$store.state.pxPerMm},currentLengthInMm:function(){var t=Object(Oe["a"])(this.points,2),e=t[0],n=t[1],i=Math.sqrt(Math.pow(n.x-e.x,2)+Math.pow(n.y-e.y,2));return Math.round(i)}},watch:{points:{handler:function(){this.getLength()},immediate:!0}},methods:{getLength:function(){this.lengthInMm=this.currentLengthInMm},setBorderLength:function(){var t=this;return Object(lt["a"])(regeneratorRuntime.mark((function e(){var n,i,r,s,o,a,c,d,l,u,h,p,g,m,f;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.getLinearEquation(),i=n.m,r=n.n,s=t.points,o="both"===t.choosedPoint?[0,1]:[t.choosedPoint],a=[],c=t.currentLengthInMm,d=(s[0].x-s[1].x)/c,l=t.lengthInMm,o.forEach((function(e){var n=t.clone(s[e]),o=e?t.clone(s[0]):t.clone(s[1]),u="both"===t.choosedPoint?(l-c)/2:l-c;if(n.x===o.x){var h=n.y>o.y?1:-1;n.y+=u*h}else if(n.y===o.y){var p=n.x>o.x?1:-1;n.x+=u*p}else{var g=n.y>o.y&&i<0||n.y<o.y&&i>0?1:-1,m=d*u*g;n.x+=m,n.y=n.x*i+r}a.push(n)})),u=t.selectedEl.i,h=t.checkIfNeedFixCurvesRadiuses(a),!h.length){e.next=18;break}return p="При изменении данной длины будут увеличены радиус(ы) прилегающих выпуклых/вогнутых линий. Продолжить?",g="Подтверждение",e.next=15,Ht({body:p,title:g});case 15:if(m=e.sent,m){e.next=18;break}return e.abrupt("return");case 18:h.length&&h.forEach((function(e){var n=e.j,i=e.radius;t.$store.dispatch("changeRadius",{i:u,j:n,radius:i})})),f=[],t.part.points.some((function(e,n){var i=a.findIndex((function(t){return t.id===e.id}));return i>=0&&(["inset","bulge"].includes(e.subType)&&f.push({insetBulgeId:e.insetBulgeId,fromPointId:e.id,x:a[i].x-e.c[0],y:a[i].y-e.c[1]}),t.$store.dispatch("changePoint",{i:u,j:n,point:a.splice(i,1)[0]})),!a.length})),f.length&&f.forEach((function(e){var n=t.part.insetsBulges.find((function(t){return t.id===e.insetBulgeId}));n.pointsId.filter((function(t){return t!==e.fromPointId})).forEach((function(n){var i=t.part.points.findIndex((function(t){return t.id===n})),r=Object(Oe["a"])(t.part.points[i].c,2),s=r[0],o=r[1];t.$store.dispatch("changePoint",{i:u,j:i,point:{x:s+e.x,y:o+e.y}})}))})),t.$store.commit("addLog");case 23:case"end":return e.stop()}}),e)})))()},getLinearEquation:function(){var t=this.points,e=(t[1].y-t[0].y)/(t[1].x-t[0].x),n=-t[0].x*e+t[0].y;return{m:e,n:n}},checkIfNeedFixCurvesRadiuses:function(t){var e=[],n=this.part,i=n.borders,r=n.points,s=this.selectedEl.j,o=s>0?s-1:i.length-1,a=i[o];if("curveBorder"===a.type){var c={x:r[o].c[0],y:r[o].c[1]},d=t.find((function(t){return t.id===r[s].id}));if(d){var l=Math.sqrt(Math.pow(d.x-c.x,2)+Math.pow(d.y-c.y,2))/2+2;a.radius<l&&e.push({j:o,radius:l})}}s=s<i.length-1?s+1:0;var u=s<i.length-1?s+1:0,h=i[s];if("curveBorder"===h.type){var p={x:r[u].c[0],y:r[u].c[1]},g=t.find((function(t){return t.id===r[s].id}));if(g){var m=Math.sqrt(Math.pow(g.x-p.x,2)+Math.pow(g.y-p.y,2))/2+2;h.radius<m&&e.push({j:s,radius:m})}}return e}}},Ne=We,Ke=Object(b["a"])(Ne,Be,_e,!1,null,null,null),qe=Ke.exports,He=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("form",{on:{submit:function(e){return e.preventDefault(),t.setParams(e)}}},[n("div",{staticClass:"form-group row no-gutters"},[n("label",{staticClass:"col-auto col-form-label text-left"},[t._v("Отступ от прямой")]),n("div",{staticClass:"col-auto px-1"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.marginInMm,expression:"marginInMm"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.marginInMm},on:{input:[function(e){e.target.composing||(t.marginInMm=e.target.value)},t.calcRadius]}})]),n("span",{staticClass:"col-auto d-flex align-items-center"},[t._v("мм")]),n("div",{staticClass:"w-100"}),n("small",{staticClass:"form-text text-muted col-auto text-left"},[t._v(" "+t._s("Максимальный отступ "+t.maxMargin+" мм")+" ")])]),n("div",{staticClass:"form-group row no-gutters"},[n("label",{staticClass:"col-auto col-form-label text-left"},[t._v("Радиус")]),n("div",{staticClass:"col-auto px-1"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.radiusInMm,expression:"radiusInMm"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.radiusInMm},on:{input:function(e){e.target.composing||(t.radiusInMm=e.target.value)}}})]),n("span",{staticClass:"col-auto d-flex align-items-center"},[t._v("мм")]),n("div",{staticClass:"w-100"}),n("small",{staticClass:"form-text text-muted col-auto text-left"},[t._v(" "+t._s("Минимальный радиус "+t.minRadius+" мм")+" ")])]),n("div",{staticClass:"form-group row no-gutters"},[n("label",{staticClass:"col-auto col-form-label text-left"},[t._v("Длина по прямой")]),n("div",{staticClass:"col-auto px-1"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.lengthInMm,expression:"lengthInMm"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.lengthInMm},on:{input:function(e){e.target.composing||(t.lengthInMm=e.target.value)}}})]),n("span",{staticClass:"col-auto d-flex align-items-center"},[t._v("мм")]),n("div",{staticClass:"w-100"}),n("small",{staticClass:"form-text text-muted col-auto text-left"},[t._v(" "+t._s("Максимальная длина "+t.maxLength+" мм")+" ")])]),n("div",{staticClass:"form-group row no-gutters"},[t._m(0),n("div",{staticClass:"col-auto"},[n("change-line-by-end",{attrs:{element:t.element,points:t.points},on:{setChoosedPoint:function(e){t.choosedPoint=e}}})],1)])])])},Je=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"col-auto text-left"},[n("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[t._v("Установить")])])}],Ue={components:{ChangeLineByEnd:Fe},data:function(){return{radiusInMm:0,choosedPoint:null,lengthInMm:0,marginInMm:0}},computed:{selectedEl:function(){return this.$store.getters.selectedEl},part:function(){return this.$store.state.parts.partsInit[this.selectedEl.i]},element:function(){return this.selectedEl.el},elementId:function(){return this.element.id},pxPerMm:function(){return this.$store.state.pxPerMm},points:function(){var t=this.selectedEl.j,e=t<this.part.points.length-1?t+1:0,n=this.part.points[t],i=this.part.points[e],r=[{x:n.c[0],y:n.c[1],id:n.id},{x:i.c[0],y:i.c[1],id:i.id}].sort((function(t,e){return t.x-e.x}));return r[0].x===r[1].x&&r.sort((function(t,e){return t.y-e.y})),r},currentLengthInMm:function(){var t=Object(Oe["a"])(this.points,2),e=t[0],n=t[1],i=Math.sqrt(Math.pow(n.x-e.x,2)+Math.pow(n.y-e.y,2));return Math.round(i)},minRadius:function(){return Math.floor(this.lengthInMm/2)},maxLength:function(){return Math.ceil(2*this.radiusInMm)},maxMargin:function(){return Math.ceil(this.lengthInMm/2)},currentMarginInMm:function(){var t=this.radiusInMm,e=t-Math.sqrt(Math.pow(t,2)-Math.pow(this.currentLengthInMm,2)/4);return Math.round(1e3*e)/1e3}},watch:{points:{handler:function(){this.radiusInMm=this.element.radius,this.lengthInMm=this.currentLengthInMm,this.marginInMm=this.currentMarginInMm},immediate:!0}},methods:{calcRadius:function(){var t=this.currentLengthInMm,e=this.marginInMm,n=(Math.pow(e,2)+Math.pow(t,2)/4)/(2*e);e>this.maxMargin&&(n=0),this.radiusInMm=Math.round(1e3*n)/1e3},setParams:function(){this.lengthInMm>this.maxLength?gt.a.warning("При таком радиусе длина не может быть больше ".concat(this.maxLength," мм")):this.radiusInMm<this.minRadius?gt.a.warning("Радиус не может быть меньше ".concat(this.minRadius," мм")):(this.setRadius(),this.setBorderLength(),this.$store.commit("addLog"))},setRadius:function(){var t=this.selectedEl,e=t.i,n=t.j;this.$store.dispatch("changeRadius",{i:e,j:n,radius:this.radiusInMm})},setBorderLength:function(){var t=this;return Object(lt["a"])(regeneratorRuntime.mark((function e(){var n,i,r,s,o,a,c,d,l,u,h,p,g,m;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.getLinearEquation(),i=n.m,r=n.n,s=t.points,o="both"===t.choosedPoint?[0,1]:[t.choosedPoint],a=[],c=t.currentLengthInMm,d=(s[0].x-s[1].x)/c,l=t.lengthInMm,o.forEach((function(e){var n=t.clone(s[e]),o=e?t.clone(s[0]):t.clone(s[1]),u="both"===t.choosedPoint?(l-c)/2:l-c;if(n.x===o.x){var h=n.y>o.y?1:-1;n.y+=u*h}else if(n.y===o.y){var p=n.x>o.x?1:-1;n.x+=u*p}else{var g=n.y>o.y&&i<0||n.y<o.y&&i>0?1:-1,m=d*u*g;n.x+=m,n.y=n.x*i+r}a.push(n)})),u=t.selectedEl.i,h=t.checkIfNeedFixCurvesRadiuses(a),!h.length){e.next=19;break}return p="При изменении данной длины будут увеличены радиус(ы) прилегающих выпуклых/вогнутых линий. Продолжить?",g="Подтверждение",e.next=15,Ht({body:p,title:g});case 15:if(m=e.sent,m){e.next=18;break}return e.abrupt("return");case 18:h.forEach((function(e){var n=e.j,i=e.radius;t.$store.dispatch("changeRadius",{i:u,j:n,radius:i})}));case 19:t.part.points.some((function(e,n){var i=a.findIndex((function(t){return t.id===e.id}));return i>=0&&t.$store.dispatch("changePoint",{i:u,j:n,point:a.splice(i,1)[0]}),!a.length}));case 20:case"end":return e.stop()}}),e)})))()},getLinearEquation:function(){var t=this.points,e=(t[1].y-t[0].y)/(t[1].x-t[0].x),n=-t[0].x*e+t[0].y;return{m:e,n:n}},checkIfNeedFixCurvesRadiuses:function(t){var e=[],n=this.part,i=n.borders,r=n.points,s=this.selectedEl.j,o=s>0?s-1:i.length-1,a=i[o];if("curveBorder"===a.type){var c={x:r[o].c[0],y:r[o].c[1]},d=t.find((function(t){return t.id===r[s].id}));if(d){var l=Math.floor(Math.sqrt(Math.pow(d.x-c.x,2)+Math.pow(d.y-c.y,2))/2);a.radius<l&&e.push({j:o,radius:l})}}s=s<i.length-1?s+1:0;var u=s<i.length-1?s+1:0,h=i[s];if("curveBorder"===h.type){var p={x:r[u].c[0],y:r[u].c[1]},g=t.find((function(t){return t.id===r[s].id}));if(g){var m=Math.floor(Math.sqrt(Math.pow(g.x-p.x,2)+Math.pow(g.y-p.y,2))/2);h.radius<m&&e.push({j:s,radius:m})}}return e}}},Ze=Ue,Xe=Object(b["a"])(Ze,He,Je,!1,null,null,null),Ye=Xe.exports,Ge=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("form",{on:{submit:function(e){return e.preventDefault(),t.setParams(e)}}},[n("div",{staticClass:"form-group row no-gutters"},[n("label",{staticClass:"col-auto col-form-label text-left"},[t._v("Внешняя длина")]),n("div",{staticClass:"col-auto px-1"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.outLengthInMm,expression:"outLengthInMm"}],staticClass:"form-control",attrs:{type:"number"},domProps:{value:t.outLengthInMm},on:{input:function(e){e.target.composing||(t.outLengthInMm=e.target.value)}}})]),n("span",{staticClass:"col-auto d-flex align-items-center"},[t._v("мм")])]),n("div",{staticClass:"form-group row no-gutters"},[n("label",{staticClass:"col-auto col-form-label text-left"},[t._v("Внутренняя длина")]),n("div",{staticClass:"col-auto px-1"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.inLengthInMm,expression:"inLengthInMm"}],staticClass:"form-control",attrs:{type:"number"},domProps:{value:t.inLengthInMm},on:{input:function(e){e.target.composing||(t.inLengthInMm=e.target.value)}}})]),n("span",{staticClass:"col-auto d-flex align-items-center"},[t._v("мм")])]),n("div",{staticClass:"form-group row no-gutters"},[n("label",{staticClass:"col-auto col-form-label text-left"},[t._v("Глубина")]),n("div",{staticClass:"col-auto px-1"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.depthInMm,expression:"depthInMm"}],staticClass:"form-control",attrs:{type:"number"},domProps:{value:t.depthInMm},on:{input:function(e){e.target.composing||(t.depthInMm=e.target.value)}}})]),n("span",{staticClass:"col-auto d-flex align-items-center"},[t._v("мм")])]),n("div",{staticClass:"form-group row no-gutters"},[n("label",{staticClass:"col-auto col-form-label text-left"},[t._v("Отступ 1")]),n("div",{staticClass:"col-auto px-1"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.marginInMm1,expression:"marginInMm1"}],staticClass:"form-control",attrs:{type:"number"},domProps:{value:t.marginInMm1},on:{input:function(e){e.target.composing||(t.marginInMm1=e.target.value)}}})]),n("span",{staticClass:"col-auto d-flex align-items-center"},[t._v("мм")])]),n("div",{staticClass:"form-group row no-gutters"},[n("label",{staticClass:"col-auto col-form-label text-left"},[t._v("Отступ 2")]),n("div",{staticClass:"col-auto px-1"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.marginInMm2,expression:"marginInMm2"}],staticClass:"form-control",attrs:{type:"number"},domProps:{value:t.marginInMm2},on:{input:function(e){e.target.composing||(t.marginInMm2=e.target.value)}}})]),n("span",{staticClass:"col-auto d-flex align-items-center"},[t._v("мм")])]),t._m(0)])])},Qe=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"form-group row no-gutters"},[n("div",{staticClass:"col-auto text-left"},[n("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[t._v("Установить")])])])}],Ve={data:function(){return{outLengthInMm:0,inLengthInMm:0,depthInMm:0,marginInMm1:0,marginInMm2:0}},computed:{selectedEl:function(){return this.$store.getters.selectedEl},part:function(){return this.$store.state.parts.partsInit[this.selectedEl.i]},element:function(){return this.selectedEl.el},points:function(){var t=this,e=this.element.pointsId.map((function(e){var n=t.part.points.find((function(t){return t.id===e}));return{id:e,c:n.c}}));return{out:"inset"===this.element.type?[e[0],e[3]]:[e[1],e[2]],in:"inset"===this.element.type?[e[1],e[2]]:[e[0],e[3]]}},currentOutLength:function(){var t=this.points.out.map((function(t){return t.c}));return Math.sqrt(Math.pow(t[1][0]-t[0][0],2)+Math.pow(t[1][1]-t[0][1],2))},currentInLength:function(){var t=this.points.in.map((function(t){return t.c}));return Math.sqrt(Math.pow(t[1][0]-t[0][0],2)+Math.pow(t[1][1]-t[0][1],2))},currentMargin1:function(){var t=this.element.pointsIndexes[0]>0?this.element.pointsIndexes[0]-1:this.part.points.length-1,e=this.part.points[t].c,n=this.part.points[this.element.pointsIndexes[0]].c,i=new ht.a(n[0]-e[0],n[1]-e[1]);return i.length()},currentMargin2:function(){var t=this.element.pointsIndexes[3]<this.part.points.length-1?this.element.pointsIndexes[3]+1:0,e=this.part.points[this.element.pointsIndexes[3]].c,n=this.part.points[t].c,i=new ht.a(n[0]-e[0],n[1]-e[1]);return i.length()}},watch:{points:{handler:function(){this.outLengthInMm=Math.round(this.currentOutLength),this.inLengthInMm=Math.round(this.currentInLength),this.depthInMm=this.element.depth},immediate:!0},currentMargin1:{handler:function(){this.marginInMm1=Math.round(this.currentMargin1)},immediate:!0},currentMargin2:{handler:function(){this.marginInMm2=Math.round(this.currentMargin2)},immediate:!0}},methods:{setParams:function(){if(Math.round(this.outLengthInMm)!==Math.round(this.currentOutLength)&&this.setPoints(this.points.out,this.outLengthInMm,this.currentOutLength),Math.round(this.inLengthInMm)!==Math.round(this.currentInLength)&&this.setPoints(this.points.in,this.inLengthInMm,this.currentInLength),Math.round(this.depthInMm)!==Math.round(this.element.depth)){var t=this.points["inset"===this.element.type?"in":"out"];this.setDepth(t,this.depthInMm,this.element.depth)}Math.round(this.marginInMm1)!==Math.round(this.currentMargin1)?this.setMargin1():Math.round(this.marginInMm2)!==Math.round(this.currentMargin2)&&this.setMargin2(),this.$store.commit("addLog")},setPoints:function(t,e,n){var i=new ht.a(t[0].c[0],t[0].c[1]),r=new ht.a(t[1].c[0]-t[0].c[0],t[1].c[1]-t[0].c[1]),s=Math.abs(e-n)/2,o=e>n?180:0;r=r.norm().rotateDeg(o).multiply(new ht.a(s,s)),i=r.clone().add(i),this.setPoint({id:t[0].id,c:i.toObject()}),r=r.norm().rotateDeg(o).multiply(new ht.a(e,e)),i=r.clone().add(i),this.setPoint({id:t[1].id,c:i.toObject()})},setPoint:function(t){var e={i:this.selectedEl.i,j:this.part.points.findIndex((function(e){return e.id===t.id})),point:t.c};this.$store.dispatch("changePoint",e)},setDepth:function(t,e,n){var i=new ht.a(t[0].c[0],t[0].c[1]),r=new ht.a(t[1].c[0]-t[0].c[0],t[1].c[1]-t[0].c[1]),s=r.length(),o=Math.abs(e-n),a=e>n&&"inset"===this.element.type||e<n&&"bulge"===this.element.type?1:-1;r=r.norm().rotateDeg(90*a).multiply(new ht.a(o,o)),i=r.clone().add(i),this.setPoint({id:t[0].id,c:i.toObject()}),r=r.norm().rotateDeg(-90*a).multiply(new ht.a(s,s)),i=r.clone().add(i),this.setPoint({id:t[1].id,c:i.toObject()});var c=this.selectedEl,d=c.i,l=c.j;this.$store.commit("setInsetBulgeDepth",{i:d,j:l,depth:e})},setMargin1:function(){var t=this,e=this.element.pointsIndexes[0]>0?this.element.pointsIndexes[0]-1:this.part.points.length-1,n=this.part.points[e].c,i=this.part.points[this.element.pointsIndexes[0]].c,r=new ht.a(i[0]-n[0],i[1]-n[1]),s=new ht.a(n[0],n[1]),o=r.clone().norm().multiply(new ht.a(this.marginInMm1,this.marginInMm1)).add(s).toArray(),a={x:o[0]-i[0],y:o[1]-i[1]};this.element.pointsIndexes.forEach((function(e){t.$store.dispatch("changePoint",{i:t.selectedEl.i,j:e,point:{x:t.part.points[e].c[0]+a.x,y:t.part.points[e].c[1]+a.y}})}))},setMargin2:function(){var t=this,e=this.element.pointsIndexes[3]<this.part.points.length-1?this.element.pointsIndexes[3]+1:0,n=this.part.points[e].c,i=this.part.points[this.element.pointsIndexes[3]].c,r=new ht.a(i[0]-n[0],i[1]-n[1]),s=new ht.a(n[0],n[1]),o=r.clone().norm().multiply(new ht.a(this.marginInMm2,this.marginInMm2)).add(s).toArray(),a={x:o[0]-i[0],y:o[1]-i[1]};this.element.pointsIndexes.forEach((function(e){t.$store.dispatch("changePoint",{i:t.selectedEl.i,j:e,point:{x:t.part.points[e].c[0]+a.x,y:t.part.points[e].c[1]+a.y}})}))}}},tn=Ve,en=Object(b["a"])(tn,Ge,Qe,!1,null,null,null),nn=en.exports,rn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("p",{staticClass:"mb-0 text-left"},[t._v("Тип")]),t._l(t.types,(function(e){return n("div",{key:e.type,staticClass:"custom-control custom-radio text-left"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.selectedType,expression:"selectedType"}],staticClass:"custom-control-input",attrs:{type:"radio",id:e.type},domProps:{value:e.type,checked:t._q(t.selectedType,e.type)},on:{change:function(n){t.selectedType=e.type}}}),n("label",{staticClass:"custom-control-label d-flex align-items-center",attrs:{for:e.type}},[n("img",{staticClass:"mx-2",staticStyle:{width:"1rem"},attrs:{src:t.files[e.type].src}}),t._v(" "+t._s(e.name)+" ")])])}))],2)},sn=[],on={props:["initType"],data:function(){return{types:[{name:"Кромка 1",type:"empty"},{name:"Кромка 2",type:"half"},{name:"Кромка 3",type:"full"}],selectedType:this.initType}},computed:{selectedEl:function(){return this.$store.getters.selectedEl},files:function(){return this.$store.state.files.edges}},watch:{selectedType:function(t){var e=this.selectedEl,n=e.i,i=e.j;this.$store.commit("setEdgeTagParams",{i:n,j:i,edgeType:t}),this.$store.commit("addLog")}}},an=on,cn=Object(b["a"])(an,rn,sn,!1,null,null,null),dn=cn.exports,ln=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("p",{staticClass:"mb-0 text-left"},[t._v("Фон")]),n("select",{directives:[{name:"model",rawName:"v-model",value:t.fill,expression:"fill"}],staticClass:"custom-select",on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.fill=e.target.multiple?n:n[0]}}},[n("option",{domProps:{value:null}},[t._v("Без фона")]),t._l(t.fills,(function(e){return n("option",{key:e.type,domProps:{value:e.type}},[t._v(t._s(e.title))])}))],2)])},un=[],hn={data:function(){return{fill:null}},computed:{selectedEl:function(){return this.$store.getters.selectedEl},fills:function(){return this.$store.state.fills}},watch:{fill:function(t){this.$store.commit("setPartFill",{fill:t,i:this.selectedEl.i}),this.$store.commit("addLog")},selectedEl:function(t){t.el.fill!==this.fill&&(this.fill=this.selectedEl.el.fill)}},mounted:function(){this.fill=this.selectedEl.el.fill}},pn=hn,gn=Object(b["a"])(pn,ln,un,!1,null,null,null),mn=gn.exports,fn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"text-left"},[n("p",{staticClass:"mb-0 text-left"},[t._v("Размер шрифта")]),t._l(5,(function(e){return n("button",{key:e,staticClass:"btn btn-outline-secondary mr-1",class:{active:t.fontSizeK===t.sizes[e-1]},on:{click:function(n){return t.setFontSize(e-1)}}},[n("font-awesome-icon",{style:{transform:"scale("+t.sizes[e-1]/3+")"},attrs:{icon:"font"}})],1)}))],2)},xn=[],vn={data:function(){return{sizes:[1,1.5,2,2.5,3]}},computed:{selectedEl:function(){return this.$store.getters.selectedEl},fontSizeK:function(){return this.selectedEl.el.fontSizeK}},methods:{setFontSize:function(t){this.fontSizeK!==this.sizes[t]&&(this.$store.commit("setTextParams",Object(k["a"])(Object(k["a"])({i:this.selectedEl.i},this.selectedEl.el),{},{fontSizeK:this.sizes[t]})),this.$store.commit("addLog"))}}},In=vn,bn=Object(b["a"])(In,fn,xn,!1,null,null,null),yn=bn.exports,Mn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("form",{on:{submit:function(e){return e.preventDefault(),t.setTagLength(e)}}},[n("div",{staticClass:"form-group row no-gutters"},[n("label",{staticClass:"col-auto col-form-label text-left"},[t._v("Длина")]),n("div",{staticClass:"col-auto px-1"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.lengthInMm,expression:"lengthInMm"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.lengthInMm},on:{input:function(e){e.target.composing||(t.lengthInMm=e.target.value)}}})]),n("span",{staticClass:"col-auto d-flex align-items-center"},[t._v("мм")])]),t._m(0)])])},wn=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"form-group row no-gutters"},[n("div",{staticClass:"col-auto text-left"},[n("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[t._v("Установить")])])])}],Pn={data:function(){return{lengthInMm:0}},computed:{selectedEl:function(){return this.$store.getters.selectedEl},part:function(){return this.$store.state.parts.partsInit[this.selectedEl.i]},element:function(){return this.selectedEl.el},elementId:function(){return this.element.id},pxPerMm:function(){return this.$store.state.pxPerMm},currentLengthInMm:function(){var t=this.element.points,e=new ht.a(t[2]-t[0],t[3]-t[1]);return Math.round(e.length()+6/this.pxPerMm)}},watch:{currentLengthInMm:{handler:function(){this.getLength()},immediate:!0}},methods:{getLength:function(){this.lengthInMm=this.currentLengthInMm},setTagLength:function(){var t=this.element.points,e=new ht.a(t[0],t[1]),n=new ht.a(t[2]-t[0],t[3]-t[1]),i=this.lengthInMm-6/this.pxPerMm,r=n.norm().multiply(new ht.a(i,i)).add(e).toArray(),s=this.selectedEl,o=s.i,a=s.j;this.$store.commit("setSingleSizeTagParams",{i:o,j:a,points:[t[0],t[1],r[0],r[1]]}),this.$store.commit("addLog")}}},$n=Pn,Cn=Object(b["a"])($n,Mn,wn,!1,null,null,null),En=Cn.exports,Tn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"text-left"},[n("p",{staticClass:"mb-0 text-left"},[t._v("Размер")]),t._l(3,(function(e){return n("button",{key:e,staticClass:"btn btn-outline-secondary mr-1",class:{active:t.sizeK===t.sizes[e-1]},on:{click:function(n){return t.setFontSize(e-1)}}},[n("font-awesome-icon",{style:{transform:"scale("+t.sizes[e-1]/3+")"},attrs:{icon:"font"}})],1)}))],2)},jn=[],Sn={data:function(){return{sizes:[1.2,1.6,2]}},computed:{selectedEl:function(){return this.$store.getters.selectedEl},sizeK:function(){return this.selectedEl.el.sizeK}},methods:{setFontSize:function(t){this.sizeK!==this.sizes[t]&&(this.$store.commit("setLegendParams",{i:this.selectedEl.i,sizeK:this.sizes[t]}),this.$store.commit("addLog"))}}},kn=Sn,Bn=Object(b["a"])(kn,Tn,jn,!1,null,null,null),_n=Bn.exports,On={components:{LineBorderMenu:qe,CurveBorderMenu:Ye,InsetBulgeMenu:nn,EdgeMenu:dn,PartMenu:mn,TextMenu:yn,SingleSizeTagMenu:En,LegendMenu:_n},computed:{element:function(){return this.$store.getters.selectedEl.el}}},zn=On,Ln=(n("ef9c"),Object(b["a"])(zn,Se,ke,!1,null,null,null)),Dn=Ln.exports,An=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"d-inline-block bg-white position-absolute logs-menu"},[n("button",{ref:"logBack",staticClass:"btn btn-outline-dark mr-2",attrs:{type:"button",disabled:t.disabledBack},on:{click:function(e){return t.$store.commit("logBack")}}},[n("font-awesome-icon",{attrs:{icon:"reply"}})],1),n("button",{ref:"logForward",staticClass:"btn btn-outline-dark",attrs:{type:"button",disabled:t.disabledForward},on:{click:function(e){return t.$store.commit("logForward")}}},[n("font-awesome-icon",{attrs:{icon:"share"}})],1),n("save")],1)},Rn=[],Fn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"d-inline-block"},[n("button",{staticClass:"btn btn-outline-dark ml-2",attrs:{type:"button",title:"Скачать изображение"},on:{click:t.saveImage}},[n("font-awesome-icon",{attrs:{icon:"file-image"}})],1),n("button",{staticClass:"btn btn-outline-dark ml-2",attrs:{type:"button",title:"Скачать PDF"},on:{click:t.savePDF}},[n("font-awesome-icon",{attrs:{icon:"file-pdf"}})],1)])},Wn=[],Nn=n("e511"),Kn=n.n(Nn),qn={methods:{getDataUrl:function(){var t=this;return new Promise((function(e){var n=t.$store.state.selectedElId;n&&t.$store.commit("setSelectedElId",null),setTimeout((function(){var i={pixelRatio:3,mimeType:"image/jpeg"};e(t.$store.state.stage.toDataURL(i)),n&&t.$store.commit("setSelectedElId",n)}),0)}))},saveImage:function(){var t=this;return Object(lt["a"])(regeneratorRuntime.mark((function e(){var n,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getDataUrl();case 2:n=e.sent,i=document.createElement("a"),i.download="stage.jpg",i.href=n,document.body.appendChild(i),i.click(),document.body.removeChild(i);case 9:case"end":return e.stop()}}),e)})))()},savePDF:function(){var t=this;return Object(lt["a"])(regeneratorRuntime.mark((function e(){var n,i,r,s,o,a,c,d;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getDataUrl();case 2:n=e.sent,i=new Kn.a("l","mm","a4"),r=i.internal.pageSize.getWidth(),s=i.internal.pageSize.getHeight(),o=r/s,a=t.$store.state.stage.width()/t.$store.state.stage.height(),c=0,d=0,o<a?(s=r/a,c=(i.internal.pageSize.getHeight()-s)/2):(r=s/a,d=(i.internal.pageSize.getWidth()-r)/2),i.addImage(n,"JPEG",d,c,r,s),i.save("stage.pdf");case 13:case"end":return e.stop()}}),e)})))()}}},Hn=qn,Jn=Object(b["a"])(Hn,Fn,Wn,!1,null,null,null),Un=Jn.exports,Zn={components:{Save:Un},computed:{logs:function(){return this.$store.state.logs},logStep:function(){return this.$store.state.logStep},disabledBack:function(){return!this.logs.length||!this.logStep},disabledForward:function(){return this.logStep>=this.logs.length-1}},mounted:function(){var t=this;window.addEventListener("keydown",(function(e){e.ctrlKey&&("KeyZ"===e.code?t.$refs.logBack.click():"KeyY"===e.code&&t.$refs.logForward.click())}))}},Xn=Zn,Yn=(n("e572"),Object(b["a"])(Xn,An,Rn,!1,null,null,null)),Gn=Yn.exports,Qn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.style?n("div",{staticClass:"position-absolute",style:t.style},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.text,expression:"text"}],ref:"text",staticClass:"w-100 h-100",staticStyle:{"line-height":"1",resize:"none"},domProps:{value:t.text},on:{blur:t.saveText,input:function(e){e.target.composing||(t.text=e.target.value)}}})]):t._e()},Vn=[],ti=(n("498a"),{data:function(){return{text:"",width:0,height:0}},computed:{selectedEl:function(){return this.$store.getters.selectedEl},isTextEditMode:function(){return this.$store.state.isTextEditMode},pxPerMm:function(){return this.$store.state.pxPerMm},style:function(){var t=this.selectedEl.el;if(!t||!this.isTextEditMode)return null;if(!["text","totalText","legend"].includes(t.type))return null;var e,n="totalText"===t.type?this.selectedEl.el.fontSizeK:this.selectedEl.el.sizeK,i=this.$store.state.fontSizeInmM.text*this.pxPerMm*n;if("totalText"===t.type||"legend"===t.type){e={top:"".concat(t.y*this.pxPerMm,"px"),left:"".concat(t.x*this.pxPerMm,"px"),fontSize:"".concat(Math.round(i),"px")};var r=this.$store.state.stage.find("Text"),s=r.toArray().find((function(e){return e.id()===t.id})),o=s.width(),a=s.height();return o&&(e.width="".concat(o+30,"px")),a>i&&(e.height="".concat(a+10,"px")),e}return null}},watch:{style:function(t){var e=this;t&&(this.text=this.selectedEl.el.text,setTimeout((function(){e.$refs.text.focus()}),0))}},methods:{saveText:function(){var t=this.text.trim(),e=this.selectedEl,n=e.i,i=e.j,r=e.el,s=r.type,o={i:n,j:i,type:s};if(t.length){var a="totalText"===r.type?"setTextBlock":"setLegendParams",c="totalText"===r.type?Object(k["a"])(Object(k["a"])({},o),{},{text:t}):{i:n,text:t};this.$store.commit(a,c),this.$store.commit("addLog")}else{var d="totalText"===r.type?"deleteTextBlock":"deleteLegend";this.$store.commit(d,o),r.text.length&&this.$store.commit("addLog")}this.$store.commit("setTextEditMode",!1)}}}),ei=ti,ni=Object(b["a"])(ei,Qn,Vn,!1,null,null,null),ii=ni.exports,ri=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-text",{attrs:{config:{type:t.text.type,id:t.text.id,x:t.text.x*this.pxPerMm,y:t.text.y*this.pxPerMm,text:t.text.text,fontFamily:"Calibri",fontSize:t.fontSize,fill:[t.currentElId,t.selectedElId].includes(t.text.id)?t.selectedColor:"black",draggable:!0,visible:!(t.selectedElId===t.text.id&&t.isTextEditMode)}},on:{mouseover:function(e){t.over=!0},mouseleave:function(e){t.over=!1},dragend:t.dragend,click:function(e){return t.$store.commit("setSelectedElId",t.text.id)},dblclick:t.editText,contextmenu:t.setContextMenuEvent}})],1)},si=[],oi={props:["text","textIndex"],data:function(){return{over:!1}},computed:{selectedColor:function(){return this.$store.state.selectedColor},selectedElId:function(){return this.$store.state.selectedElId},currentElId:function(){return this.$store.state.currentElId},pxPerMm:function(){return this.$store.state.pxPerMm},fontSize:function(){return this.$store.state.fontSizeInmM.text*this.pxPerMm*this.text.fontSizeK},isTextEditMode:function(){return this.$store.state.isTextEditMode},contextMenuAction:function(){return this.$store.state.contextMenuAction}},watch:{over:function(t){t?(this.$store.commit("setCursor","move"),this.$store.commit("setCurrentEl",this.text.id)):(this.$store.commit("resetCursor"),this.$store.commit("setCurrentEl",null))},contextMenuAction:function(t){t.textIndex===this.textIndex&&"deleteTotalText"===t.action&&(this.$store.commit("deleteTextBlock",{type:"totalText",i:t.textIndex}),this.$store.commit("addLog"))}},methods:{dragend:function(t){var e=t.target.getPosition();e.x/=this.pxPerMm,e.y/=this.pxPerMm,this.$store.commit("setTextParams",Object(k["a"])(Object(k["a"])(Object(k["a"])({},this.text),e),{},{i:this.textIndex})),this.$store.commit("addLog")},editText:function(){this.$store.commit("setTextEditMode",!0)},setContextMenuEvent:function(t){var e=this.textIndex;this.$store.commit("setContextMenuEvent",{e:t,textIndex:e,type:"totalText"})}}},ai=oi,ci=Object(b["a"])(ai,ri,si,!1,null,null,null),di=ci.exports,li=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-group",{attrs:{config:{x:t.legend.x*this.pxPerMm,y:t.legend.y*this.pxPerMm,draggable:!0,dragBoundFunc:function(t){var e=10*Math.round(t.x/10),n=10*Math.round(t.y/10);return{x:e,y:n}}}},on:{dragend:t.dragend}},[0===t.legend.subType.indexOf("edge")?n("v-image",{attrs:{config:{image:t.$store.state.files.edges[t.legend.subType.split("_")[1]],width:t.sizeInPx,height:t.sizeInPx,offset:{x:1.5*t.sizeInPx,y:t.sizeInPx/6}}}}):"skirting"===t.legend.subType?n("v-rect",{attrs:{config:{width:t.sizeInPx,fill:"black",height:t.sizeInPx/5,offset:{x:1.5*t.sizeInPx,y:-t.sizeInPx/6}}}}):["color","noBg"].includes(t.legend.subType)?n("v-rect",{attrs:{config:{width:t.sizeInPx,stroke:"black",strokeWidth:1,fill:"color"===t.legend.subType?"rgb(200,200,200)":"white",height:t.sizeInPx,offset:{x:1.5*t.sizeInPx,y:t.sizeInPx/6}}}}):n("v-rect",{attrs:{config:{width:t.sizeInPx,stroke:"black",strokeWidth:1,fill:"white",fillPatternImage:t.fills({type:t.legend.subType,color:"rgb(150,150,150)"}),fillPriority:"pattern",height:t.sizeInPx,offset:{x:1.5*t.sizeInPx,y:t.sizeInPx/6}}}}),n("v-text",{attrs:{config:{type:"legend",id:t.legend.id,text:t.legend.text,fontFamily:"Calibri",fontSize:t.fontSize,fill:[t.currentElId,t.selectedElId].includes(t.legend.id)?t.selectedColor:"black",visible:!(t.selectedElId===t.legend.id&&t.isTextEditMode)}},on:{mouseover:function(e){t.over=!0},mouseleave:function(e){t.over=!1},click:function(e){return t.$store.commit("setSelectedElId",t.legend.id)},dblclick:t.editText,contextmenu:t.setContextMenuEvent}})],1)],1)},ui=[],hi={props:["legend","legendIndex"],data:function(){return{over:!1,sizeInMm:120,fills:W}},computed:{selectedColor:function(){return this.$store.state.selectedColor},selectedElId:function(){return this.$store.state.selectedElId},currentElId:function(){return this.$store.state.currentElId},pxPerMm:function(){return this.$store.state.pxPerMm},fontSize:function(){return this.$store.state.fontSizeInmM.text*this.pxPerMm*this.legend.sizeK},isTextEditMode:function(){return this.$store.state.isTextEditMode},contextMenuAction:function(){return this.$store.state.contextMenuAction},sizeInPx:function(){return this.sizeInMm*this.pxPerMm*this.legend.sizeK}},watch:{over:function(t){t?(this.$store.commit("setCursor","move"),this.$store.commit("setCurrentEl",this.legend.id)):(this.$store.commit("resetCursor"),this.$store.commit("setCurrentEl",null))},contextMenuAction:function(t){var e=this;t.legendIndex===this.legendIndex&&"deleteLegend"===t.action&&setTimeout((function(){e.$store.commit("deleteLegend",{i:t.legendIndex}),e.$store.commit("addLog")}),0)}},methods:{dragend:function(t){var e=t.target.getPosition();e.x/=this.pxPerMm,e.y/=this.pxPerMm,this.$store.commit("setLegendParams",Object(k["a"])(Object(k["a"])(Object(k["a"])({},this.legend),e),{},{i:this.legendIndex})),this.$store.commit("addLog")},editText:function(){this.$store.commit("setTextEditMode",!0)},setContextMenuEvent:function(t){var e=this.legendIndex;this.$store.commit("setContextMenuEvent",{e:t,legendIndex:e})}}},pi=hi,gi=Object(b["a"])(pi,li,ui,!1,null,null,null),mi=gi.exports,fi=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"modal",staticClass:"modal",attrs:{tabindex:"-1",role:"dialog","aria-hidden":"true"}},[i("div",{staticClass:"modal-dialog modal-dialog-centered modal-lg"},[i("div",{staticClass:"modal-content"},[t._m(0),i("div",{staticClass:"modal-body"},[i("div",{staticClass:"row justify-content-center"},t._l(t.sws,(function(e){return i("div",{key:e.name,staticClass:"col-3 border border-dark rounded m-2 p-2",staticStyle:{cursor:"pointer"},on:{click:function(n){return t.addSw(e)}}},[i("div",{staticClass:"text-center"},[i("img",{staticStyle:{width:"5rem"},attrs:{src:n("1948")("./"+e.name+".svg"),alt:"раковина"}})])])})),0)]),t._m(1)])])])},xi=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"modal-header"},[n("h5",{staticClass:"modal-title",attrs:{id:"exampleModalLabel"}},[t._v("Выберите мойку / раковину")]),n("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[n("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"modal-footer"},[n("button",{staticClass:"btn btn-secondary",attrs:{type:"button","data-dismiss":"modal"}},[t._v("Отмена")]),n("button",{staticClass:"btn btn-primary",attrs:{type:"button"}},[t._v("Выбрать")])])}],vi=(n("b0c0"),{mixins:[x],props:["trigger"],data:function(){return{sws:[{name:410,h:433,w:517},{name:813,h:523,w:530},{name:851,h:523,w:435},{name:853,h:465,w:328},{name:855,h:419,w:490},{name:871,h:528,w:631}]}},computed:{pxPerMm:function(){return this.$store.state.pxPerMm},canvasWidthInMm:function(){return this.$store.state.canvasWidthInMm},canvasHeightInMm:function(){return this.$store.state.canvasHeightInMm}},watch:{trigger:function(){O()(this.$refs.modal).modal("show")}},methods:{addSw:function(t){O()(this.$refs.modal).modal("hide"),this.$store.commit("addWashing",{i:this.trigger.partIndex,id:this.getId(),subType:t.name,height:t.h,width:t.w,type:"sw",x:this.trigger.left-this.trigger.partPosition.x/this.pxPerMm,y:this.trigger.top-this.trigger.partPosition.y/this.pxPerMm}),this.$store.commit("addLog")}}}),Ii=vi,bi=Object(b["a"])(Ii,fi,xi,!1,null,null,null),yi=bi.exports,Mi={mixins:[x],components:{ContextMenu:st,Part:je,ElementMenu:Dn,Logs:Gn,TextEdit:ii,TotalText:di,Legends:mi,AddWashing:yi},data:function(){return{content:"",editorOptions:{placeholder:"Введите текст"},addWashingTrigger:{},bgPattern:null}},computed:{contextMenuAction:function(){return this.$store.state.contextMenuAction},parts:function(){return this.$store.state.parts.partsInit},totalTexts:function(){return this.$store.state.parts.totalTexts},legends:function(){return this.$store.state.parts.legends},canvasHeightInMm:function(){return this.$store.state.canvasHeightInMm},canvasWidthInMm:function(){return this.$store.state.canvasWidthInMm},canvasWidthInPx:function(){return this.canvasWidthInMm?this.canvasWidthInMm*this.pxPerMm:0},pxPerMm:function(){return this.$store.state.pxPerMm},cursor:function(){return this.$store.state.cursor},selectedEl:function(){return this.$store.getters.selectedEl}},watch:{cursor:function(t){this.$refs.stage.getNode().container().style.cursor=t},contextMenuAction:function(t){if("addWashing"===t.action){var e=this.parts[t.partIndex].position;this.addWashingTrigger=Object(k["a"])(Object(k["a"])({},t),{},{partPosition:e||{x:0,y:0}})}}},mounted:function(){var t=this,e=this.$el.clientHeight/this.canvasHeightInMm;this.$store.commit("setPxPerMm",e);var n=this.$el.clientWidth/e;this.$store.commit("setCanvasWidthInMm",n);var i=1e3,r=2e3,s=[(n-i)/2,(this.canvasHeightInMm-r)/2],o={id:this.getId(),position:{x:0,y:0},fill:null,type:"part",insetsBulges:[],texts:[],singleSizeTags:[],washings:[],points:[{id:this.getId(),c:s,angleTag:{}},{id:this.getId(),c:[s[0]+i,s[1]],angleTag:{}},{id:this.getId(),c:[s[0]+i,s[1]+r],angleTag:{}},{id:this.getId(),c:[s[0],s[1]+r],angleTag:{}}]};o.borders=o.points.map((function(){return{id:t.getId(),type:"lineBorder",sizeTag:{isShown:!0},radiusPosition:"usual"}})),this.$store.dispatch("addPart",o),this.$store.commit("addLog"),O()(this.$refs.nocontext).on("contextmenu",(function(t){return t.preventDefault()})),this.$store.commit("setStage",this.$refs.stage.getNode()),this.bgPattern=W({type:"square",color:"rgb(235,235,235)"}),window.addEventListener("keypress",(function(e){if("Delete"===e.code&&t.selectedEl.el){var n;switch(t.selectedEl.el.type){case"part":n={action:"deletePart",partIndex:t.selectedEl.i};break;case"totalText":n={action:"deleteTotalText",textIndex:t.selectedEl.i};break;default:return}t.$store.commit("setContextMenuAction",n)}}))},methods:{deselect:function(t){"bgRect"===t.target.attrs.type&&this.$store.commit("setSelectedElId",null)}}},wi=Mi,Pi=Object(b["a"])(wi,Q,V,!1,null,null,null),$i=Pi.exports,Ci={components:{Konva:$i},data:function(){return{isMounted:!1}},mounted:function(){this.isMounted=!0}},Ei=Ci,Ti=Object(b["a"])(Ei,Y,G,!1,null,null,null),ji=Ti.exports,Si={components:{Manage:X,Canvas:ji}},ki=Si,Bi=Object(b["a"])(ki,u,h,!1,null,null,null),_i=Bi.exports,Oi=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"modal",staticClass:"modal",attrs:{id:"confirm_modal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalCenterTitle","aria-hidden":"true","data-result":t.result}},[t._m(0)])},zi=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"modal-dialog modal-dialog-centered",attrs:{role:"document"}},[n("div",{staticClass:"modal-content"},[n("div",{staticClass:"modal-header"},[n("h5",{staticClass:"modal-title"}),n("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[n("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])]),n("div",{staticClass:"modal-body text-left",staticStyle:{"white-space":"pre-wrap"}}),n("div",{staticClass:"modal-footer"})])])}],Li={data:function(){return{result:0}},mounted:function(){var t=this;O()(this.$refs.modal).on("show.bs.modal",(function(){t.result=0,O()(t.$refs.modal).find("input").length&&setTimeout((function(){O()(t.$refs.modal).find("input").trigger("focus")}),0)})).on("keypress","input",(function(e){["Enter","NumpadEnter"].includes(e.code)&&O()(t.$refs.modal).find(".modal-footer > button[data-action=1]").click()})),O()(this.$refs.modal).on("click",".modal-footer > button",(function(e){t.result=Number(O()(e.target).attr("data-action")),setTimeout((function(){O()(t.$refs.modal).modal("hide")}),0)}))}},Di=Li,Ai=Object(b["a"])(Di,Oi,zi,!1,null,null,null),Ri=Ai.exports,Fi={name:"App",components:{Drawer:_i,ConfirmModal:Ri},created:function(){this.$store.dispatch("downloadImages")}},Wi=Fi,Ni=(n("5c0b"),Object(b["a"])(Wi,d,l,!1,null,null,null)),Ki=Ni.exports,qi=(n("b64b"),n("2f62")),Hi=n("15fd"),Ji=function(t){return JSON.parse(JSON.stringify(t))},Ui={state:{partsInit:[],totalTexts:[],legends:[],boundingBoxes:[],refreshSelectedElTrigger:0,defaultEdgeType:"empty"},getters:{canvasSizeInPx:function(t,e,n){var i=n.canvasHeightInMm,r=n.canvasWidthInMm,s=n.pxPerMm,o={width:0,height:0};return r&&(o.width=r*s,o.height=i*s),o},selectedEl:function(t,e,n){var i=n.selectedElId;if(!i)return{};var r={};if(t.partsInit.some((function(t,e){if(t.id===i)return r={i:e,el:t},!0;var n="points",s=null,o=t.points.findIndex((function(t){return t.id===i}));return o<0&&(s=null,n="borders",o=t.borders.findIndex((function(t){return t.id===i}))),o<0&&(s="edgeTag",n="borders",o=t.borders.findIndex((function(t){return t.edgeTag&&t.edgeTag.id===i}))),o<0&&t.insetsBulges&&(s=null,n="insetsBulges",o=t.insetsBulges.findIndex((function(t){return t.id===i}))),o<0&&t.texts&&t.texts.length&&(s=null,n="texts",o=t.texts.findIndex((function(t){return t.id===i}))),o<0&&t.singleSizeTags&&t.singleSizeTags.length&&(s=null,n="singleSizeTags",o=t.singleSizeTags.findIndex((function(t){return t.id===i}))),!(o<0)&&(r={i:e,j:o,el:s?t[n][o][s]:t[n][o]},!0)})),!Object.keys(r).length&&t.totalTexts.length){var s=t.totalTexts.findIndex((function(t){return t.id===i}));s>=0&&(r={i:s,el:t.totalTexts[s]})}if(!Object.keys(r).length&&t.legends.length){var o=t.legends.findIndex((function(t){return t.id===i}));o>=0&&(r={i:o,el:t.legends[o]})}return r}},mutations:{addPart:function(t,e){t.partsInit.push(e)},movePoint:function(t,e){var n=e.partIndex,r=e.pointIndex,s=e.c;i["default"].set(t.partsInit[n].points[r],"c",s)},addPoint:function(t,e){var n=e.i,i=e.j,r=e.point,s=e.border;s.sizeTag={isShown:!0},s.edgeTag={isShown:!1},r.angleTag={isShown:!1},t.partsInit[n].points.splice(i,0,r),t.partsInit[n].borders.splice(i,0,s)},deletePoint:function(t,e){var n=e.i,i=e.j;t.partsInit[n].points.splice(i,1);var r=i>0?i-1:t.partsInit[n].borders.length-1;t.partsInit[n].borders.splice(r,1)},makeBorderCurve:function(t,e){var n=e.partIndex,r=e.borderIndex,s=e.radius,o=Ji(t.partsInit[n].borders[r]);i["default"].set(t.partsInit[n].borders,r,Object.assign(o,{type:"curveBorder",radius:s,isInside:e.isInside,radiusTag:{isShown:!0},edgeTag:{isShown:!1},sizeTag:{isShown:!1}}))},makeBorderLine:function(t,e){var n=e.partIndex,r=e.borderIndex,s=Ji(t.partsInit[n].borders[r]);delete s.radius,delete s.isInside,s.type="lineBorder",s.radiusTag={isShown:!1},s.edgeTag={isShown:!1},s.sizeTag={isShown:!0},i["default"].set(t.partsInit[n].borders,r,s)},addInsetBulge:function(t,e){var n=e.partIndex,i=Object(Hi["a"])(e,["partIndex"]),r=Object(k["a"])(Object(k["a"])({},i),{},{type:e.type,pointsIndexes:[]});t.partsInit[n].insetsBulges.push(r)},setInsetBulgeDepth:function(t,e){var n=e.i,r=e.j,s=e.depth;i["default"].set(t.partsInit[n].insetsBulges[r],"depth",s)},deleteInsetBulge:function(t,e){var n=e.i,i=e.j;t.partsInit[n].insetsBulges.splice(i,1)},refreshSelectedEl:function(t){setTimeout((function(){t.refreshSelectedElTrigger=Math.random()}),0)},changePoint:function(t,e){var n=e.i,r=e.j,s=e.point;i["default"].set(t.partsInit[n].points[r],"c",[s.x,s.y])},changeRadius:function(t,e){var n=e.i,r=e.j,s=e.radius;i["default"].set(t.partsInit[n].borders[r],"radius",s)},setPartPosition:function(t,e){var n=e.i,r=e.pos;i["default"].set(t.partsInit[n],"position",r)},toggleSkirting:function(t,e){var n=e.i,r=e.j;i["default"].set(t.partsInit[n].borders[r],"skirting",!t.partsInit[n].borders[r].skirting)},setRadiusTagParams:function(t,e){var n=e.i,i=e.j,r=Object(Hi["a"])(e,["i","j"]);t.partsInit[n].borders[i].radiusTag=r},setEdgeTagParams:function(t,e){var n,r=e.i,s=e.j,o=Object(Hi["a"])(e,["i","j"]);!1===o.isShown?n={}:(n=t.partsInit[r].borders[s].edgeTag||{},Object.assign(n,{edgeType:t.defaultEdgeType,type:"edge"})),i["default"].set(t.partsInit[r].borders[s],"edgeTag",Object(k["a"])(Object(k["a"])({},n),o)),o.edgeType&&(t.defaultEdgeType=o.edgeType)},setSizeTagParams:function(t,e){var n=e.i,i=e.j,r=Object(Hi["a"])(e,["i","j"]);t.partsInit[n].borders[i].sizeTag=r},setAngleTagParams:function(t,e){var n=e.i,r=e.j,s=Object(Hi["a"])(e,["i","j"]);i["default"].set(t.partsInit[n].points[r],"angleTag",s)},setPartFill:function(t,e){var n=e.i,r=e.fill;i["default"].set(t.partsInit[n],"fill",r)},deletePart:function(t,e){t.partsInit.splice(e,1),t.boundingBoxes.splice(e,1)},addTextBlock:function(t,e){var n=e.i,r=Object(Hi["a"])(e,["i"]);"totalText"===e.type?t.totalTexts.push(Object(k["a"])({},r)):(t.partsInit[n].texts||i["default"].set(t.partsInit[n],"texts",[]),t.partsInit[n].texts.push(Object(k["a"])({},r)))},setTextBlock:function(t,e){"totalText"===e.type?i["default"].set(t.totalTexts[e.i],"text",e.text):i["default"].set(t.partsInit[e.i].texts[e.j],"text",e.text)},deleteTextBlock:function(t,e){"totalText"===e.type?t.totalTexts.splice(e.i,1):t.partsInit[e.i].texts.splice(e.j,1)},setTextParams:function(t,e){var n=e.i,r=(e.j,Object(Hi["a"])(e,["i","j"]));"totalText"===r.type?i["default"].set(t.totalTexts,n,r):i["default"].set(t.partsInit[n].texts[r.j],"x",r.text)},setBoundingBox:function(t,e){var n=e.i,r=e.bb;i["default"].set(t.boundingBoxes,n,r)},assignBordersPointsIds:function(t,e){var n=t.partsInit[e],i=n.points,r=n.borders,s=n.insetsBulges;i.forEach((function(n,s){var o=s<i.length-1?s+1:0;t.partsInit[e].borders[s].pointsId=[n.id,i[o].id],t.partsInit[e].borders[s].pointsIndexes=[s,o];var a=s?s-1:i.length-1;t.partsInit[e].points[s].bordersId=[r[a].id,r[s].id],t.partsInit[e].points[s].bordersIndexes=[a,s]})),s.forEach((function(n,r){var s=n.pointsId.map((function(t){return i.findIndex((function(e){return e.id===t}))}));t.partsInit[e].insetsBulges[r].pointsIndexes=s}))},addSingleSizeTag:function(t,e){var n=e.i,i=Object(Hi["a"])(e,["i"]);t.partsInit[n].singleSizeTags.push(i)},setSingleSizeTagParams:function(t,e){var n=e.i,i=e.j,r=Object(Hi["a"])(e,["i","j"]);Object.assign(t.partsInit[n].singleSizeTags[i],r)},deleteSingleSizeTag:function(t,e){var n=e.i,i=e.j;t.partsInit[n].singleSizeTags.splice(i,1)},addLegend:function(t,e){t.legends.push(e)},setLegendParams:function(t,e){var n=e.i,i=Object(Hi["a"])(e,["i"]);Object.assign(t.legends[n],i)},deleteLegend:function(t,e){var n=e.i;t.legends.splice(n,1)},addWashing:function(t,e){var n=e.i,i=Object(Hi["a"])(e,["i"]);t.partsInit[n].washings.push(i)},setWashingParams:function(t,e){var n=e.i,i=e.j,r=Object(Hi["a"])(e,["i","j"]);Object.assign(t.partsInit[n].washings[i],r)},deleteWashing:function(t,e){var n=e.i,i=e.j;t.partsInit[n].washings.splice(i,1)}},actions:{addPart:function(t,e){var n=t.commit,i=t.state;n("addPart",e),n("assignBordersPointsIds",i.partsInit.length-1)},addPoint:function(t,e){var n=t.commit;n("addPoint",e),n("assignBordersPointsIds",e.i)},deletePoint:function(t,e){var n=t.commit;n("deletePoint",e),n("assignBordersPointsIds",e.i)},refreshSelectedEl:function(t){var e=t.commit,n=t.rootState;n.selectedEl&&e("refreshSelectedEl")},makeBorderCurve:function(t,e){var n=t.commit,i=t.dispatch;n("makeBorderCurve",e),i("refreshSelectedEl")},makeBorderLine:function(t,e){var n=t.commit,i=t.dispatch;n("makeBorderLine",e),i("refreshSelectedEl")},changePoint:function(t,e){var n=t.commit;n("changePoint",e)},changeRadius:function(t,e){var n=t.commit;n("changeRadius",e)},addTextBlock:function(t,e){var n=t.commit;n("addTextBlock",e),n("setSelectedElId",e.id),n("setTextEditMode",!0)},addInsetBulge:function(t,e){var n=t.commit;n("addInsetBulge",e),n("assignBordersPointsIds",e.partIndex)},deleteInsetBulge:function(t,e){var n=t.commit;n("deleteInsetBulge",e),n("assignBordersPointsIds",e.i)}}};i["default"].use(qi["a"]);var Zi=function(t){return JSON.parse(JSON.stringify(t))},Xi=new qi["a"].Store({state:{stage:null,canvasHeightInMm:4e3,pxPerMm:0,contextMenuEvent:null,cursor:"default",contextMenuAction:{},selectedElId:null,currentElId:null,id:0,fontSizeInmM:{sizeArrow:90,radius:90,text:90},files:{edges:{},fills:{},washings:{}},logs:[{parts:[],totalTexts:[],legends:[]}],logStep:0,dash:[1,2],selectedColor:"#536dfe",isTextEditMode:!1,showAllConsoleLogs:!1,fills:[{type:"color",title:"Цвет"},{type:"dots",title:"Точки"},{type:"verticalLines",title:"Вертикальные линии"},{type:"horizontalLines",title:"Горизонтальные линии"},{type:"rightDiagonalLines",title:"Правый штрих"},{type:"leftDiagonalLines",title:"Левый штрих"},{type:"rightSmallDiagonalLines",title:"Мелкий штрих"},{type:"rhombus",title:"Ромб"}]},getters:{gridSize:function(){return 10}},mutations:{setStage:function(t,e){t.stage=e},setPxPerMm:function(t,e){t.pxPerMm=e},setCanvasWidthInMm:function(t,e){i["default"].set(t,"canvasWidthInMm",e)},setContextMenuEvent:function(t,e){t.contextMenuEvent=e},setContextMenuAction:function(t,e){t.contextMenuAction=e},setSelectedElId:function(t,e){t.selectedElId=e},setCurrentEl:function(t,e){t.currentElId=e},incrementId:function(t){t.id+=1},addFile:function(t,e){i["default"].set(t.files[e.type],e.name,e.image)},setCursor:function(t,e){t.cursor=e},resetCursor:function(t){t.cursor="default"},addLog:function(t){t.logStep+=1,t.logs[t.logStep]={parts:Zi(t.parts.partsInit),totalTexts:Zi(t.parts.totalTexts),legends:Zi(t.parts.legends)},t.logs.splice(t.logStep+1)},logBack:function(t){t.selectedElId=null,t.contextMenuEvent=null,t.parts.partsInit=Zi(t.logs[t.logStep-1].parts),t.parts.totalTexts=Zi(t.logs[t.logStep-1].totalTexts),t.parts.legends=Zi(t.logs[t.logStep-1].legends),t.logStep-=1},logForward:function(t){t.selectedElId=null,t.contextMenuEvent=null,t.logStep+=1,t.parts.partsInit=Zi(t.logs[t.logStep].parts),t.parts.totalTexts=Zi(t.logs[t.logStep].totalTexts),t.parts.legends=Zi(t.logs[t.logStep].legends)},setTextEditMode:function(t,e){t.isTextEditMode=e}},actions:{downloadImages:function(t){var e=t.commit,i={edges:{empty:n("b39e"),half:n("c101"),full:n("eabb"),emptyHover:n("2e97"),halfHover:n("6192"),fullHover:n("7e33")},washings:{410:n("7637"),813:n("83bd"),851:n("8a10"),853:n("a4de"),855:n("0a73"),871:n("36bb")}};Object.keys(i).forEach((function(t){Object.keys(i[t]).forEach((function(n){var r=new Image;r.onload=function(i){e("addFile",{type:t,name:n,image:i.target})},r.src=i[t][n]}))}))}},modules:{parts:Ui}});o["c"].add(a["a"],a["f"],a["d"],a["e"],a["g"],a["i"],a["h"],a["b"],a["c"]),i["default"].component("font-awesome-icon",c["a"]),i["default"].config.productionTip=!1,i["default"].use(s.a),i["default"].mixin({data:function(){return{console:{log:function(){var t;Xi.state.showAllConsoleLogs&&(t=console).log.apply(t,arguments)}}}},methods:{clone:function(t){return JSON.parse(JSON.stringify(t))}}}),new i["default"]({store:Xi,render:function(t){return t(Ki)}}).$mount("#app")},"5c0b":function(t,e,n){"use strict";var i=n("9c0c"),r=n.n(i);r.a},6192:function(t,e,n){t.exports=n.p+"img/edge_half_hover.a02e39f9.svg"},7637:function(t,e,n){t.exports=n.p+"img/410.a3e44da7.svg"},"7e33":function(t,e,n){t.exports=n.p+"img/edge_full_hover.0e25cee9.svg"},"83bd":function(t,e,n){t.exports=n.p+"img/813.bc8b7e3a.svg"},"8a10":function(t,e,n){t.exports=n.p+"img/851.84747f99.svg"},"9c0c":function(t,e,n){},a4de:function(t,e,n){t.exports=n.p+"img/853.b86c9ab3.svg"},b39e:function(t,e,n){t.exports=n.p+"img/edge_empty.3662e72a.svg"},c101:function(t,e,n){t.exports=n.p+"img/edge_half.10bb9dfa.svg"},e572:function(t,e,n){"use strict";var i=n("13c9"),r=n.n(i);r.a},eabb:function(t,e,n){t.exports=n.p+"img/edge_full.a70ba3da.svg"},ef9c:function(t,e,n){"use strict";var i=n("39d3"),r=n.n(i);r.a}});
//# sourceMappingURL=app.2c6bf8cf.js.map